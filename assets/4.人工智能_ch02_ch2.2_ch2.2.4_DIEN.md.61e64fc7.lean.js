import{_ as l,o as s,c as t,a as n,j as a,U as e}from"./chunks/framework.489e5108.js";const D1=JSON.parse('{"title":"DIEN","description":"","frontmatter":{},"headers":[],"relativePath":"4.人工智能/ch02/ch2.2/ch2.2.4/DIEN.md","filePath":"4.人工智能/ch02/ch2.2/ch2.2.4/DIEN.md","lastUpdated":1696176798000}'),o={name:"4.人工智能/ch02/ch2.2/ch2.2.4/DIEN.md"},p=e("",15),Q={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},r={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.025ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.448ex",height:"1.025ex",role:"img",focusable:"false",viewBox:"0 -442 640 453","aria-hidden":"true"},T=a("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[a("g",{"data-mml-node":"math"},[a("g",{"data-mml-node":"mi"},[a("path",{"data-c":"1D6FC",d:"M34 156Q34 270 120 356T309 442Q379 442 421 402T478 304Q484 275 485 237V208Q534 282 560 374Q564 388 566 390T582 393Q603 393 603 385Q603 376 594 346T558 261T497 161L486 147L487 123Q489 67 495 47T514 26Q528 28 540 37T557 60Q559 67 562 68T577 70Q597 70 597 62Q597 56 591 43Q579 19 556 5T512 -10H505Q438 -10 414 62L411 69L400 61Q390 53 370 41T325 18T267 -2T203 -11Q124 -11 79 39T34 156ZM208 26Q257 26 306 47T379 90L403 112Q401 255 396 290Q382 405 304 405Q235 405 183 332Q156 292 139 224T121 120Q121 71 146 49T208 26Z",style:{"stroke-width":"3"}})])])],-1),i=[T],m=a("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[a("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[a("mi",null,"α")])],-1),d={class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},c={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.667ex"},xmlns:"http://www.w3.org/2000/svg",width:"19.136ex",height:"2.213ex",role:"img",focusable:"false",viewBox:"0 -683 8458.3 978","aria-hidden":"true"},h=e("",1),u=[h],g=a("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[a("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[a("mi",null,"L"),a("mo",null,"="),a("msub",null,[a("mi",null,"L"),a("mrow",{"data-mjx-texclass":"ORD"},[a("mi",null,"t"),a("mi",null,"a"),a("mi",null,"r"),a("mi",null,"g"),a("mi",null,"e"),a("mi",null,"t")])]),a("mo",null,"+"),a("mi",null,"α"),a("msub",null,[a("mi",null,"L"),a("mrow",{"data-mjx-texclass":"ORD"},[a("mi",null,"a"),a("mi",null,"u"),a("mi",null,"x")])])])],-1),y=e("",8),_=a("strong",null,"AIGRU:",-1),E={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},b={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.605ex"},xmlns:"http://www.w3.org/2000/svg",width:"7.589ex",height:"2.641ex",role:"img",focusable:"false",viewBox:"0 -899.7 3354.1 1167.1","aria-hidden":"true"},x=e("",1),w=[x],f=a("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[a("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[a("msubsup",null,[a("mi",null,"i"),a("mi",null,"t"),a("mrow",{"data-mjx-texclass":"ORD"},[a("msup",null,[a("mi"),a("mo",{"data-mjx-alternate":"1"},"′")])])]),a("mo",null,","),a("msub",null,[a("mi",null,"h"),a("mi",null,"t")]),a("mo",null,","),a("msub",null,[a("mi",null,"a"),a("mi",null,"t")])])],-1),H={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},L={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.025ex"},xmlns:"http://www.w3.org/2000/svg",width:"0.781ex",height:"1.52ex",role:"img",focusable:"false",viewBox:"0 -661 345 672","aria-hidden":"true"},k=a("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[a("g",{"data-mml-node":"math"},[a("g",{"data-mml-node":"mi"},[a("path",{"data-c":"1D456",d:"M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z",style:{"stroke-width":"3"}})])])],-1),D=[k],v=a("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[a("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[a("mi",null,"i")])],-1),M={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},A={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.068ex",height:"1.927ex",role:"img",focusable:"false",viewBox:"0 -694 914.3 851.8","aria-hidden":"true"},Z=e("",1),V=[Z],F=a("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[a("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[a("msub",null,[a("mi",null,"h"),a("mi",null,"t")])])],-1),j={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},C={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.962ex",height:"1.355ex",role:"img",focusable:"false",viewBox:"0 -441 867.3 598.8","aria-hidden":"true"},R=e("",1),I=[R],S=a("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[a("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[a("msub",null,[a("mi",null,"a"),a("mi",null,"t")])])],-1),N={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},q={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.068ex",height:"1.927ex",role:"img",focusable:"false",viewBox:"0 -694 914.3 851.8","aria-hidden":"true"},O=e("",1),P=[O],B=a("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[a("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[a("msub",null,[a("mi",null,"h"),a("mi",null,"t")])])],-1),G={class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},U={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.576ex"},xmlns:"http://www.w3.org/2000/svg",width:"10.73ex",height:"2.725ex",role:"img",focusable:"false",viewBox:"0 -949.7 4742.8 1204.5","aria-hidden":"true"},z=e("",1),X=[z],$=a("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[a("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[a("msubsup",null,[a("mi",null,"i"),a("mi",null,"t"),a("mrow",{"data-mjx-texclass":"ORD"},[a("msup",null,[a("mi"),a("mo",{"data-mjx-alternate":"1"},"′")])])]),a("mo",null,"="),a("msub",null,[a("mi",null,"h"),a("mi",null,"t")]),a("mo",null,"∗"),a("msub",null,[a("mi",null,"a"),a("mi",null,"t")])])],-1),J=a("strong",null,"AGRU:",-1),W={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},K={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"5.859ex",height:"1.864ex",role:"img",focusable:"false",viewBox:"0 -666 2589.7 823.8","aria-hidden":"true"},Y=e("",1),a1=[Y],s1=a("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[a("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[a("mn",null,"1"),a("mo",null,"−"),a("msub",null,[a("mi",null,"a"),a("mi",null,"t")])])],-1),t1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},n1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.626ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.068ex",height:"3.355ex",role:"img",focusable:"false",viewBox:"0 -1206 914.3 1482.8","aria-hidden":"true"},e1=e("",1),l1=[e1],o1=a("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[a("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[a("mrow",{"data-mjx-texclass":"ORD"},[a("mover",null,[a("msubsup",null,[a("mi",null,"h"),a("mi",null,"t"),a("mrow",{"data-mjx-texclass":"ORD"},[a("msup",null,[a("mi"),a("mo",{"data-mjx-alternate":"1"},"′")])])]),a("mo",{stretchy:"false"},"^")])])])],-1),p1={class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},Q1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.69ex"},xmlns:"http://www.w3.org/2000/svg",width:"25.751ex",height:"3.283ex",role:"img",focusable:"false",viewBox:"0 -1146 11381.9 1450.9","aria-hidden":"true"},r1=e("",1),T1=[r1],i1=a("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[a("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[a("msubsup",null,[a("mi",null,"h"),a("mi",null,"t"),a("mrow",{"data-mjx-texclass":"ORD"},[a("msup",null,[a("mi"),a("mo",{"data-mjx-alternate":"1"},"′")])])]),a("mo",null,"="),a("mo",{stretchy:"false"},"("),a("mn",null,"1"),a("mo",null,"−"),a("msub",null,[a("mi",null,"a"),a("mi",null,"t")]),a("mo",{stretchy:"false"},")"),a("msubsup",null,[a("mi",null,"h"),a("mrow",{"data-mjx-texclass":"ORD"},[a("mi",null,"t"),a("mo",null,"−"),a("mn",null,"1")]),a("mrow",{"data-mjx-texclass":"ORD"},[a("msup",null,[a("mi"),a("mo",{"data-mjx-alternate":"1"},"′")])])]),a("mo",null,"+"),a("msub",null,[a("mi",null,"a"),a("mi",null,"t")]),a("mo",null,"∗"),a("mrow",{"data-mjx-texclass":"ORD"},[a("mover",null,[a("msubsup",null,[a("mi",null,"h"),a("mi",null,"t"),a("mrow",{"data-mjx-texclass":"ORD"},[a("msup",null,[a("mi"),a("mo",{"data-mjx-alternate":"1"},"′")])])]),a("mo",{stretchy:"false"},"~")])])])],-1),m1={start:"3"},d1=a("strong",null,"AUGRU:",-1),c1={class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},h1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-3.025ex"},xmlns:"http://www.w3.org/2000/svg",width:"25.945ex",height:"7.18ex",role:"img",focusable:"false",viewBox:"0 -1836.9 11467.9 3173.7","aria-hidden":"true"},u1=e("",1),g1=[u1],y1=a("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[a("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[a("mtable",{displaystyle:"true",columnalign:"right left",columnspacing:"0em",rowspacing:"3pt"},[a("mtr",null,[a("mtd"),a("mtd",null,[a("mrow",{"data-mjx-texclass":"ORD"},[a("mover",null,[a("msubsup",null,[a("mi",null,"u"),a("mi",null,"t"),a("mrow",{"data-mjx-texclass":"ORD"},[a("msup",null,[a("mi"),a("mo",{"data-mjx-alternate":"1"},"′")])])]),a("mo",{stretchy:"false"},"~")])]),a("mo",null,"="),a("msub",null,[a("mi",null,"a"),a("mi",null,"t")]),a("mo",null,"∗"),a("msub",null,[a("mi",null,"u"),a("mi",null,"t")])])]),a("mtr",null,[a("mtd"),a("mtd",null,[a("msubsup",null,[a("mi",null,"h"),a("mi",null,"t"),a("mrow",{"data-mjx-texclass":"ORD"},[a("msup",null,[a("mi"),a("mo",{"data-mjx-alternate":"1"},"′")])])]),a("mo",null,"="),a("mo",{stretchy:"false"},"("),a("mn",null,"1"),a("mo",null,"−"),a("mrow",{"data-mjx-texclass":"ORD"},[a("mover",null,[a("msubsup",null,[a("mi",null,"u"),a("mi",null,"t"),a("mrow",{"data-mjx-texclass":"ORD"},[a("msup",null,[a("mi"),a("mo",{"data-mjx-alternate":"1"},"′")])])]),a("mo",{stretchy:"false"},"~")])]),a("mo",{stretchy:"false"},")"),a("msubsup",null,[a("mi",null,"h"),a("mrow",{"data-mjx-texclass":"ORD"},[a("mi",null,"t"),a("mo",null,"−"),a("mn",null,"1")]),a("mrow",{"data-mjx-texclass":"ORD"},[a("msup",null,[a("mi"),a("mo",{"data-mjx-alternate":"1"},"′")])])]),a("mo",null,"+"),a("mrow",{"data-mjx-texclass":"ORD"},[a("mover",null,[a("msubsup",null,[a("mi",null,"u"),a("mi",null,"t"),a("mrow",{"data-mjx-texclass":"ORD"},[a("msup",null,[a("mi"),a("mo",{"data-mjx-alternate":"1"},"′")])])]),a("mo",{stretchy:"false"},"~")])]),a("mo",null,"∗"),a("mrow",{"data-mjx-texclass":"ORD"},[a("mover",null,[a("msubsup",null,[a("mi",null,"h"),a("mi",null,"t"),a("mrow",{"data-mjx-texclass":"ORD"},[a("msup",null,[a("mi"),a("mo",{"data-mjx-alternate":"1"},"′")])])]),a("mo",{stretchy:"false"},"~")])])])])])])],-1),_1=e("",17);function E1(b1,x1,w1,f1,H1,L1){return s(),t("div",null,[p,n(" 其中$h_t^i$表示的是用户$i$第$t$时刻的隐藏状态，可以表示用户第$t$时刻的兴趣向量，$e_b^i，\\hat{e_b^i}$分别表示的是正负样本，$e_b^i[t+1]$表示的是用户$i$第$t+1$时刻点击的物品向量。 "),a("p",null,[n("辅助损失会加到最终的目标损失 (ctr 损失) 中一起进行优化，并且通过"),a("mjx-container",Q,[(s(),t("svg",r,i)),m]),n(" 参数来平衡点击率和兴趣的关系")]),a("mjx-container",d,[(s(),t("svg",c,u)),g]),y,a("ol",null,[a("li",null,[a("p",null,[_,n(" 将注意力分数直接与输入的序列进行相乘，也就是权重越大的向量对应的值也越大，其中"),a("mjx-container",E,[(s(),t("svg",b,w)),f]),n(" 分别表示用户"),a("mjx-container",H,[(s(),t("svg",L,D)),v]),n(" 在兴趣演化过程使用的 GRU 的第 t 时刻的输入，"),a("mjx-container",M,[(s(),t("svg",A,V)),F]),n(" 表示的是兴趣抽取层第 t 时刻的输出，"),a("mjx-container",j,[(s(),t("svg",C,I)),S]),n(" 表示的是"),a("mjx-container",N,[(s(),t("svg",q,P)),B]),n(" 的注意力分数，这种方式的弊端是即使是零输入也会改变 GRU 的隐藏状态，所以相对较少的兴趣值也会影响兴趣的学习进化 (根据 GRU 门的更新公式就可以知道，下一个隐藏状态的计算会用到上一个隐藏状态的信息，所以即使当前输入为 0，最终隐藏状态也不会直接等于 0，所以即使兴趣较少，也会影响到最终兴趣的演化)。")]),a("mjx-container",G,[(s(),t("svg",U,X)),$])]),a("li",null,[a("p",null,[J,n(" 将注意力分数直接作为 GRU 模块中，更新门的值，则重置门对应的值表示为"),a("mjx-container",W,[(s(),t("svg",K,a1)),s1]),n(", 所以最终隐藏状态的更新公式表示为：其中"),a("mjx-container",t1,[(s(),t("svg",n1,l1)),o1]),n(" 表示的是候选隐藏状态。但是这种方式的弊端是弱化了兴趣之间的相关性，因为最终兴趣的更新前后是没关系的，只取决于输入的注意力分数")])])]),a("mjx-container",p1,[(s(),t("svg",Q1,T1)),i1]),a("ol",m1,[a("li",null,[d1,n(" 将注意力分数作为更新门的权重，这样既兼顾了注意力分数很低时的状态更新值，也利用了兴趣之间的相关性，最终的表达式如下："),a("mjx-container",c1,[(s(),t("svg",h1,g1)),y1])])]),_1])}const v1=l(o,[["render",E1]]);export{D1 as __pageData,v1 as default};
