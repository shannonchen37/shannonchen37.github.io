import{_ as e,o as l,c as p,j as s,a as n,U as a}from"./chunks/framework.489e5108.js";const zs=JSON.parse('{"title":"Billion-scale Commodity Embedding for E-commerce Recommendation in Alibaba","description":"","frontmatter":{},"headers":[],"relativePath":"4.人工智能/ch02/ch2.1/ch2.1.3/EGES.md","filePath":"4.人工智能/ch02/ch2.1/ch2.1.3/EGES.md","lastUpdated":1696176798000}'),o={name:"4.人工智能/ch02/ch2.1/ch2.1.3/EGES.md"},t=a("",13),r={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},c={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.464ex"},xmlns:"http://www.w3.org/2000/svg",width:"12.384ex",height:"2.395ex",role:"img",focusable:"false",viewBox:"0 -853.7 5473.8 1058.7","aria-hidden":"true"},i=a("",1),E=[i],y=s("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("mi",null,"f"),s("mo",null,":"),s("mi",null,"V"),s("mo",null,"−"),s("mo",null,">"),s("msup",null,[s("mi",null,"R"),s("mi",null,"d")])])],-1),d=a("",11),m={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},Q={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.666ex"},xmlns:"http://www.w3.org/2000/svg",width:"3.593ex",height:"2.211ex",role:"img",focusable:"false",viewBox:"0 -683 1588.3 977.2","aria-hidden":"true"},_=a("",1),u=[_],T=s("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("msub",null,[s("mi",null,"M"),s("mrow",{"data-mjx-texclass":"ORD"},[s("mi",null,"i"),s("mi",null,"j")])])])],-1),b={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},h={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.666ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.453ex",height:"1.666ex",role:"img",focusable:"false",viewBox:"0 -442 1084.3 736.2","aria-hidden":"true"},g=a("",1),F=[g],f=s("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("msub",null,[s("mi",null,"e"),s("mrow",{"data-mjx-texclass":"ORD"},[s("mi",null,"i"),s("mi",null,"j")])])])],-1),w={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},x={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"6.846ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 3026.1 1000","aria-hidden":"true"},A=a("",1),C=[A],D=s("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("msub",null,[s("mi",null,"N"),s("mrow",{"data-mjx-texclass":"ORD"},[s("mo",null,"+")])]),s("mo",{stretchy:"false"},"("),s("msub",null,[s("mi",null,"v"),s("mi",null,"i")]),s("mo",{stretchy:"false"},")")])],-1),k={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},v={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.837ex",height:"1.359ex",role:"img",focusable:"false",viewBox:"0 -443 812 600.8","aria-hidden":"true"},B=a("",1),M=[B],H=s("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("msub",null,[s("mi",null,"v"),s("mi",null,"i")])])],-1),L=a("",7),S={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},q={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"6.234ex",height:"2.283ex",role:"img",focusable:"false",viewBox:"0 -759 2755.4 1009","aria-hidden":"true"},G=a("",1),Z=[G],j=s("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("mi",null,"N"),s("mo",{stretchy:"false"},"("),s("msub",null,[s("mi",null,"v"),s("mi",null,"i")]),s("msup",null,[s("mo",{stretchy:"false"},")"),s("mo",{"data-mjx-alternate":"1"},"′")])])],-1),z=s("h3",{id:"基于side-information的图嵌入-ges",tabindex:"-1"},[n("基于 side information 的图嵌入（GES） "),s("a",{class:"header-anchor",href:"#基于side-information的图嵌入-ges","aria-label":'Permalink to "基于side information的图嵌入（GES）"'},"​")],-1),V=s("p",null,"尽管 BGE 将行为序列关系编码进物品的 embedding 中，从而从用户行为中捕捉高阶相似性。但是这里有个问题，对于新加入的商品，由于未和用户产生过交互，所以不会出现在 item-item 图上，进而模型无法学习到其 embedding，即无法解决冷启动问题。",-1),P=s("p",null,[n("为了解决冷启问题，本文通过使用 side information（ 类别，店铺，价格等）加入模型的训练过程中，使得模型最终的泛化能力体现在商品的 side information 上。这样通过"),s("strong",null," side information 学习到的 embedding 来表示具体的商品"),n("，使得相似 side information 的物品可以得到在空间上相近的表示，进而来增强 BGE。")],-1),I={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},R={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.735ex"},xmlns:"http://www.w3.org/2000/svg",width:"11.221ex",height:"2.636ex",role:"img",focusable:"false",viewBox:"0 -840.1 4959.9 1165","aria-hidden":"true"},N=a("",1),$=[N],J=s("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("msubsup",null,[s("mi",null,"W"),s("mi",null,"V"),s("mn",null,"0")]),s("mo",null,","),s("mo",null,"."),s("mo",null,"."),s("mo",null,"."),s("msubsup",null,[s("mi",null,"W"),s("mi",null,"V"),s("mi",null,"n")])])],-1),W={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},O={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.735ex"},xmlns:"http://www.w3.org/2000/svg",width:"3.554ex",height:"2.636ex",role:"img",focusable:"false",viewBox:"0 -840.1 1570.8 1165","aria-hidden":"true"},X=a("",1),U=[X],K=s("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("msubsup",null,[s("mi",null,"W"),s("mi",null,"V"),s("mn",null,"0")])])],-1),Y=s("p",null,"​ $$H_v = \\frac{1}{n+1}\\sum_{s=0}^n W^s_v$$",-1),ss={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},ns={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.844ex",height:"1.902ex",role:"img",focusable:"false",viewBox:"0 -683 1256.9 840.8","aria-hidden":"true"},as=a("",1),ls=[as],ps=s("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("msub",null,[s("mi",null,"H"),s("mi",null,"v")])])],-1),es=s("h3",{id:"增强型egs-eges",tabindex:"-1"},[n("增强型 EGS（EGES） "),s("a",{class:"header-anchor",href:"#增强型egs-eges","aria-label":'Permalink to "增强型EGS（EGES）"'},"​")],-1),os=s("p",null,"尽管 GES 相比 BGE 在性能上有了提升，但是在聚合多个属性向量得到商品的 embedding 的过程中，不同 side information 的聚合依然存在问题。在 GES 中采用 average-pooling 是在假设不同种类的 side information 对商品 embedding 的贡献是相等的，但实际中却并非如此。例如，购买 Iphone 的用户更可能倾向于 Macbook 或者 Ipad，相比于价格属性，品牌属性相对于苹果类商品具有更重要的影响。因此，根据实际现状，不同类型的 side information 对商品的表示是具有不同的贡献值的。",-1),ts=s("p",null,"针对上述问题，作者提出了 weight pooling 方法来聚合不同类型的 side information。具体地，EGES 与 GES 的区别在聚合不同类型 side information 计算不同的权重，根据权重聚合 side information 得到商品的 embedding，如下图所示：",-1),rs=s("div",{align:"center"},[s("img",{src:"https://ryluo.oss-cn-chengdu.aliyuncs.com/图片image-20220328154950289.png",style:{zoom:"80%"}})],-1),cs={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},is={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.937ex",height:"1.355ex",role:"img",focusable:"false",viewBox:"0 -441 856 598.8","aria-hidden":"true"},Es=a("",1),ys=[Es],ds=s("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("msub",null,[s("mi",null,"a"),s("mi",null,"i")])])],-1),ms=s("p",null,"​ $$H_v = \\frac{\\sum_{j=0}^n e^{a_v^j} W_v^j}{\\sum_{j=0}^n e^{a_v^j}}$$",-1),Qs={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},_s={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.334ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.161ex",height:"2.517ex",role:"img",focusable:"false",viewBox:"0 -965.2 954.9 1112.7","aria-hidden":"true"},us=a("",1),Ts=[us],bs=s("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("msubsup",null,[s("mi",null,"a"),s("mi",null,"v"),s("mi",null,"j")])])],-1),hs=s("p",null,"​ $$L(v,u,y)=-[ylog( \\sigma (H_v^TZ_u)) + (1-y)log(1 - \\sigma(H_v^TZ_u))]$$",-1),gs={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},Fs={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.844ex",height:"1.902ex",role:"img",focusable:"false",viewBox:"0 -683 1256.9 840.8","aria-hidden":"true"},fs=a("",1),ws=[fs],xs=s("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("msub",null,[s("mi",null,"H"),s("mi",null,"v")])])],-1),As={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},Cs={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.648ex",height:"1.902ex",role:"img",focusable:"false",viewBox:"0 -683 1170.5 840.8","aria-hidden":"true"},Ds=a("",1),ks=[Ds],vs=s("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("msub",null,[s("mi",null,"Z"),s("mi",null,"u")])])],-1),Bs=a("",37);function Ms(Hs,Ls,Ss,qs,Gs,Zs){return l(),p("div",null,[t,s("p",null,[n("文中所提出的方法是基于经典的图嵌入模型 DeepWalk 进行改进，其目标是通过物品图 G，学习一个映射函数"),s("mjx-container",r,[(l(),p("svg",c,E)),y]),n(" ，将图上节点映射成一个 embedding。具体的步骤包括两步：1. 通过随机游走为图上每个物品生成序列；2. 通过 Skip-Gram 算法学习每个物品的 embedding。因此对于该方法优化的目标是，在给定的上下文物品的前提下，最大化物品 v 的条件概率，即物品 v 对于一个序列里面的其他物品要尽可能的相似。接下来看一些每个模型具体内容。")]),d,s("p",null,[n("其中"),s("mjx-container",m,[(l(),p("svg",Q,u)),T]),n(" 为边"),s("mjx-container",b,[(l(),p("svg",h,F)),f]),n(" 上的权重，"),s("mjx-container",w,[(l(),p("svg",x,C)),D]),n(" 表示节点"),s("mjx-container",k,[(l(),p("svg",v,M)),H]),n(" 所有邻居节点集合，并且随机游走的转移概率的对每个节点所有邻接边权重的归一化结果。在随即游走之后，每个 item 得到一个序列，如下图所示：")]),L,s("p",null,[n("其中"),s("mjx-container",S,[(l(),p("svg",q,Z)),j]),n(" 表示负样本集合，负采样个数越多，结果越好。")]),z,V,P,s("p",null,[n("那么对于每个商品如何通过 side information 的 embedidng 来表示呢？对于随机游走之后得到的商品序列，其中每个每个商品由其 id 和属性 (品牌，价格等) 组成。用公式表示，对于序列中的每一个物品可以得到"),s("mjx-container",I,[(l(),p("svg",R,$)),J]),n(",（n+1）个向量表示，"),s("mjx-container",W,[(l(),p("svg",O,U)),K]),n(" 表示物品 v，剩下是 side information 的 embedding。然后将所有的 side information 聚合成一个整体来表示物品，聚合方式如下：")]),Y,s("p",null,[n("其中，"),s("mjx-container",ss,[(l(),p("svg",ns,ls)),ps]),n(" 是商品 v 的聚合后的 embedding 向量。")]),es,os,ts,rs,s("p",null,[n("其中 "),s("mjx-container",cs,[(l(),p("svg",is,ys)),ds]),n(" 表示每个 side information 用于计算权重的参数向量，最终通过下面的公式得到商品的 embedding：")]),ms,s("p",null,[n("这里对参数 "),s("mjx-container",Qs,[(l(),p("svg",_s,Ts)),bs]),n(" 先做指数变换，目的是为了保证每个边界信息的贡献都能大于 0，然后通过归一化为每个特征得到一个 o-1 之内的权重。最终物品的 embedding 通过权重进行加权聚合得到，进而优化损失函数：")]),hs,s("p",null,[n("y 是标签符号，等于 1 时表示正样本，等于 0 时表示负样本。"),s("mjx-container",gs,[(l(),p("svg",Fs,ws)),xs]),n(" 表示商品 v 的最终的隐层表示，"),s("mjx-container",As,[(l(),p("svg",Cs,ks)),vs]),n(" 表示训练数据中的上下文节点的 embedding。")]),Bs])}const Vs=e(o,[["render",Ms]]);export{zs as __pageData,Vs as default};
