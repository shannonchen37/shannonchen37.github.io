import{_ as o,o as n,c as l,j as s,a,U as p}from"./chunks/framework.489e5108.js";const Xs=JSON.parse('{"title":"双塔召回模型","description":"","frontmatter":{},"headers":[],"relativePath":"4.人工智能/ch02/ch2.1/ch2.1.2/DSSM.md","filePath":"4.人工智能/ch02/ch2.1/ch2.1.2/DSSM.md","lastUpdated":1696176798000}'),e={name:"4.人工智能/ch02/ch2.1/ch2.1.2/DSSM.md"},t=p("",12),r={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},c={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"6.23ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 2753.7 1000","aria-hidden":"true"},i=p("",1),E=[i],y=s("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("mi",null,"s"),s("mo",{stretchy:"false"},"("),s("mi",null,"x"),s("mo",null,","),s("mi",null,"y"),s("mo",{stretchy:"false"},")")])],-1),d={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},T={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"8.558ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 3782.7 1000","aria-hidden":"true"},Q=p("",1),m=[Q],u=s("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("mi",null,"P"),s("mo",{stretchy:"false"},"("),s("mi",null,"y"),s("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|"),s("mi",null,"x"),s("mo",null,";"),s("mi",null,"θ"),s("mo",{stretchy:"false"},")")])],-1),_={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},F={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"0"},xmlns:"http://www.w3.org/2000/svg",width:"2.378ex",height:"1.545ex",role:"img",focusable:"false",viewBox:"0 -683 1051 683","aria-hidden":"true"},h=s("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[s("g",{"data-mml-node":"math"},[s("g",{"data-mml-node":"mi"},[s("path",{"data-c":"1D440",d:"M289 629Q289 635 232 637Q208 637 201 638T194 648Q194 649 196 659Q197 662 198 666T199 671T201 676T203 679T207 681T212 683T220 683T232 684Q238 684 262 684T307 683Q386 683 398 683T414 678Q415 674 451 396L487 117L510 154Q534 190 574 254T662 394Q837 673 839 675Q840 676 842 678T846 681L852 683H948Q965 683 988 683T1017 684Q1051 684 1051 673Q1051 668 1048 656T1045 643Q1041 637 1008 637Q968 636 957 634T939 623Q936 618 867 340T797 59Q797 55 798 54T805 50T822 48T855 46H886Q892 37 892 35Q892 19 885 5Q880 0 869 0Q864 0 828 1T736 2Q675 2 644 2T609 1Q592 1 592 11Q592 13 594 25Q598 41 602 43T625 46Q652 46 685 49Q699 52 704 61Q706 65 742 207T813 490T848 631L654 322Q458 10 453 5Q451 4 449 3Q444 0 433 0Q418 0 415 7Q413 11 374 317L335 624L267 354Q200 88 200 79Q206 46 272 46H282Q288 41 289 37T286 19Q282 3 278 1Q274 0 267 0Q265 0 255 0T221 1T157 2Q127 2 95 1T58 0Q43 0 39 2T35 11Q35 13 38 25T43 40Q45 46 65 46Q135 46 154 86Q158 92 223 354T289 629Z",style:{"stroke-width":"3"}})])])],-1),b=[h],g=s("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("mi",null,"M")])],-1),f=p("",5),q=s("li",null,[s("p",null,"Squeeze 阶段：我们对每个特征的 Embedding 向量进行数据压缩与信息汇总，即在 Embedding 维度计算均值："),s("p",null,"​ $$z_i = F_{sq}(e_i) = \\frac{1}{k} \\sum_{t=1}^k e_i^{(t)}$$"),s("p",null,"其中 k 表示 Embedding 的维度，Squeeze 阶段是将每个特征的 Squeeze 转换成单一的数值。")],-1),x={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},D={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.464ex"},xmlns:"http://www.w3.org/2000/svg",width:"5.141ex",height:"2.059ex",role:"img",focusable:"false",viewBox:"0 -705 2272.4 910","aria-hidden":"true"},C=p("",1),A=[C],w=s("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("mn",null,"1"),s("mo",null,"×"),s("mi",null,"f")])],-1),B={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},k={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"0"},xmlns:"http://www.w3.org/2000/svg",width:"1.636ex",height:"1.545ex",role:"img",focusable:"false",viewBox:"0 -683 723 683","aria-hidden":"true"},L=s("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[s("g",{"data-mml-node":"math"},[s("g",{"data-mml-node":"mi"},[s("path",{"data-c":"1D44D",d:"M58 8Q58 23 64 35Q64 36 329 334T596 635L586 637Q575 637 512 637H500H476Q442 637 420 635T365 624T311 598T266 548T228 469Q227 466 226 463T224 458T223 453T222 450L221 448Q218 443 202 443Q185 443 182 453L214 561Q228 606 241 651Q249 679 253 681Q256 683 487 683H718Q723 678 723 675Q723 673 717 649Q189 54 188 52L185 49H274Q369 50 377 51Q452 60 500 100T579 247Q587 272 590 277T603 282H607Q628 282 628 271Q547 5 541 2Q538 0 300 0H124Q58 0 58 8Z",style:{"stroke-width":"3"}})])])],-1),v=[L],H=s("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("mi",null,"Z")])],-1),M={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},Z={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.798ex"},xmlns:"http://www.w3.org/2000/svg",width:"5.772ex",height:"3.023ex",role:"img",focusable:"false",viewBox:"0 -983.5 2551.4 1336.2","aria-hidden":"true"},S=p("",1),V=[S],j=s("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("mn",null,"1"),s("mo",null,"×"),s("mfrac",null,[s("mi",null,"f"),s("mi",null,"r")])])],-1),N={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},P={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.464ex"},xmlns:"http://www.w3.org/2000/svg",width:"5.141ex",height:"2.059ex",role:"img",focusable:"false",viewBox:"0 -705 2272.4 910","aria-hidden":"true"},R=p("",1),z=[R],O=s("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("mn",null,"1"),s("mo",null,"×"),s("mi",null,"f")])],-1),I={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},$={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.025ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.02ex",height:"1.025ex",role:"img",focusable:"false",viewBox:"0 -442 451 453","aria-hidden":"true"},G=s("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[s("g",{"data-mml-node":"math"},[s("g",{"data-mml-node":"mi"},[s("path",{"data-c":"1D45F",d:"M21 287Q22 290 23 295T28 317T38 348T53 381T73 411T99 433T132 442Q161 442 183 430T214 408T225 388Q227 382 228 382T236 389Q284 441 347 441H350Q398 441 422 400Q430 381 430 363Q430 333 417 315T391 292T366 288Q346 288 334 299T322 328Q322 376 378 392Q356 405 342 405Q286 405 239 331Q229 315 224 298T190 165Q156 25 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 114 189T154 366Q154 405 128 405Q107 405 92 377T68 316T57 280Q55 278 41 278H27Q21 284 21 287Z",style:{"stroke-width":"3"}})])])],-1),J=[G],X=s("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("mi",null,"r")])],-1),Y=s("p",null,"​ $$A = F_{ex}(Z) = \\sigma_2(W_2\\sigma_1(W_1Z)) $$",-1),U={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},K={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"0"},xmlns:"http://www.w3.org/2000/svg",width:"1.697ex",height:"1.62ex",role:"img",focusable:"false",viewBox:"0 -716 750 716","aria-hidden":"true"},W=s("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[s("g",{"data-mml-node":"math"},[s("g",{"data-mml-node":"mi"},[s("path",{"data-c":"1D434",d:"M208 74Q208 50 254 46Q272 46 272 35Q272 34 270 22Q267 8 264 4T251 0Q249 0 239 0T205 1T141 2Q70 2 50 0H42Q35 7 35 11Q37 38 48 46H62Q132 49 164 96Q170 102 345 401T523 704Q530 716 547 716H555H572Q578 707 578 706L606 383Q634 60 636 57Q641 46 701 46Q726 46 726 36Q726 34 723 22Q720 7 718 4T704 0Q701 0 690 0T651 1T578 2Q484 2 455 0H443Q437 6 437 9T439 27Q443 40 445 43L449 46H469Q523 49 533 63L521 213H283L249 155Q208 86 208 74ZM516 260Q516 271 504 416T490 562L463 519Q447 492 400 412L310 260L413 259Q516 259 516 260Z",style:{"stroke-width":"3"}})])])],-1),ss=[W],as=s("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("mi",null,"A")])],-1),ns={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},ls={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"0"},xmlns:"http://www.w3.org/2000/svg",width:"1.697ex",height:"1.62ex",role:"img",focusable:"false",viewBox:"0 -716 750 716","aria-hidden":"true"},ps=s("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[s("g",{"data-mml-node":"math"},[s("g",{"data-mml-node":"mi"},[s("path",{"data-c":"1D434",d:"M208 74Q208 50 254 46Q272 46 272 35Q272 34 270 22Q267 8 264 4T251 0Q249 0 239 0T205 1T141 2Q70 2 50 0H42Q35 7 35 11Q37 38 48 46H62Q132 49 164 96Q170 102 345 401T523 704Q530 716 547 716H555H572Q578 707 578 706L606 383Q634 60 636 57Q641 46 701 46Q726 46 726 36Q726 34 723 22Q720 7 718 4T704 0Q701 0 690 0T651 1T578 2Q484 2 455 0H443Q437 6 437 9T439 27Q443 40 445 43L449 46H469Q523 49 533 63L521 213H283L249 155Q208 86 208 74ZM516 260Q516 271 504 416T490 562L463 519Q447 492 400 412L310 260L413 259Q516 259 516 260Z",style:{"stroke-width":"3"}})])])],-1),os=[ps],es=s("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("mi",null,"A")])],-1),ts=p("",12),rs=p("",5),cs=s("li",null,[s("p",null,"归一化：对 user 侧和 item 侧的输入 embedding，进行 L2 归一化"),s("p",null,"​ $$u(x,\\theta) \\leftarrow = \\frac{u(x,\\theta)}{||u(x,\\theta)||_2}$$"),s("p",null,"​ $$v(x,\\theta) \\leftarrow = \\frac{v(x,\\theta)}{||v(x,\\theta)||_2}$$")],-1),is={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},Es={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.025ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.02ex",height:"1.025ex",role:"img",focusable:"false",viewBox:"0 -442 451 453","aria-hidden":"true"},ys=s("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[s("g",{"data-mml-node":"math"},[s("g",{"data-mml-node":"mi"},[s("path",{"data-c":"1D45F",d:"M21 287Q22 290 23 295T28 317T38 348T53 381T73 411T99 433T132 442Q161 442 183 430T214 408T225 388Q227 382 228 382T236 389Q284 441 347 441H350Q398 441 422 400Q430 381 430 363Q430 333 417 315T391 292T366 288Q346 288 334 299T322 328Q322 376 378 392Q356 405 342 405Q286 405 239 331Q229 315 224 298T190 165Q156 25 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 114 189T154 366Q154 405 128 405Q107 405 92 377T68 316T57 280Q55 278 41 278H27Q21 284 21 287Z",style:{"stroke-width":"3"}})])])],-1),ds=[ys],Ts=s("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("mi",null,"r")])],-1),Qs=s("p",null,"​ $$s(u,v) = \\frac{<u(x,\\theta), v(x,\\theta)>}{r}$$",-1),ms=s("p",null,"那为什么需要进行上述的两个操作呢？",-1),us=s("p",null,"归一化的操作主要原因是因为向量点积距离是非度量空间，不满足三角不等式，而归一化的操作使得点击行为转化成了欧式距离。",-1),_s=s("strong",null,"不保序",-1),Fs={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},hs={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"7.454ex",height:"1.357ex",role:"img",focusable:"false",viewBox:"0 -442 3294.7 599.8","aria-hidden":"true"},bs=p("",1),gs=[bs],fs=s("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("mi",null,"u"),s("mi",null,"s"),s("mi",null,"e"),s("msub",null,[s("mi",null,"r"),s("mrow",{"data-mjx-texclass":"ORD"},[s("mi",null,"e"),s("mi",null,"m"),s("mi",null,"b")])])])],-1),qs={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},xs={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"7.662ex",height:"1.852ex",role:"img",focusable:"false",viewBox:"0 -661 3386.7 818.8","aria-hidden":"true"},Ds=p("",1),Cs=[Ds],As=s("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("mi",null,"i"),s("mi",null,"t"),s("mi",null,"e"),s("msub",null,[s("mi",null,"m"),s("mrow",{"data-mjx-texclass":"ORD"},[s("mi",null,"e"),s("mi",null,"m"),s("mi",null,"b")])])])],-1),ws={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},Bs={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.564ex"},xmlns:"http://www.w3.org/2000/svg",width:"20.398ex",height:"2.26ex",role:"img",focusable:"false",viewBox:"0 -749.5 9015.8 999","aria-hidden":"true"},ks=p("",1),Ls=[ks],vs=s("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|"),s("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|"),s("mi",null,"u"),s("mi",null,"s"),s("mi",null,"e"),s("msub",null,[s("mi",null,"r"),s("mrow",{"data-mjx-texclass":"ORD"},[s("mi",null,"e"),s("mi",null,"m"),s("mi",null,"b")])]),s("mo",null,"−"),s("mi",null,"i"),s("mi",null,"t"),s("mi",null,"e"),s("msub",null,[s("mi",null,"m"),s("mrow",{"data-mjx-texclass":"ORD"},[s("mi",null,"e"),s("mi",null,"m"),s("mi",null,"b")])]),s("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|"),s("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|")])],-1),Hs={class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},Ms={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-1.198ex"},xmlns:"http://www.w3.org/2000/svg",width:"107.918ex",height:"4.208ex",role:"img",focusable:"false",viewBox:"0 -1330.5 47699.6 1860","aria-hidden":"true"},Zs=p("",1),Ss=[Zs],Vs=s("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[s("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|"),s("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|"),s("mi",null,"u"),s("mi",null,"s"),s("mi",null,"e"),s("msub",null,[s("mi",null,"r"),s("mrow",{"data-mjx-texclass":"ORD"},[s("mi",null,"e"),s("mi",null,"m"),s("mi",null,"b")])]),s("mo",null,"−"),s("mi",null,"i"),s("mi",null,"t"),s("mi",null,"e"),s("msub",null,[s("mi",null,"m"),s("mrow",{"data-mjx-texclass":"ORD"},[s("mi",null,"e"),s("mi",null,"m"),s("mi",null,"b")])]),s("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|"),s("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|"),s("mo",null,"="),s("msqrt",null,[s("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|"),s("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|"),s("mi",null,"u"),s("mi",null,"s"),s("mi",null,"e"),s("msub",null,[s("mi",null,"r"),s("mrow",{"data-mjx-texclass":"ORD"},[s("mi",null,"e"),s("mi",null,"m"),s("mi",null,"b")])]),s("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|"),s("msup",null,[s("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|"),s("mn",null,"2")]),s("mo",null,"+"),s("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|"),s("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|"),s("mi",null,"i"),s("mi",null,"t"),s("mi",null,"e"),s("msub",null,[s("mi",null,"m"),s("mrow",{"data-mjx-texclass":"ORD"},[s("mi",null,"e"),s("mi",null,"m"),s("mi",null,"b")])]),s("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|"),s("msup",null,[s("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|"),s("mn",null,"2")]),s("mo",null,"−"),s("mn",null,"2"),s("mo",null,"<"),s("mi",null,"u"),s("mi",null,"s"),s("mi",null,"e"),s("msub",null,[s("mi",null,"r"),s("mrow",{"data-mjx-texclass":"ORD"},[s("mi",null,"e"),s("mi",null,"m"),s("mi",null,"b")])]),s("mo",null,","),s("mi",null,"i"),s("mi",null,"t"),s("mi",null,"e"),s("msub",null,[s("mi",null,"m"),s("mrow",{"data-mjx-texclass":"ORD"},[s("mi",null,"e"),s("mi",null,"m"),s("mi",null,"b")])]),s("mo",null,">")]),s("mo",null,"="),s("msqrt",null,[s("mn",null,"2"),s("mo",null,"−"),s("mn",null,"2"),s("mo",null,"<"),s("mi",null,"u"),s("mi",null,"s"),s("mi",null,"e"),s("msub",null,[s("mi",null,"r"),s("mrow",{"data-mjx-texclass":"ORD"},[s("mi",null,"e"),s("mi",null,"m"),s("mi",null,"b")])]),s("mo",null,","),s("mi",null,"i"),s("mi",null,"t"),s("mi",null,"e"),s("msub",null,[s("mi",null,"m"),s("mrow",{"data-mjx-texclass":"ORD"},[s("mi",null,"e"),s("mi",null,"m"),s("mi",null,"b")])]),s("mo",null,">")])])],-1),js=s("p",null,"那没啥非要转为欧式距离呢？这是因为 ANN 一般是通过计算欧式距离进行检索，这样转化成欧式空间，保证训练和检索一致。",-1),Ns=p("",49);function Ps(Rs,zs,Os,Is,$s,Gs){return n(),l("div",null,[t,s("p",null,[a("其中"),s("mjx-container",r,[(n(),l("svg",c,E)),y]),a(" 表示两个向量的相似度，"),s("mjx-container",d,[(n(),l("svg",T,m)),u]),a(" 表示预测类别的概率，"),s("mjx-container",_,[(n(),l("svg",F,b)),g]),a(" 表示物料库所有的 item。但是在实际场景中，由于物料库中的 item 数量巨大，在计算上式时会十分的耗时，因此会采样一定的数量的负样本来近似计算，后面针对负样本的采样做一些简单介绍。")]),f,s("ul",null,[q,s("li",null,[s("p",null,[a("Excitation 阶段：这阶段是根据上一阶段得到的向量进行缩放，即将上阶段的得到的 "),s("mjx-container",x,[(n(),l("svg",D,A)),w]),a(" 的向量"),s("mjx-container",B,[(n(),l("svg",k,v)),H]),a(" 先压缩成 "),s("mjx-container",M,[(n(),l("svg",Z,V)),j]),a(" 长度，然后在放回到 "),s("mjx-container",N,[(n(),l("svg",P,z)),O]),a(" 的维度，其中"),s("mjx-container",I,[(n(),l("svg",$,J)),X]),a(" 表示压缩的程度。这个过程的具体操作就是经过两层 DNN。")]),Y,s("p",null,[a("该过程可以理解为：对于当前所有输入的特征，通过相互发生关联，来动态地判断哪些特征重要，哪些特征不重要，而这体现在 Excitation 阶段的输出结果 "),s("mjx-container",U,[(n(),l("svg",K,ss)),as]),a("，其反应每个特征对应的重要性权重。")])]),s("li",null,[s("p",null,[a("Re-weight 阶段：是将 Excitation 阶段得到的每个特征对应的权重 "),s("mjx-container",ns,[(n(),l("svg",ls,os)),es]),a(" 再乘回到特征对应的 Embedding 里，就完成了对特征重要性的加权操作。")])])]),ts,a(" 如上图所示，在user侧和item侧分别通过多个通道(DNN结构)为每个任务得到一个user embedding和item embedding，然后针对不同的目标分别计算user 和 item 的相似度，并计算各个目标的损失，最后的优化目标可以是多个任务损失之和，或者使用多任务学习中的动态损失权重。 "),rs,s("ul",null,[cs,s("li",null,[s("p",null,[a("温度系数：在归一化之后的向量计算內积之后，除以一个固定的超参 "),s("mjx-container",is,[(n(),l("svg",Es,ds)),Ts]),a(" ，论文中命名为温度系数。")]),Qs,ms]),s("li",null,[us,s("p",null,[a("首先向量点积是向量对应位相乘并求和，即向量內积。而向量內积"),_s,a("，例如空间上三个点 (A=(10,0),B=(0,10),C=(11,0))，利用向量点积计算的距离 dis (A,B) < dis (A,C)，但是在欧式距离下这是错误的。而归一化的操作则会让向量点积转化为欧式距离，例如 "),s("mjx-container",Fs,[(n(),l("svg",hs,gs)),fs]),a(" 表示归一化 user 的 embedding， "),s("mjx-container",qs,[(n(),l("svg",xs,Cs)),As]),a(" 表示归一化 item 的 embedding，那么两者之间的欧式距离 "),s("mjx-container",ws,[(n(),l("svg",Bs,Ls)),vs]),a(" 如下， 可以看出归一化的向量点积已转化成了欧式距离。")]),s("mjx-container",Hs,[(n(),l("svg",Ms,Ss)),Vs]),js])]),Ns])}const Ys=o(e,[["render",Ps]]);export{Xs as __pageData,Ys as default};
