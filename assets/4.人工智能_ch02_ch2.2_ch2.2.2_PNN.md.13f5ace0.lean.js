import{_ as e,o as a,c as T,j as Q,a as t,U as s}from"./chunks/framework.489e5108.js";const P5=JSON.parse('{"title":"PNN","description":"","frontmatter":{},"headers":[],"relativePath":"4.人工智能/ch02/ch2.2/ch2.2.2/PNN.md","filePath":"4.人工智能/ch02/ch2.2/ch2.2.2/PNN.md","lastUpdated":1696176798000}'),l={name:"4.人工智能/ch02/ch2.2/ch2.2.2/PNN.md"},n=s("",9),o={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},m={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.606ex",height:"1.927ex",role:"img",focusable:"false",viewBox:"0 -694 709.8 851.8","aria-hidden":"true"},r=s("",1),d=[r],p=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msub",null,[Q("mi",null,"l"),Q("mi",null,"z")])])],-1),i={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},c={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.65ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.667ex",height:"2.22ex",role:"img",focusable:"false",viewBox:"0 -694 736.7 981.2","aria-hidden":"true"},h=s("",1),g=[h],u=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msub",null,[Q("mi",null,"l"),Q("mi",null,"p")])])],-1),y=Q("div",{align:"center"},[Q("img",{src:"https://ryluo.oss-cn-chengdu.aliyuncs.com/图片image-20210308143101261.png",alt:"image-20210308143101261",style:{zoom:"50%"}})],-1),L={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},x={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.576ex"},xmlns:"http://www.w3.org/2000/svg",width:"18.628ex",height:"2.49ex",role:"img",focusable:"false",viewBox:"0 -846 8233.6 1100.7","aria-hidden":"true"},H=s("",1),w=[H],_=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msub",null,[Q("mi",null,"l"),Q("mi",null,"z")]),Q("mo",null,"="),Q("mo",{stretchy:"false"},"("),Q("msubsup",null,[Q("mi",null,"l"),Q("mi",null,"z"),Q("mn",null,"1")]),Q("mo",null,","),Q("msubsup",null,[Q("mi",null,"l"),Q("mi",null,"z"),Q("mn",null,"2")]),Q("mo",null,","),Q("mo",null,"."),Q("mo",null,"."),Q("mo",null,"."),Q("mo",null,","),Q("msubsup",null,[Q("mi",null,"l"),Q("mi",null,"z"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("msub",null,[Q("mi",null,"D"),Q("mn",null,"1")])])]),Q("mo",{stretchy:"false"},")")])],-1),f={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},M={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.869ex"},xmlns:"http://www.w3.org/2000/svg",width:"18.699ex",height:"2.783ex",role:"img",focusable:"false",viewBox:"0 -846 8264.8 1230.1","aria-hidden":"true"},k=s("",1),b=[k],Z=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msub",null,[Q("mi",null,"l"),Q("mi",null,"p")]),Q("mo",null,"="),Q("mo",{stretchy:"false"},"("),Q("msubsup",null,[Q("mi",null,"l"),Q("mi",null,"p"),Q("mn",null,"1")]),Q("mo",null,","),Q("msubsup",null,[Q("mi",null,"l"),Q("mi",null,"p"),Q("mn",null,"2")]),Q("mo",null,","),Q("mo",null,"."),Q("mo",null,"."),Q("mo",null,"."),Q("mo",null,","),Q("msubsup",null,[Q("mi",null,"l"),Q("mi",null,"p"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("msub",null,[Q("mi",null,"D"),Q("mn",null,"1")])])]),Q("mo",{stretchy:"false"},")")])],-1),D=Q("p",null,[Q("strong",null,"线性部分")],-1),E={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},V={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.606ex",height:"1.927ex",role:"img",focusable:"false",viewBox:"0 -694 709.8 851.8","aria-hidden":"true"},v=s("",1),A=[v],C=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msub",null,[Q("mi",null,"l"),Q("mi",null,"z")])])],-1),j={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},F={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.606ex",height:"1.927ex",role:"img",focusable:"false",viewBox:"0 -694 709.8 851.8","aria-hidden":"true"},R=s("",1),S=[R],B=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msub",null,[Q("mi",null,"l"),Q("mi",null,"z")])])],-1),O={class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},P={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-3.006ex"},xmlns:"http://www.w3.org/2000/svg",width:"19.942ex",height:"5.155ex",role:"img",focusable:"false",viewBox:"0 -950 8814.4 2278.6","aria-hidden":"true"},N=s("",1),I=[N],z=Q("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[Q("mi",null,"A"),Q("mo",null,"⊙"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"B")]),Q("mo",null,"="),Q("munder",null,[Q("mo",{"data-mjx-texclass":"OP"},"∑"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"i"),Q("mo",null,","),Q("mi",null,"j")])]),Q("msub",null,[Q("mi",null,"A"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"i"),Q("mo",null,","),Q("mi",null,"j")])]),Q("msub",null,[Q("mi",null,"B"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"i"),Q("mo",null,","),Q("mi",null,"j")])])])],-1),X={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},J={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.576ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.822ex",height:"2.147ex",role:"img",focusable:"false",viewBox:"0 -694 805.3 948.8","aria-hidden":"true"},G=s("",1),W=[G],q=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msubsup",null,[Q("mi",null,"l"),Q("mi",null,"z"),Q("mi",null,"n")])])],-1),$={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},U={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.606ex",height:"1.927ex",role:"img",focusable:"false",viewBox:"0 -694 709.8 851.8","aria-hidden":"true"},K=s("",1),Y=[K],Q1=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msub",null,[Q("mi",null,"l"),Q("mi",null,"z")])])],-1),t1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},a1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.339ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.861ex",height:"1.885ex",role:"img",focusable:"false",viewBox:"0 -683 1264.6 833","aria-hidden":"true"},T1=s("",1),s1=[T1],e1=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msub",null,[Q("mi",null,"D"),Q("mn",null,"1")])])],-1),l1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},n1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.576ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.822ex",height:"2.147ex",role:"img",focusable:"false",viewBox:"0 -694 805.3 948.8","aria-hidden":"true"},o1=s("",1),m1=[o1],r1=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msubsup",null,[Q("mi",null,"l"),Q("mi",null,"z"),Q("mi",null,"n")])])],-1),d1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},p1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"0"},xmlns:"http://www.w3.org/2000/svg",width:"3.005ex",height:"1.545ex",role:"img",focusable:"false",viewBox:"0 -683 1328 683","aria-hidden":"true"},i1=s("",1),c1=[i1],h1=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"D"),Q("mn",null,"1")])],-1),g1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},u1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.339ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.861ex",height:"1.885ex",role:"img",focusable:"false",viewBox:"0 -683 1264.6 833","aria-hidden":"true"},y1=s("",1),L1=[y1],x1=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msub",null,[Q("mi",null,"D"),Q("mn",null,"1")])])],-1),H1={class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},w1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.576ex"},xmlns:"http://www.w3.org/2000/svg",width:"49.534ex",height:"2.603ex",role:"img",focusable:"false",viewBox:"0 -896 21893.9 1150.7","aria-hidden":"true"},_1=s("",1),f1=[_1],M1=Q("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[Q("msub",null,[Q("mi",null,"l"),Q("mi",null,"z")]),Q("mo",null,"="),Q("mo",{stretchy:"false"},"("),Q("msubsup",null,[Q("mi",null,"l"),Q("mi",null,"z"),Q("mn",null,"1")]),Q("mo",null,","),Q("msubsup",null,[Q("mi",null,"l"),Q("mi",null,"z"),Q("mn",null,"2")]),Q("mo",null,","),Q("mo",null,"."),Q("mo",null,"."),Q("mo",null,"."),Q("mo",null,","),Q("msubsup",null,[Q("mi",null,"l"),Q("mi",null,"z"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("msub",null,[Q("mi",null,"D"),Q("mn",null,"1")])])]),Q("mo",{stretchy:"false"},")"),Q("mspace",{linebreak:"newline"}),Q("msubsup",null,[Q("mi",null,"l"),Q("mi",null,"z"),Q("mi",null,"n")]),Q("mo",null,"="),Q("msubsup",null,[Q("mi",null,"W"),Q("mi",null,"z"),Q("mi",null,"n")]),Q("mo",null,"⊙"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"z")]),Q("mspace",{linebreak:"newline"}),Q("mi",null,"z"),Q("mo",null,"="),Q("mo",{stretchy:"false"},"("),Q("msub",null,[Q("mi",null,"z"),Q("mn",null,"1")]),Q("mo",null,","),Q("msub",null,[Q("mi",null,"z"),Q("mn",null,"2")]),Q("mo",null,","),Q("mo",null,"."),Q("mo",null,"."),Q("mo",null,"."),Q("mo",null,","),Q("msub",null,[Q("mi",null,"z"),Q("mi",null,"N")]),Q("mo",{stretchy:"false"},")")])],-1),k1=Q("p",null,"总之这一波操作就是将所有的 embedding 向量中的所有元素都乘以一个矩阵的对应元素，最后相加即可，这一部分比较简单 (N 表示的是特征的数量，M 表示的是所有特征转化为 embedding 之后维度，也就是 N*emb_dim)",-1),b1={class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},Z1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-3.014ex"},xmlns:"http://www.w3.org/2000/svg",width:"32.371ex",height:"6.935ex",role:"img",focusable:"false",viewBox:"0 -1733 14308.1 3065.1","aria-hidden":"true"},D1=s("",1),E1=[D1],V1=Q("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[Q("msubsup",null,[Q("mi",null,"l"),Q("mi",null,"z"),Q("mi",null,"n")]),Q("mo",null,"="),Q("msubsup",null,[Q("mi",null,"W"),Q("mi",null,"z"),Q("mi",null,"n")]),Q("mo",null,"⊙"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"z")]),Q("mo",null,"="),Q("munderover",null,[Q("mo",{"data-mjx-texclass":"OP"},"∑"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"i"),Q("mo",null,"="),Q("mn",null,"1")]),Q("mi",null,"N")]),Q("munderover",null,[Q("mo",{"data-mjx-texclass":"OP"},"∑"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"j"),Q("mo",null,"="),Q("mn",null,"1")]),Q("mi",null,"M")]),Q("mo",{stretchy:"false"},"("),Q("msubsup",null,[Q("mi",null,"W"),Q("mi",null,"z"),Q("mi",null,"n")]),Q("msub",null,[Q("mo",{stretchy:"false"},")"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"i"),Q("mo",null,","),Q("mi",null,"j")])]),Q("msub",null,[Q("mi",null,"z"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"i"),Q("mo",null,","),Q("mi",null,"j")])])])],-1),v1=Q("h3",{id:"product-layer",tabindex:"-1"},[t("Product Layer "),Q("a",{class:"header-anchor",href:"#product-layer","aria-label":'Permalink to "Product Layer"'},"​")],-1),A1=Q("p",null,[Q("strong",null,"非线性部分")],-1),C1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},j1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.65ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.667ex",height:"2.22ex",role:"img",focusable:"false",viewBox:"0 -694 736.7 981.2","aria-hidden":"true"},F1=s("",1),R1=[F1],S1=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msub",null,[Q("mi",null,"l"),Q("mi",null,"p")])])],-1),B1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},O1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.65ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.667ex",height:"2.22ex",role:"img",focusable:"false",viewBox:"0 -694 736.7 981.2","aria-hidden":"true"},P1=s("",1),N1=[P1],I1=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msub",null,[Q("mi",null,"l"),Q("mi",null,"p")])])],-1),z1={class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},X1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.869ex"},xmlns:"http://www.w3.org/2000/svg",width:"70.858ex",height:"2.896ex",role:"img",focusable:"false",viewBox:"0 -896 31319.3 1280.1","aria-hidden":"true"},J1=s("",1),G1=[J1],W1=Q("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[Q("msub",null,[Q("mi",null,"l"),Q("mi",null,"p")]),Q("mo",null,"="),Q("mo",{stretchy:"false"},"("),Q("msubsup",null,[Q("mi",null,"l"),Q("mi",null,"p"),Q("mn",null,"1")]),Q("mo",null,","),Q("msubsup",null,[Q("mi",null,"l"),Q("mi",null,"p"),Q("mn",null,"2")]),Q("mo",null,","),Q("mo",null,"."),Q("mo",null,"."),Q("mo",null,"."),Q("mo",null,","),Q("msubsup",null,[Q("mi",null,"l"),Q("mi",null,"p"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("msub",null,[Q("mi",null,"D"),Q("mn",null,"1")])])]),Q("mo",{stretchy:"false"},")"),Q("mspace",{linebreak:"newline"}),Q("msubsup",null,[Q("mi",null,"l"),Q("mi",null,"p"),Q("mi",null,"n")]),Q("mo",null,"="),Q("msubsup",null,[Q("mi",null,"W"),Q("mi",null,"p"),Q("mi",null,"n")]),Q("mo",null,"⊙"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"p")]),Q("mspace",{linebreak:"newline"}),Q("mi",null,"p"),Q("mo",null,"="),Q("mo",{fence:"false",stretchy:"false"},"{"),Q("msub",null,[Q("mi",null,"p"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"i"),Q("mo",null,","),Q("mi",null,"j")])]),Q("mo",{fence:"false",stretchy:"false"},"}"),Q("mo",null,","),Q("mi",null,"i"),Q("mo",null,"="),Q("mn",null,"1"),Q("mo",null,","),Q("mn",null,"2"),Q("mo",null,","),Q("mo",null,"."),Q("mo",null,"."),Q("mo",null,"."),Q("mo",null,","),Q("mi",null,"N"),Q("mo",null,","),Q("mi",null,"j"),Q("mo",null,"="),Q("mn",null,"1"),Q("mo",null,","),Q("mn",null,"2"),Q("mo",null,","),Q("mo",null,"."),Q("mo",null,"."),Q("mo",null,"."),Q("mo",null,","),Q("mi",null,"N")])],-1),q1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},$1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.869ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.822ex",height:"2.439ex",role:"img",focusable:"false",viewBox:"0 -694 805.3 1078.2","aria-hidden":"true"},U1=s("",1),K1=[U1],Y1=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msubsup",null,[Q("mi",null,"l"),Q("mi",null,"p"),Q("mi",null,"n")])])],-1),Q2={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},t2={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.576ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.822ex",height:"2.147ex",role:"img",focusable:"false",viewBox:"0 -694 805.3 948.8","aria-hidden":"true"},a2=s("",1),T2=[a2],s2=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msubsup",null,[Q("mi",null,"l"),Q("mi",null,"z"),Q("mi",null,"n")])])],-1),e2={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},l2={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.339ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.861ex",height:"1.885ex",role:"img",focusable:"false",viewBox:"0 -683 1264.6 833","aria-hidden":"true"},n2=s("",1),o2=[n2],m2=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msub",null,[Q("mi",null,"D"),Q("mn",null,"1")])])],-1),r2={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},d2={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.869ex"},xmlns:"http://www.w3.org/2000/svg",width:"3.644ex",height:"2.414ex",role:"img",focusable:"false",viewBox:"0 -683 1610.5 1067.2","aria-hidden":"true"},p2=s("",1),i2=[p2],c2=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msubsup",null,[Q("mi",null,"W"),Q("mi",null,"p"),Q("mi",null,"n")])])],-1),h2={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},g2={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.439ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.138ex",height:"1.439ex",role:"img",focusable:"false",viewBox:"0 -442 503 636","aria-hidden":"true"},u2=Q("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[Q("g",{"data-mml-node":"math"},[Q("g",{"data-mml-node":"mi"},[Q("path",{"data-c":"1D45D",d:"M23 287Q24 290 25 295T30 317T40 348T55 381T75 411T101 433T134 442Q209 442 230 378L240 387Q302 442 358 442Q423 442 460 395T497 281Q497 173 421 82T249 -10Q227 -10 210 -4Q199 1 187 11T168 28L161 36Q160 35 139 -51T118 -138Q118 -144 126 -145T163 -148H188Q194 -155 194 -157T191 -175Q188 -187 185 -190T172 -194Q170 -194 161 -194T127 -193T65 -192Q-5 -192 -24 -194H-32Q-39 -187 -39 -183Q-37 -156 -26 -148H-6Q28 -147 33 -136Q36 -130 94 103T155 350Q156 355 156 364Q156 405 131 405Q109 405 94 377T71 316T59 280Q57 278 43 278H29Q23 284 23 287ZM178 102Q200 26 252 26Q282 26 310 49T356 107Q374 141 392 215T411 325V331Q411 405 350 405Q339 405 328 402T306 393T286 380T269 365T254 350T243 336T235 326L232 322Q232 321 229 308T218 264T204 212Q178 106 178 102Z",style:{"stroke-width":"3"}})])])],-1),y2=[u2],L2=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"p")])],-1),x2=Q("h4",{id:"ipnn",tabindex:"-1"},[t("IPNN "),Q("a",{class:"header-anchor",href:"#ipnn","aria-label":'Permalink to "IPNN"'},"​")],-1),H2=Q("p",null,"使用内积实现特征交叉就和 FM 是类似的 (两两向量计算内积)，下面将向量内积操作表示如下表达式",-1),w2={class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},_2={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.666ex"},xmlns:"http://www.w3.org/2000/svg",width:"19.625ex",height:"2.363ex",role:"img",focusable:"false",viewBox:"0 -750 8674.2 1044.2","aria-hidden":"true"},f2=s("",1),M2=[f2],k2=Q("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[Q("mi",null,"g"),Q("mo",{stretchy:"false"},"("),Q("msub",null,[Q("mi",null,"f"),Q("mi",null,"i")]),Q("mo",null,","),Q("msub",null,[Q("mi",null,"f"),Q("mi",null,"j")]),Q("mo",{stretchy:"false"},")"),Q("mo",null,"=<"),Q("msub",null,[Q("mi",null,"f"),Q("mi",null,"i")]),Q("mo",null,","),Q("msub",null,[Q("mi",null,"f"),Q("mi",null,"j")]),Q("mo",null,">")])],-1),b2={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},Z2={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.869ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.822ex",height:"2.439ex",role:"img",focusable:"false",viewBox:"0 -694 805.3 1078.2","aria-hidden":"true"},D2=s("",1),E2=[D2],V2=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msubsup",null,[Q("mi",null,"l"),Q("mi",null,"p"),Q("mi",null,"n")])])],-1),v2={class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},A2={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-8.331ex"},xmlns:"http://www.w3.org/2000/svg",width:"29.213ex",height:"17.793ex",role:"img",focusable:"false",viewBox:"0 -4182.2 12912.1 7864.5","aria-hidden":"true"},C2=s("",1),j2=[C2],F2=Q("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[Q("mtable",{displaystyle:"true",columnalign:"right left",columnspacing:"0em",rowspacing:"3pt"},[Q("mtr",null,[Q("mtd",null,[Q("msubsup",null,[Q("mi",null,"l"),Q("mi",null,"p"),Q("mi",null,"n")])]),Q("mtd",null,[Q("mi"),Q("mo",null,"="),Q("msubsup",null,[Q("mi",null,"W"),Q("mi",null,"p"),Q("mi",null,"n")]),Q("mo",null,"⊙"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"p")])])]),Q("mtr",null,[Q("mtd"),Q("mtd",null,[Q("mi"),Q("mo",null,"="),Q("munderover",null,[Q("mo",{"data-mjx-texclass":"OP"},"∑"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"i"),Q("mo",null,"="),Q("mn",null,"1")]),Q("mi",null,"N")]),Q("munderover",null,[Q("mo",{"data-mjx-texclass":"OP"},"∑"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"j"),Q("mo",null,"="),Q("mn",null,"1")]),Q("mi",null,"N")]),Q("mo",{stretchy:"false"},"("),Q("msubsup",null,[Q("mi",null,"W"),Q("mi",null,"p"),Q("mi",null,"n")]),Q("msub",null,[Q("mo",{stretchy:"false"},")"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"i"),Q("mo",null,","),Q("mi",null,"j")])]),Q("msub",null,[Q("mi",null,"p"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"i"),Q("mo",null,","),Q("mi",null,"j")])])])]),Q("mtr",null,[Q("mtd"),Q("mtd",null,[Q("mi"),Q("mo",null,"="),Q("munderover",null,[Q("mo",{"data-mjx-texclass":"OP"},"∑"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"i"),Q("mo",null,"="),Q("mn",null,"1")]),Q("mi",null,"N")]),Q("munderover",null,[Q("mo",{"data-mjx-texclass":"OP"},"∑"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"j"),Q("mo",null,"="),Q("mn",null,"1")]),Q("mi",null,"N")]),Q("mo",{stretchy:"false"},"("),Q("msubsup",null,[Q("mi",null,"W"),Q("mi",null,"p"),Q("mi",null,"n")]),Q("msub",null,[Q("mo",{stretchy:"false"},")"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"i"),Q("mo",null,","),Q("mi",null,"j")])]),Q("mo",null,"<"),Q("msub",null,[Q("mi",null,"f"),Q("mi",null,"i")]),Q("mo",null,","),Q("msub",null,[Q("mi",null,"f"),Q("mi",null,"j")]),Q("mo",null,">")])])])])],-1),R2=Q("p",null,"上面就提到了这里使用的内积是计算两两特征之间的内积，然而向量 a 和向量 b 的内积与向量 b 和向量 a 的内积是相同的，其实是没必要计算的，看一下下面 FM 的计算公式：",-1),S2={class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},B2={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-3.014ex"},xmlns:"http://www.w3.org/2000/svg",width:"46.705ex",height:"6.549ex",role:"img",focusable:"false",viewBox:"0 -1562.5 20643.7 2894.7","aria-hidden":"true"},O2=s("",1),P2=[O2],N2=Q("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mover",null,[Q("mi",null,"y"),Q("mo",{stretchy:"false"},"^")])]),Q("mo",{stretchy:"false"},"("),Q("mi",null,"X"),Q("mo",{stretchy:"false"},")"),Q("mo",null,"="),Q("msub",null,[Q("mi",null,"ω"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mn",null,"0")])]),Q("mo",null,"+"),Q("munderover",null,[Q("mo",{"data-mjx-texclass":"OP"},"∑"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"i"),Q("mo",null,"="),Q("mn",null,"1")]),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"n")])]),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("msub",null,[Q("mi",null,"ω"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"i")])]),Q("msub",null,[Q("mi",null,"x"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"i")])])]),Q("mo",null,"+"),Q("munderover",null,[Q("mo",{"data-mjx-texclass":"OP"},"∑"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"i"),Q("mo",null,"="),Q("mn",null,"1")]),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"n")])]),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("munderover",null,[Q("mo",{"data-mjx-texclass":"OP"},"∑"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"j"),Q("mo",null,"="),Q("mi",null,"i"),Q("mo",null,"+"),Q("mn",null,"1")]),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"n")])]),Q("mo",null,"<"),Q("msub",null,[Q("mi",null,"v"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"i")])]),Q("mo",null,","),Q("msub",null,[Q("mi",null,"v"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"j")])]),Q("mo",null,">"),Q("msub",null,[Q("mi",null,"x"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"i")])]),Q("msub",null,[Q("mi",null,"x"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"j")])])])])],-1),I2={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},z2={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.439ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.138ex",height:"1.439ex",role:"img",focusable:"false",viewBox:"0 -442 503 636","aria-hidden":"true"},X2=Q("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[Q("g",{"data-mml-node":"math"},[Q("g",{"data-mml-node":"mi"},[Q("path",{"data-c":"1D45D",d:"M23 287Q24 290 25 295T30 317T40 348T55 381T75 411T101 433T134 442Q209 442 230 378L240 387Q302 442 358 442Q423 442 460 395T497 281Q497 173 421 82T249 -10Q227 -10 210 -4Q199 1 187 11T168 28L161 36Q160 35 139 -51T118 -138Q118 -144 126 -145T163 -148H188Q194 -155 194 -157T191 -175Q188 -187 185 -190T172 -194Q170 -194 161 -194T127 -193T65 -192Q-5 -192 -24 -194H-32Q-39 -187 -39 -183Q-37 -156 -26 -148H-6Q28 -147 33 -136Q36 -130 94 103T155 350Q156 355 156 364Q156 405 131 405Q109 405 94 377T71 316T59 280Q57 278 43 278H29Q23 284 23 287ZM178 102Q200 26 252 26Q282 26 310 49T356 107Q374 141 392 215T411 325V331Q411 405 350 405Q339 405 328 402T306 393T286 380T269 365T254 350T243 336T235 326L232 322Q232 321 229 308T218 264T204 212Q178 106 178 102Z",style:{"stroke-width":"3"}})])])],-1),J2=[X2],G2=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"p")])],-1),W2={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},q2={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.869ex"},xmlns:"http://www.w3.org/2000/svg",width:"3.644ex",height:"2.414ex",role:"img",focusable:"false",viewBox:"0 -683 1610.5 1067.2","aria-hidden":"true"},$2=s("",1),U2=[$2],K2=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msubsup",null,[Q("mi",null,"W"),Q("mi",null,"p"),Q("mi",null,"n")])])],-1),Y2={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},Q3={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.869ex"},xmlns:"http://www.w3.org/2000/svg",width:"12.204ex",height:"2.774ex",role:"img",focusable:"false",viewBox:"0 -841.7 5394.4 1225.9","aria-hidden":"true"},t3=s("",1),a3=[t3],T3=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msubsup",null,[Q("mi",null,"W"),Q("mi",null,"p"),Q("mi",null,"n")]),Q("mo",null,"="),Q("msup",null,[Q("mi",null,"θ"),Q("mi",null,"n")]),Q("msup",null,[Q("mi",null,"θ"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"n"),Q("mi",null,"T")])])])],-1),s3={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},e3={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.09ex"},xmlns:"http://www.w3.org/2000/svg",width:"8.3ex",height:"2.004ex",role:"img",focusable:"false",viewBox:"0 -846 3668.7 886","aria-hidden":"true"},l3=s("",1),n3=[l3],o3=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msup",null,[Q("mi",null,"θ"),Q("mi",null,"n")]),Q("mo",null,"∈"),Q("msup",null,[Q("mi",null,"R"),Q("mi",null,"N")])])],-1),m3={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},r3={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"0"},xmlns:"http://www.w3.org/2000/svg",width:"3.119ex",height:"1.887ex",role:"img",focusable:"false",viewBox:"0 -833.9 1378.8 833.9","aria-hidden":"true"},d3=s("",1),p3=[d3],i3=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msup",null,[Q("mi",null,"N"),Q("mn",null,"2")])])],-1),c3={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},h3={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"0"},xmlns:"http://www.w3.org/2000/svg",width:"2.009ex",height:"1.545ex",role:"img",focusable:"false",viewBox:"0 -683 888 683","aria-hidden":"true"},g3=Q("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[Q("g",{"data-mml-node":"math"},[Q("g",{"data-mml-node":"mi"},[Q("path",{"data-c":"1D441",d:"M234 637Q231 637 226 637Q201 637 196 638T191 649Q191 676 202 682Q204 683 299 683Q376 683 387 683T401 677Q612 181 616 168L670 381Q723 592 723 606Q723 633 659 637Q635 637 635 648Q635 650 637 660Q641 676 643 679T653 683Q656 683 684 682T767 680Q817 680 843 681T873 682Q888 682 888 672Q888 650 880 642Q878 637 858 637Q787 633 769 597L620 7Q618 0 599 0Q585 0 582 2Q579 5 453 305L326 604L261 344Q196 88 196 79Q201 46 268 46H278Q284 41 284 38T282 19Q278 6 272 0H259Q228 2 151 2Q123 2 100 2T63 2T46 1Q31 1 31 10Q31 14 34 26T39 40Q41 46 62 46Q130 49 150 85Q154 91 221 362L289 634Q287 635 234 637Z",style:{"stroke-width":"3"}})])])],-1),u3=[g3],y3=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"N")])],-1),L3={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},x3={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.869ex"},xmlns:"http://www.w3.org/2000/svg",width:"3.644ex",height:"2.414ex",role:"img",focusable:"false",viewBox:"0 -683 1610.5 1067.2","aria-hidden":"true"},H3=s("",1),w3=[H3],_3=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msubsup",null,[Q("mi",null,"W"),Q("mi",null,"p"),Q("mi",null,"n")])])],-1),f3={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},M3={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.869ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.822ex",height:"2.439ex",role:"img",focusable:"false",viewBox:"0 -694 805.3 1078.2","aria-hidden":"true"},k3=s("",1),b3=[k3],Z3=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msubsup",null,[Q("mi",null,"l"),Q("mi",null,"p"),Q("mi",null,"n")])])],-1),D3={class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},E3={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-19.653ex"},xmlns:"http://www.w3.org/2000/svg",width:"26.76ex",height:"40.438ex",role:"img",focusable:"false",viewBox:"0 -9186.8 11828 17873.6","aria-hidden":"true"},V3=s("",1),v3=[V3],A3=Q("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[Q("mtable",{displaystyle:"true",columnalign:"right left",columnspacing:"0em",rowspacing:"3pt"},[Q("mtr",null,[Q("mtd",null,[Q("msubsup",null,[Q("mi",null,"l"),Q("mi",null,"p"),Q("mi",null,"n")])]),Q("mtd",null,[Q("mi"),Q("mo",null,"="),Q("msubsup",null,[Q("mi",null,"W"),Q("mi",null,"p"),Q("mi",null,"n")]),Q("mo",null,"⊙"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"p")])])]),Q("mtr",null,[Q("mtd"),Q("mtd",null,[Q("mi"),Q("mo",null,"="),Q("munderover",null,[Q("mo",{"data-mjx-texclass":"OP"},"∑"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"i"),Q("mo",null,"="),Q("mn",null,"1")]),Q("mi",null,"N")]),Q("munderover",null,[Q("mo",{"data-mjx-texclass":"OP"},"∑"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"j"),Q("mo",null,"="),Q("mn",null,"1")]),Q("mi",null,"N")]),Q("mo",{stretchy:"false"},"("),Q("msubsup",null,[Q("mi",null,"W"),Q("mi",null,"p"),Q("mi",null,"n")]),Q("msub",null,[Q("mo",{stretchy:"false"},")"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"i"),Q("mo",null,","),Q("mi",null,"j")])]),Q("msub",null,[Q("mi",null,"p"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"i"),Q("mo",null,","),Q("mi",null,"j")])])])]),Q("mtr",null,[Q("mtd"),Q("mtd",null,[Q("mi"),Q("mo",null,"="),Q("munderover",null,[Q("mo",{"data-mjx-texclass":"OP"},"∑"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"i"),Q("mo",null,"="),Q("mn",null,"1")]),Q("mi",null,"N")]),Q("munderover",null,[Q("mo",{"data-mjx-texclass":"OP"},"∑"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"j"),Q("mo",null,"="),Q("mn",null,"1")]),Q("mi",null,"N")]),Q("msup",null,[Q("mi",null,"θ"),Q("mi",null,"n")]),Q("msup",null,[Q("mi",null,"θ"),Q("mi",null,"n")]),Q("mo",null,"<"),Q("msub",null,[Q("mi",null,"f"),Q("mi",null,"i")]),Q("mo",null,","),Q("msub",null,[Q("mi",null,"f"),Q("mi",null,"j")]),Q("mo",null,">")])]),Q("mtr",null,[Q("mtd"),Q("mtd",null,[Q("mi"),Q("mo",null,"="),Q("munderover",null,[Q("mo",{"data-mjx-texclass":"OP"},"∑"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"i"),Q("mo",null,"="),Q("mn",null,"1")]),Q("mi",null,"N")]),Q("munderover",null,[Q("mo",{"data-mjx-texclass":"OP"},"∑"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"j"),Q("mo",null,"="),Q("mn",null,"1")]),Q("mi",null,"N")]),Q("mo",null,"<"),Q("msup",null,[Q("mi",null,"θ"),Q("mi",null,"n")]),Q("msub",null,[Q("mi",null,"f"),Q("mi",null,"i")]),Q("mo",null,","),Q("msup",null,[Q("mi",null,"θ"),Q("mi",null,"n")]),Q("msub",null,[Q("mi",null,"f"),Q("mi",null,"j")]),Q("mo",null,">")])]),Q("mtr",null,[Q("mtd"),Q("mtd",null,[Q("mi"),Q("mo",null,"=<"),Q("munderover",null,[Q("mo",{"data-mjx-texclass":"OP"},"∑"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"i"),Q("mo",null,"="),Q("mn",null,"1")]),Q("mi",null,"N")]),Q("msup",null,[Q("mi",null,"θ"),Q("mi",null,"n")]),Q("msub",null,[Q("mi",null,"f"),Q("mi",null,"i")]),Q("mo",null,","),Q("munderover",null,[Q("mo",{"data-mjx-texclass":"OP"},"∑"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"j"),Q("mo",null,"="),Q("mn",null,"1")]),Q("mi",null,"N")]),Q("msup",null,[Q("mi",null,"θ"),Q("mi",null,"n")]),Q("msub",null,[Q("mi",null,"f"),Q("mi",null,"j")]),Q("mo",null,">")])]),Q("mtr",null,[Q("mtd"),Q("mtd",null,[Q("mi"),Q("mo",null,"="),Q("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|"),Q("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|"),Q("munderover",null,[Q("mo",{"data-mjx-texclass":"OP"},"∑"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"i"),Q("mo",null,"="),Q("mn",null,"1")]),Q("mi",null,"N")]),Q("msup",null,[Q("mi",null,"θ"),Q("mi",null,"n")]),Q("msub",null,[Q("mi",null,"f"),Q("mi",null,"i")]),Q("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|"),Q("msup",null,[Q("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|"),Q("mn",null,"2")])])])])])],-1),C3={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},j3={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.65ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.667ex",height:"2.22ex",role:"img",focusable:"false",viewBox:"0 -694 736.7 981.2","aria-hidden":"true"},F3=s("",1),R3=[F3],S3=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msub",null,[Q("mi",null,"l"),Q("mi",null,"p")])])],-1),B3={class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},O3={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-2.819ex"},xmlns:"http://www.w3.org/2000/svg",width:"47.968ex",height:"6.74ex",role:"img",focusable:"false",viewBox:"0 -1733 21202 2978.9","aria-hidden":"true"},P3=s("",1),N3=[P3],I3=Q("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[Q("msub",null,[Q("mi",null,"l"),Q("mi",null,"p")]),Q("mo",null,"="),Q("mo",{stretchy:"false"},"("),Q("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|"),Q("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|"),Q("munderover",null,[Q("mo",{"data-mjx-texclass":"OP"},"∑"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"i"),Q("mo",null,"="),Q("mn",null,"1")]),Q("mi",null,"N")]),Q("msup",null,[Q("mi",null,"θ"),Q("mn",null,"1")]),Q("msub",null,[Q("mi",null,"f"),Q("mi",null,"i")]),Q("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|"),Q("msup",null,[Q("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|"),Q("mn",null,"2")]),Q("mo",null,","),Q("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|"),Q("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|"),Q("munderover",null,[Q("mo",{"data-mjx-texclass":"OP"},"∑"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"i"),Q("mo",null,"="),Q("mn",null,"1")]),Q("mi",null,"N")]),Q("msup",null,[Q("mi",null,"θ"),Q("mn",null,"2")]),Q("msub",null,[Q("mi",null,"f"),Q("mi",null,"i")]),Q("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|"),Q("msup",null,[Q("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|"),Q("mn",null,"2")]),Q("mo",null,","),Q("mo",null,"."),Q("mo",null,"."),Q("mo",null,"."),Q("mo",null,","),Q("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|"),Q("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|"),Q("munderover",null,[Q("mo",{"data-mjx-texclass":"OP"},"∑"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"i"),Q("mo",null,"="),Q("mn",null,"1")]),Q("mi",null,"N")]),Q("msup",null,[Q("mi",null,"θ"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("msub",null,[Q("mi",null,"D"),Q("mn",null,"1")])])]),Q("msub",null,[Q("mi",null,"f"),Q("mi",null,"i")]),Q("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|"),Q("msup",null,[Q("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|"),Q("mn",null,"2")]),Q("mo",{stretchy:"false"},")")])],-1),z3=Q("p",null,"这里为了好理解不做过多的解释，其实这里对于矩阵分解省略了一些细节，感兴趣的可以去看原文，最后模型实现的时候就是基于上面的这个公式计算的（给出的代码也是基于优化之后的实现）。",-1),X3=Q("h4",{id:"opnn",tabindex:"-1"},[t("OPNN "),Q("a",{class:"header-anchor",href:"#opnn","aria-label":'Permalink to "OPNN"'},"​")],-1),J3={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},G3={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.439ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.138ex",height:"1.439ex",role:"img",focusable:"false",viewBox:"0 -442 503 636","aria-hidden":"true"},W3=Q("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[Q("g",{"data-mml-node":"math"},[Q("g",{"data-mml-node":"mi"},[Q("path",{"data-c":"1D45D",d:"M23 287Q24 290 25 295T30 317T40 348T55 381T75 411T101 433T134 442Q209 442 230 378L240 387Q302 442 358 442Q423 442 460 395T497 281Q497 173 421 82T249 -10Q227 -10 210 -4Q199 1 187 11T168 28L161 36Q160 35 139 -51T118 -138Q118 -144 126 -145T163 -148H188Q194 -155 194 -157T191 -175Q188 -187 185 -190T172 -194Q170 -194 161 -194T127 -193T65 -192Q-5 -192 -24 -194H-32Q-39 -187 -39 -183Q-37 -156 -26 -148H-6Q28 -147 33 -136Q36 -130 94 103T155 350Q156 355 156 364Q156 405 131 405Q109 405 94 377T71 316T59 280Q57 278 43 278H29Q23 284 23 287ZM178 102Q200 26 252 26Q282 26 310 49T356 107Q374 141 392 215T411 325V331Q411 405 350 405Q339 405 328 402T306 393T286 380T269 365T254 350T243 336T235 326L232 322Q232 321 229 308T218 264T204 212Q178 106 178 102Z",style:{"stroke-width":"3"}})])])],-1),q3=[W3],$3=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"p")])],-1),U3={class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},K3={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.885ex"},xmlns:"http://www.w3.org/2000/svg",width:"13.102ex",height:"2.903ex",role:"img",focusable:"false",viewBox:"0 -891.7 5791 1283","aria-hidden":"true"},Y3=s("",1),Q6=[Y3],t6=Q("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[Q("mi",null,"g"),Q("mo",{stretchy:"false"},"("),Q("mi",null,"i"),Q("mo",null,","),Q("mi",null,"j"),Q("mo",{stretchy:"false"},")"),Q("mo",null,"="),Q("msub",null,[Q("mi",null,"f"),Q("mi",null,"i")]),Q("msubsup",null,[Q("mi",null,"f"),Q("mi",null,"j"),Q("mi",null,"T")])])],-1),a6={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},T6={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.439ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.138ex",height:"1.439ex",role:"img",focusable:"false",viewBox:"0 -442 503 636","aria-hidden":"true"},s6=Q("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[Q("g",{"data-mml-node":"math"},[Q("g",{"data-mml-node":"mi"},[Q("path",{"data-c":"1D45D",d:"M23 287Q24 290 25 295T30 317T40 348T55 381T75 411T101 433T134 442Q209 442 230 378L240 387Q302 442 358 442Q423 442 460 395T497 281Q497 173 421 82T249 -10Q227 -10 210 -4Q199 1 187 11T168 28L161 36Q160 35 139 -51T118 -138Q118 -144 126 -145T163 -148H188Q194 -155 194 -157T191 -175Q188 -187 185 -190T172 -194Q170 -194 161 -194T127 -193T65 -192Q-5 -192 -24 -194H-32Q-39 -187 -39 -183Q-37 -156 -26 -148H-6Q28 -147 33 -136Q36 -130 94 103T155 350Q156 355 156 364Q156 405 131 405Q109 405 94 377T71 316T59 280Q57 278 43 278H29Q23 284 23 287ZM178 102Q200 26 252 26Q282 26 310 49T356 107Q374 141 392 215T411 325V331Q411 405 350 405Q339 405 328 402T306 393T286 380T269 365T254 350T243 336T235 326L232 322Q232 321 229 308T218 264T204 212Q178 106 178 102Z",style:{"stroke-width":"3"}})])])],-1),e6=[s6],l6=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"p")])],-1),n6={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},o6={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.869ex"},xmlns:"http://www.w3.org/2000/svg",width:"7.547ex",height:"2.414ex",role:"img",focusable:"false",viewBox:"0 -683 3335.9 1067.2","aria-hidden":"true"},m6=s("",1),r6=[m6],d6=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msubsup",null,[Q("mi",null,"W"),Q("mi",null,"p"),Q("mi",null,"n")]),Q("mo",null,"⊙"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"p")])])],-1),p6={class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},i6={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-8.331ex"},xmlns:"http://www.w3.org/2000/svg",width:"23.524ex",height:"17.793ex",role:"img",focusable:"false",viewBox:"0 -4182.2 10397.6 7864.5","aria-hidden":"true"},c6=s("",1),h6=[c6],g6=Q("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[Q("mtable",{displaystyle:"true",columnalign:"right left",columnspacing:"0em",rowspacing:"3pt"},[Q("mtr",null,[Q("mtd",null,[Q("msubsup",null,[Q("mi",null,"l"),Q("mi",null,"p"),Q("mi",null,"n")])]),Q("mtd",null,[Q("mi"),Q("mo",null,"="),Q("msubsup",null,[Q("mi",null,"W"),Q("mi",null,"p"),Q("mi",null,"n")]),Q("mo",null,"⊙"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"p")])])]),Q("mtr",null,[Q("mtd"),Q("mtd",null,[Q("mi"),Q("mo",null,"="),Q("munderover",null,[Q("mo",{"data-mjx-texclass":"OP"},"∑"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"i"),Q("mo",null,"="),Q("mn",null,"1")]),Q("mi",null,"N")]),Q("munderover",null,[Q("mo",{"data-mjx-texclass":"OP"},"∑"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"j"),Q("mo",null,"="),Q("mn",null,"1")]),Q("mi",null,"N")]),Q("mo",{stretchy:"false"},"("),Q("msubsup",null,[Q("mi",null,"W"),Q("mi",null,"p"),Q("mi",null,"n")]),Q("msub",null,[Q("mo",{stretchy:"false"},")"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"i"),Q("mo",null,","),Q("mi",null,"j")])]),Q("msub",null,[Q("mi",null,"p"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"i"),Q("mo",null,","),Q("mi",null,"j")])])])]),Q("mtr",null,[Q("mtd"),Q("mtd",null,[Q("mi"),Q("mo",null,"="),Q("munderover",null,[Q("mo",{"data-mjx-texclass":"OP"},"∑"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"i"),Q("mo",null,"="),Q("mn",null,"1")]),Q("mi",null,"N")]),Q("munderover",null,[Q("mo",{"data-mjx-texclass":"OP"},"∑"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"j"),Q("mo",null,"="),Q("mn",null,"1")]),Q("mi",null,"N")]),Q("mo",{stretchy:"false"},"("),Q("msubsup",null,[Q("mi",null,"W"),Q("mi",null,"p"),Q("mi",null,"n")]),Q("msub",null,[Q("mo",{stretchy:"false"},")"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"i"),Q("mo",null,","),Q("mi",null,"j")])]),Q("msub",null,[Q("mi",null,"f"),Q("mi",null,"i")]),Q("msubsup",null,[Q("mi",null,"f"),Q("mi",null,"j"),Q("mi",null,"T")])])])])])],-1),u6={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},y6={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.869ex"},xmlns:"http://www.w3.org/2000/svg",width:"7.247ex",height:"2.566ex",role:"img",focusable:"false",viewBox:"0 -750 3203.3 1134.2","aria-hidden":"true"},L6=s("",1),x6=[L6],H6=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mo",{stretchy:"false"},"("),Q("msubsup",null,[Q("mi",null,"W"),Q("mi",null,"p"),Q("mi",null,"n")]),Q("msub",null,[Q("mo",{stretchy:"false"},")"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"i"),Q("mo",null,","),Q("mi",null,"j")])])])],-1),w6={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},_6={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.65ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.667ex",height:"2.22ex",role:"img",focusable:"false",viewBox:"0 -694 736.7 981.2","aria-hidden":"true"},f6=s("",1),M6=[f6],k6=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msub",null,[Q("mi",null,"l"),Q("mi",null,"p")])])],-1),b6={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},Z6={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"17.228ex",height:"2.452ex",role:"img",focusable:"false",viewBox:"0 -833.9 7614.8 1083.9","aria-hidden":"true"},D6=s("",1),E6=[D6],V6=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"O"),Q("mo",{stretchy:"false"},"("),Q("msub",null,[Q("mi",null,"D"),Q("mn",null,"1")]),Q("mo",null,"∗"),Q("msup",null,[Q("mi",null,"N"),Q("mn",null,"2")]),Q("mo",null,"∗"),Q("msup",null,[Q("mi",null,"M"),Q("mn",null,"2")]),Q("mo",{stretchy:"false"},")")])],-1),v6={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},A6={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"0"},xmlns:"http://www.w3.org/2000/svg",width:"3.119ex",height:"1.887ex",role:"img",focusable:"false",viewBox:"0 -833.9 1378.8 833.9","aria-hidden":"true"},C6=s("",1),j6=[C6],F6=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msup",null,[Q("mi",null,"N"),Q("mn",null,"2")])])],-1),R6={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},S6={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"0"},xmlns:"http://www.w3.org/2000/svg",width:"3.488ex",height:"1.887ex",role:"img",focusable:"false",viewBox:"0 -833.9 1541.6 833.9","aria-hidden":"true"},B6=s("",1),O6=[B6],P6=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msup",null,[Q("mi",null,"M"),Q("mn",null,"2")])])],-1),N6={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},I6={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.439ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.138ex",height:"1.439ex",role:"img",focusable:"false",viewBox:"0 -442 503 636","aria-hidden":"true"},z6=Q("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[Q("g",{"data-mml-node":"math"},[Q("g",{"data-mml-node":"mi"},[Q("path",{"data-c":"1D45D",d:"M23 287Q24 290 25 295T30 317T40 348T55 381T75 411T101 433T134 442Q209 442 230 378L240 387Q302 442 358 442Q423 442 460 395T497 281Q497 173 421 82T249 -10Q227 -10 210 -4Q199 1 187 11T168 28L161 36Q160 35 139 -51T118 -138Q118 -144 126 -145T163 -148H188Q194 -155 194 -157T191 -175Q188 -187 185 -190T172 -194Q170 -194 161 -194T127 -193T65 -192Q-5 -192 -24 -194H-32Q-39 -187 -39 -183Q-37 -156 -26 -148H-6Q28 -147 33 -136Q36 -130 94 103T155 350Q156 355 156 364Q156 405 131 405Q109 405 94 377T71 316T59 280Q57 278 43 278H29Q23 284 23 287ZM178 102Q200 26 252 26Q282 26 310 49T356 107Q374 141 392 215T411 325V331Q411 405 350 405Q339 405 328 402T306 393T286 380T269 365T254 350T243 336T235 326L232 322Q232 321 229 308T218 264T204 212Q178 106 178 102Z",style:{"stroke-width":"3"}})])])],-1),X6=[z6],J6=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"p")])],-1),G6={class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},W6={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-3.014ex"},xmlns:"http://www.w3.org/2000/svg",width:"37.925ex",height:"6.935ex",role:"img",focusable:"false",viewBox:"0 -1733 16762.8 3065.1","aria-hidden":"true"},q6=s("",1),$6=[q6],U6=Q("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[Q("mi",null,"p"),Q("mo",null,"="),Q("munderover",null,[Q("mo",{"data-mjx-texclass":"OP"},"∑"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"i"),Q("mo",null,"="),Q("mn",null,"1")]),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"N")])]),Q("munderover",null,[Q("mo",{"data-mjx-texclass":"OP"},"∑"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"j"),Q("mo",null,"="),Q("mn",null,"1")]),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"N")])]),Q("msub",null,[Q("mi",null,"f"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"i")])]),Q("msubsup",null,[Q("mi",null,"f"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"j")]),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"T")])]),Q("mo",null,"="),Q("msub",null,[Q("mi",null,"f"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",{mathvariant:"normal"},"Σ")])]),Q("msup",null,[Q("mrow",{"data-mjx-texclass":"INNER"},[Q("mo",{"data-mjx-texclass":"OPEN"},"("),Q("msub",null,[Q("mi",null,"f"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",{mathvariant:"normal"},"Σ")])]),Q("mo",{"data-mjx-texclass":"CLOSE"},")")]),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"T")])]),Q("mspace",{linebreak:"newline"}),Q("msub",null,[Q("mi",null,"f"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",{mathvariant:"normal"},"Σ")])]),Q("mo",null,"="),Q("munderover",null,[Q("mo",{"data-mjx-texclass":"OP"},"∑"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"i"),Q("mo",null,"="),Q("mn",null,"1")]),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"N")])]),Q("msub",null,[Q("mi",null,"f"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"i")])])])],-1),K6={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},Y6={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.09ex"},xmlns:"http://www.w3.org/2000/svg",width:"10.746ex",height:"2.004ex",role:"img",focusable:"false",viewBox:"0 -846 4749.8 886","aria-hidden":"true"},Q4=s("",1),t4=[Q4],a4=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"E"),Q("mo",null,"∈"),Q("msup",null,[Q("mi",null,"R"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"N"),Q("mo",null,"×"),Q("mi",null,"M")])])])],-1),T4={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},s4={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"0"},xmlns:"http://www.w3.org/2000/svg",width:"2.009ex",height:"1.545ex",role:"img",focusable:"false",viewBox:"0 -683 888 683","aria-hidden":"true"},e4=Q("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[Q("g",{"data-mml-node":"math"},[Q("g",{"data-mml-node":"mi"},[Q("path",{"data-c":"1D441",d:"M234 637Q231 637 226 637Q201 637 196 638T191 649Q191 676 202 682Q204 683 299 683Q376 683 387 683T401 677Q612 181 616 168L670 381Q723 592 723 606Q723 633 659 637Q635 637 635 648Q635 650 637 660Q641 676 643 679T653 683Q656 683 684 682T767 680Q817 680 843 681T873 682Q888 682 888 672Q888 650 880 642Q878 637 858 637Q787 633 769 597L620 7Q618 0 599 0Q585 0 582 2Q579 5 453 305L326 604L261 344Q196 88 196 79Q201 46 268 46H278Q284 41 284 38T282 19Q278 6 272 0H259Q228 2 151 2Q123 2 100 2T63 2T46 1Q31 1 31 10Q31 14 34 26T39 40Q41 46 62 46Q130 49 150 85Q154 91 221 362L289 634Q287 635 234 637Z",style:{"stroke-width":"3"}})])])],-1),l4=[e4],n4=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"N")])],-1),o4={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},m4={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.14ex"},xmlns:"http://www.w3.org/2000/svg",width:"13.232ex",height:"1.71ex",role:"img",focusable:"false",viewBox:"0 -694 5848.4 756","aria-hidden":"true"},r4=s("",1),d4=[r4],p4=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"N"),Q("mo",null,"∗"),Q("mi",null,"e"),Q("mi",null,"m"),Q("mi",null,"b"),Q("mi",{mathvariant:"normal"},"_"),Q("mi",null,"d"),Q("mi",null,"i"),Q("mi",null,"m")])],-1),i4={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},c4={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.09ex"},xmlns:"http://www.w3.org/2000/svg",width:"10.746ex",height:"2.004ex",role:"img",focusable:"false",viewBox:"0 -846 4749.8 886","aria-hidden":"true"},h4=s("",1),g4=[h4],u4=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"E"),Q("mo",null,"∈"),Q("msup",null,[Q("mi",null,"R"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"N"),Q("mo",null,"×"),Q("mi",null,"M")])])])],-1),y4={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},L4={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.09ex"},xmlns:"http://www.w3.org/2000/svg",width:"8.081ex",height:"2.004ex",role:"img",focusable:"false",viewBox:"0 -846 3571.7 886","aria-hidden":"true"},x4=s("",1),H4=[x4],w4=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"E"),Q("mo",null,"∈"),Q("msup",null,[Q("mi",null,"R"),Q("mi",null,"M")])])],-1),_4={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},f4={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"0"},xmlns:"http://www.w3.org/2000/svg",width:"2.378ex",height:"1.545ex",role:"img",focusable:"false",viewBox:"0 -683 1051 683","aria-hidden":"true"},M4=Q("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[Q("g",{"data-mml-node":"math"},[Q("g",{"data-mml-node":"mi"},[Q("path",{"data-c":"1D440",d:"M289 629Q289 635 232 637Q208 637 201 638T194 648Q194 649 196 659Q197 662 198 666T199 671T201 676T203 679T207 681T212 683T220 683T232 684Q238 684 262 684T307 683Q386 683 398 683T414 678Q415 674 451 396L487 117L510 154Q534 190 574 254T662 394Q837 673 839 675Q840 676 842 678T846 681L852 683H948Q965 683 988 683T1017 684Q1051 684 1051 673Q1051 668 1048 656T1045 643Q1041 637 1008 637Q968 636 957 634T939 623Q936 618 867 340T797 59Q797 55 798 54T805 50T822 48T855 46H886Q892 37 892 35Q892 19 885 5Q880 0 869 0Q864 0 828 1T736 2Q675 2 644 2T609 1Q592 1 592 11Q592 13 594 25Q598 41 602 43T625 46Q652 46 685 49Q699 52 704 61Q706 65 742 207T813 490T848 631L654 322Q458 10 453 5Q451 4 449 3Q444 0 433 0Q418 0 415 7Q413 11 374 317L335 624L267 354Q200 88 200 79Q206 46 272 46H282Q288 41 289 37T286 19Q282 3 278 1Q274 0 267 0Q265 0 255 0T221 1T157 2Q127 2 95 1T58 0Q43 0 39 2T35 11Q35 13 38 25T43 40Q45 46 65 46Q135 46 154 86Q158 92 223 354T289 629Z",style:{"stroke-width":"3"}})])])],-1),k4=[M4],b4=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"M")])],-1),Z4={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},D4={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.439ex"},xmlns:"http://www.w3.org/2000/svg",width:"10.416ex",height:"2.353ex",role:"img",focusable:"false",viewBox:"0 -846 4604 1040","aria-hidden":"true"},E4=s("",1),V4=[E4],v4=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"p"),Q("mo",null,"∈"),Q("msup",null,[Q("mi",null,"R"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"M"),Q("mo",null,"×"),Q("mi",null,"M")])])])],-1),A4={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},C4={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.869ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.822ex",height:"2.439ex",role:"img",focusable:"false",viewBox:"0 -694 805.3 1078.2","aria-hidden":"true"},j4=s("",1),F4=[j4],R4=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msubsup",null,[Q("mi",null,"l"),Q("mi",null,"p"),Q("mi",null,"n")])])],-1),S4={class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},B4={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-3.014ex"},xmlns:"http://www.w3.org/2000/svg",width:"32.543ex",height:"6.935ex",role:"img",focusable:"false",viewBox:"0 -1733 14384.1 3065.1","aria-hidden":"true"},O4=s("",1),P4=[O4],N4=Q("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[Q("msubsup",null,[Q("mi",null,"l"),Q("mi",null,"p"),Q("mi",null,"n")]),Q("mo",null,"="),Q("msubsup",null,[Q("mi",null,"W"),Q("mi",null,"p"),Q("mi",null,"n")]),Q("mo",null,"⊙"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"p")]),Q("mo",null,"="),Q("munderover",null,[Q("mo",{"data-mjx-texclass":"OP"},"∑"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"i"),Q("mo",null,"="),Q("mn",null,"1")]),Q("mi",null,"N")]),Q("munderover",null,[Q("mo",{"data-mjx-texclass":"OP"},"∑"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"j"),Q("mo",null,"="),Q("mn",null,"1")]),Q("mi",null,"N")]),Q("mo",{stretchy:"false"},"("),Q("msubsup",null,[Q("mi",null,"W"),Q("mi",null,"p"),Q("mi",null,"n")]),Q("msub",null,[Q("mo",{stretchy:"false"},")"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"i"),Q("mo",null,","),Q("mi",null,"j")])]),Q("msub",null,[Q("mi",null,"p"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"i"),Q("mo",null,","),Q("mi",null,"j")])]),Q("mspace",{linebreak:"newline"})])],-1),I4={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},z4={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.606ex",height:"1.927ex",role:"img",focusable:"false",viewBox:"0 -694 709.8 851.8","aria-hidden":"true"},X4=s("",1),J4=[X4],G4=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msub",null,[Q("mi",null,"l"),Q("mi",null,"z")])])],-1),W4={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},q4={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.869ex"},xmlns:"http://www.w3.org/2000/svg",width:"3.644ex",height:"2.414ex",role:"img",focusable:"false",viewBox:"0 -683 1610.5 1067.2","aria-hidden":"true"},$4=s("",1),U4=[$4],K4=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msubsup",null,[Q("mi",null,"W"),Q("mi",null,"p"),Q("mi",null,"n")])])],-1),Y4={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},Q5={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.048ex"},xmlns:"http://www.w3.org/2000/svg",width:"6.512ex",height:"1.961ex",role:"img",focusable:"false",viewBox:"0 -846 2878.5 867","aria-hidden":"true"},t5=s("",1),a5=[t5],T5=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msup",null,[Q("mi",null,"R"),Q("mrow",{"data-mjx-texclass":"ORD"},[Q("mi",null,"M"),Q("mo",null,"×"),Q("mi",null,"M")])])])],-1),s5={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},e5={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"0"},xmlns:"http://www.w3.org/2000/svg",width:"2.378ex",height:"1.545ex",role:"img",focusable:"false",viewBox:"0 -683 1051 683","aria-hidden":"true"},l5=Q("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[Q("g",{"data-mml-node":"math"},[Q("g",{"data-mml-node":"mi"},[Q("path",{"data-c":"1D440",d:"M289 629Q289 635 232 637Q208 637 201 638T194 648Q194 649 196 659Q197 662 198 666T199 671T201 676T203 679T207 681T212 683T220 683T232 684Q238 684 262 684T307 683Q386 683 398 683T414 678Q415 674 451 396L487 117L510 154Q534 190 574 254T662 394Q837 673 839 675Q840 676 842 678T846 681L852 683H948Q965 683 988 683T1017 684Q1051 684 1051 673Q1051 668 1048 656T1045 643Q1041 637 1008 637Q968 636 957 634T939 623Q936 618 867 340T797 59Q797 55 798 54T805 50T822 48T855 46H886Q892 37 892 35Q892 19 885 5Q880 0 869 0Q864 0 828 1T736 2Q675 2 644 2T609 1Q592 1 592 11Q592 13 594 25Q598 41 602 43T625 46Q652 46 685 49Q699 52 704 61Q706 65 742 207T813 490T848 631L654 322Q458 10 453 5Q451 4 449 3Q444 0 433 0Q418 0 415 7Q413 11 374 317L335 624L267 354Q200 88 200 79Q206 46 272 46H282Q288 41 289 37T286 19Q282 3 278 1Q274 0 267 0Q265 0 255 0T221 1T157 2Q127 2 95 1T58 0Q43 0 39 2T35 11Q35 13 38 25T43 40Q45 46 65 46Q135 46 154 86Q158 92 223 354T289 629Z",style:{"stroke-width":"3"}})])])],-1),n5=[l5],o5=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"M")])],-1),m5={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},r5={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.14ex"},xmlns:"http://www.w3.org/2000/svg",width:"13.232ex",height:"1.71ex",role:"img",focusable:"false",viewBox:"0 -694 5848.4 756","aria-hidden":"true"},d5=s("",1),p5=[d5],i5=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("mi",null,"N"),Q("mo",null,"∗"),Q("mi",null,"e"),Q("mi",null,"m"),Q("mi",null,"b"),Q("mi",{mathvariant:"normal"},"_"),Q("mi",null,"d"),Q("mi",null,"i"),Q("mi",null,"m")])],-1),c5=Q("blockquote",null,[Q("p",null,"虽然叠加概念的引入可以降低计算开销，但是中间的精度损失也是很大的，性能与精度之间的 tradeoff")],-1),h5=Q("h2",{id:"代码实现",tabindex:"-1"},[t("代码实现 "),Q("a",{class:"header-anchor",href:"#代码实现","aria-label":'Permalink to "代码实现"'},"​")],-1),g5={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},u5={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.65ex"},xmlns:"http://www.w3.org/2000/svg",width:"4.279ex",height:"2.22ex",role:"img",focusable:"false",viewBox:"0 -694 1891.1 981.2","aria-hidden":"true"},y5=s("",1),L5=[y5],x5=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msub",null,[Q("mi",null,"l"),Q("mi",null,"z")]),Q("mo",null,","),Q("msub",null,[Q("mi",null,"l"),Q("mi",null,"p")])])],-1),H5={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},w5={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.65ex"},xmlns:"http://www.w3.org/2000/svg",width:"4.279ex",height:"2.22ex",role:"img",focusable:"false",viewBox:"0 -694 1891.1 981.2","aria-hidden":"true"},_5=s("",1),f5=[_5],M5=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msub",null,[Q("mi",null,"l"),Q("mi",null,"z")]),Q("mo",null,","),Q("msub",null,[Q("mi",null,"l"),Q("mi",null,"p")])])],-1),k5=s("",1),b5={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},Z5={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.65ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.667ex",height:"2.22ex",role:"img",focusable:"false",viewBox:"0 -694 736.7 981.2","aria-hidden":"true"},D5=s("",1),E5=[D5],V5=Q("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[Q("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[Q("msub",null,[Q("mi",null,"l"),Q("mi",null,"p")])])],-1),v5=s("",8);function A5(C5,j5,F5,R5,S5,B5){return a(),T("div",null,[n,Q("p",null,[t("Product 层主要有线性部分和非线性部分组成，分别用"),Q("mjx-container",o,[(a(),T("svg",m,d)),p]),t(" 和"),Q("mjx-container",i,[(a(),T("svg",c,g)),u]),t(" 来表示，")]),y,Q("ol",null,[Q("li",null,[t("线性模块，一阶特征 (未经过显示特征交叉处理)，对应论文中的"),Q("mjx-container",L,[(a(),T("svg",x,w)),_])]),Q("li",null,[t("非线性模块，高阶特征 (经过显示特征交叉处理)，对应论文中的"),Q("mjx-container",f,[(a(),T("svg",M,b)),Z])])]),D,Q("p",null,[t("先来解释一下"),Q("mjx-container",E,[(a(),T("svg",V,A)),C]),t(" 是如何计算得到的，在介绍计算"),Q("mjx-container",j,[(a(),T("svg",F,S)),B]),t(" 之前先介绍一下矩阵内积计算，如下公式所示，用一句话来描述就是两个矩阵对应元素相称，然后将相乘之后的所有元素相加")]),Q("mjx-container",O,[(a(),T("svg",P,I)),z]),Q("p",null,[Q("mjx-container",X,[(a(),T("svg",J,W)),q]),t(" 的计算就是矩阵内积，而"),Q("mjx-container",$,[(a(),T("svg",U,Y)),Q1]),t(" 是有"),Q("mjx-container",t1,[(a(),T("svg",a1,s1)),e1]),t(" 个"),Q("mjx-container",l1,[(a(),T("svg",n1,m1)),r1]),t(" 组成，所以需要"),Q("mjx-container",d1,[(a(),T("svg",p1,c1)),h1]),t(" 个矩阵求得，但是在代码实现的时候不一定是定义"),Q("mjx-container",g1,[(a(),T("svg",u1,L1)),x1]),t(" 个矩阵，可以将这些矩阵 Flatten，具体的细节可以参考给出的代码。")]),Q("mjx-container",H1,[(a(),T("svg",w1,f1)),M1]),k1,Q("mjx-container",b1,[(a(),T("svg",Z1,E1)),V1]),v1,A1,Q("p",null,[t("上面介绍了线性部分"),Q("mjx-container",C1,[(a(),T("svg",j1,R1)),S1]),t(" 的计算，非线性部分的计算相比线性部分要复杂很多，先从整体上看"),Q("mjx-container",B1,[(a(),T("svg",O1,N1)),I1]),t(" 的计算")]),Q("mjx-container",z1,[(a(),T("svg",X1,G1)),W1]),Q("p",null,[t("从上述公式中可以发现，"),Q("mjx-container",q1,[(a(),T("svg",$1,K1)),Y1]),t(" 和"),Q("mjx-container",Q2,[(a(),T("svg",t2,T2)),s2]),t(" 类似需要"),Q("mjx-container",e2,[(a(),T("svg",l2,o2)),m2]),t(" 个"),Q("mjx-container",r2,[(a(),T("svg",d2,i2)),c2]),t(" 矩阵计算内积得到，重点就是如何求这个"),Q("mjx-container",h2,[(a(),T("svg",g2,y2)),L2]),t("，这里作者提出了两种方式，一种是使用内积计算，另一种是使用外积计算。")]),x2,H2,Q("mjx-container",w2,[(a(),T("svg",_2,M2)),k2]),Q("p",null,[t("将内积的表达式带入"),Q("mjx-container",b2,[(a(),T("svg",Z2,E2)),V2]),t(" 的计算表达式中有：")]),Q("mjx-container",v2,[(a(),T("svg",A2,j2)),F2]),R2,Q("mjx-container",S2,[(a(),T("svg",B2,P2)),N2]),Q("p",null,[t("也就是说计算的内积矩阵"),Q("mjx-container",I2,[(a(),T("svg",z2,J2)),G2]),t(" 是对称的，那么与其对应元素做矩阵内积的矩阵"),Q("mjx-container",W2,[(a(),T("svg",q2,U2)),K2]),t(" 也是对称的，对于可学习的权重来说如果是对称的是不是可以只使用其中的一半就行了呢，所以基于这个思考，对 Inner Product 的权重定义及内积计算进行优化，首先将权重矩阵分解"),Q("mjx-container",Y2,[(a(),T("svg",Q3,a3)),T3]),t(", 此时"),Q("mjx-container",s3,[(a(),T("svg",e3,n3)),o3]),t("（参数从原来的"),Q("mjx-container",m3,[(a(),T("svg",r3,p3)),i3]),t(" 变成了"),Q("mjx-container",c3,[(a(),T("svg",h3,u3)),y3]),t("）, 将分解后的"),Q("mjx-container",L3,[(a(),T("svg",x3,w3)),_3]),t(" 带入"),Q("mjx-container",f3,[(a(),T("svg",M3,b3)),Z3]),t(" 的计算公式有：")]),Q("mjx-container",D3,[(a(),T("svg",E3,v3)),A3]),Q("p",null,[t("所以优化后的"),Q("mjx-container",C3,[(a(),T("svg",j3,R3)),S3]),t(" 的计算公式为：")]),Q("mjx-container",B3,[(a(),T("svg",O3,N3)),I3]),z3,X3,Q("p",null,[t("使用外积实现相比于使用内积实现，唯一的区别就是使用向量的外积来计算矩阵"),Q("mjx-container",J3,[(a(),T("svg",G3,q3)),$3]),t(", 首先定义向量的外积计算")]),Q("mjx-container",U3,[(a(),T("svg",K3,Q6)),t6]),Q("p",null,[t("从外积公式可以发现两个向量的外积得到的是一个矩阵，与上面介绍的内积计算不太相同，内积得到的是一个数值。内积实现的 Product 层是将计算得到的内积矩阵，乘以一个与其大小一样的权重矩阵，然后求和，按照这个思路的话，通过外积得到的"),Q("mjx-container",a6,[(a(),T("svg",T6,e6)),l6]),t(" 计算"),Q("mjx-container",n6,[(a(),T("svg",o6,r6)),d6]),t(" 相当于之前的内积值乘以权重矩阵对应位置的值求和就变成了，外积矩阵乘以权重矩阵中对应位置的子矩阵然后将整个相乘得到的大矩阵对应元素相加，用公式表示如下：")]),Q("mjx-container",p6,[(a(),T("svg",i6,h6)),g6]),Q("p",null,[t("需要注意的是此时的"),Q("mjx-container",u6,[(a(),T("svg",y6,x6)),H6]),t(" 表示的是一个矩阵，而不是一个值，此时计算"),Q("mjx-container",w6,[(a(),T("svg",_6,M6)),k6]),t(" 的复杂度是"),Q("mjx-container",b6,[(a(),T("svg",Z6,E6)),V6]),t(", 其中"),Q("mjx-container",v6,[(a(),T("svg",A6,j6)),F6]),t(" 表示的是特征的组合数量，"),Q("mjx-container",R6,[(a(),T("svg",S6,O6)),P6]),t(" 表示的是计算外积的复杂度。这样的复杂度肯定是无法接受的，所以为了优化复杂度，PNN 的作者重新定义了"),Q("mjx-container",N6,[(a(),T("svg",I6,X6)),J6]),t(" 的计算方式：")]),Q("mjx-container",G6,[(a(),T("svg",W6,$6)),U6]),Q("p",null,[t("需要注意，这里新定义的外积计算与传统的外积计算时不等价的，这里是为了优化计算效率重新定义的计算方式，从公式中可以看出，相当于先将原来的 embedding 向量在特征维度上先求和，变成一个向量之后再计算外积。加入原 embedding 向量表示为"),Q("mjx-container",K6,[(a(),T("svg",Y6,t4)),a4]),t("，其中"),Q("mjx-container",T4,[(a(),T("svg",s4,l4)),n4]),t(" 表示特征的数量，M 表示的是所有特征的总维度，即"),Q("mjx-container",o4,[(a(),T("svg",m4,d4)),p4]),t(", 在特征维度上进行求和就是将"),Q("mjx-container",i4,[(a(),T("svg",c4,g4)),u4]),t(" 矩阵压缩成了"),Q("mjx-container",y4,[(a(),T("svg",L4,H4)),w4]),t(", 然后两个"),Q("mjx-container",_4,[(a(),T("svg",f4,k4)),b4]),t(" 维的向量计算外积得到最终所有特征的外积交叉结果"),Q("mjx-container",Z4,[(a(),T("svg",D4,V4)),v4]),t("，最终的"),Q("mjx-container",A4,[(a(),T("svg",C4,F4)),R4]),t(" 可以表示为：")]),Q("mjx-container",S4,[(a(),T("svg",B4,P4)),N4]),Q("p",null,[t("最终的计算方式和"),Q("mjx-container",I4,[(a(),T("svg",z4,J4)),G4]),t(" 的计算方式看起来差不多，但是需要注意外积优化后的"),Q("mjx-container",W4,[(a(),T("svg",q4,U4)),K4]),t(" 的维度是"),Q("mjx-container",Y4,[(a(),T("svg",Q5,a5)),T5]),t(" 的，"),Q("mjx-container",s5,[(a(),T("svg",e5,n5)),o5]),t(" 表示的是特征矩阵的维度，即"),Q("mjx-container",m5,[(a(),T("svg",r5,p5)),i5]),t("。")]),c5,h5,Q("p",null,[t("代码实现的整体逻辑比较简单，就是对类别特征进行 embedding 编码，然后通过 embedding 特征计算"),Q("mjx-container",g5,[(a(),T("svg",u5,L5)),x5]),t(", 接着将"),Q("mjx-container",H5,[(a(),T("svg",w5,f5)),M5]),t(" 的输出 concat 到一起输入到 DNN 中得到最终的预测结果")]),k5,Q("p",null,[t("PNN 的难点就是 Product 层的实现，下面是 Product 层实现的代码，代码中是使用优化之后"),Q("mjx-container",b5,[(a(),T("svg",Z5,E5)),V5]),t(" 的计算方式编写的，代码中有详细的注释，但是要完全理解代码还需要去理解上述说过的优化思路。")]),v5])}const N5=e(l,[["render",A5]]);export{P5 as __pageData,N5 as default};
