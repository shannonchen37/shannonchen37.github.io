import{_ as l,o as s,c as e,a,j as t,U as n}from"./chunks/framework.489e5108.js";const C2=JSON.parse('{"title":"DIN","description":"","frontmatter":{},"headers":[],"relativePath":"4.人工智能/ch02/ch2.2/ch2.2.4/DIN.md","filePath":"4.人工智能/ch02/ch2.2/ch2.2.4/DIN.md","lastUpdated":1696176798000}'),Q={name:"4.人工智能/ch02/ch2.2/ch2.2.4/DIN.md"},T=n("",16),o=t("h3",{id:"基线模型",tabindex:"-1"},[a("基线模型 "),t("a",{class:"header-anchor",href:"#基线模型","aria-label":'Permalink to "基线模型"'},"​")],-1),r=t("p",null,"这里的 base 模型，就是上面提到过的 Embedding&MLP 的形式， 这个之所以要介绍，就是因为 DIN 网络的基准也是他，只不过在这个的基础上添加了一个新结构 (注意力网络) 来学习当前候选广告与用户历史行为特征的相关性，从而动态捕捉用户的兴趣。",-1),p=t("p",null,"基准模型的结构相对比较简单，我们前面也一直用这个基准， 分为三大模块：Embedding layer，Pooling & Concat layer 和 MLP， 结构如下:",-1),d=t("div",{align:"center"},[t("img",{src:"https://img-blog.csdnimg.cn/20210118191224464.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3d1emhvbmdxaWFuZw==,size_1,color_FFFFFF,t_70#pic_center",style:{zoom:"80%"}})],-1),i=t("p",null,"前面的大部分深度模型结构也是遵循着这个范式套路， 简介一下各个模块。",-1),m=t("strong",null,"Embedding layer",-1),c={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},h={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"0"},xmlns:"http://www.w3.org/2000/svg",width:"6.65ex",height:"1.545ex",role:"img",focusable:"false",viewBox:"0 -683 2939.4 683","aria-hidden":"true"},g=n("",1),u=[g],_=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mi",null,"D"),t("mo",null,"×"),t("mi",null,"K")])],-1),y={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},x={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"0"},xmlns:"http://www.w3.org/2000/svg",width:"1.873ex",height:"1.545ex",role:"img",focusable:"false",viewBox:"0 -683 828 683","aria-hidden":"true"},w=t("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[t("g",{"data-mml-node":"math"},[t("g",{"data-mml-node":"mi"},[t("path",{"data-c":"1D437",d:"M287 628Q287 635 230 637Q207 637 200 638T193 647Q193 655 197 667T204 682Q206 683 403 683Q570 682 590 682T630 676Q702 659 752 597T803 431Q803 275 696 151T444 3L430 1L236 0H125H72Q48 0 41 2T33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM703 469Q703 507 692 537T666 584T629 613T590 629T555 636Q553 636 541 636T512 636T479 637H436Q392 637 386 627Q384 623 313 339T242 52Q242 48 253 48T330 47Q335 47 349 47T373 46Q499 46 581 128Q617 164 640 212T683 339T703 469Z",style:{"stroke-width":"3"}})])])],-1),b=[w],H=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mi",null,"D")])],-1),f={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},L={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"0"},xmlns:"http://www.w3.org/2000/svg",width:"2.011ex",height:"1.545ex",role:"img",focusable:"false",viewBox:"0 -683 889 683","aria-hidden":"true"},E=t("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[t("g",{"data-mml-node":"math"},[t("g",{"data-mml-node":"mi"},[t("path",{"data-c":"1D43E",d:"M285 628Q285 635 228 637Q205 637 198 638T191 647Q191 649 193 661Q199 681 203 682Q205 683 214 683H219Q260 681 355 681Q389 681 418 681T463 682T483 682Q500 682 500 674Q500 669 497 660Q496 658 496 654T495 648T493 644T490 641T486 639T479 638T470 637T456 637Q416 636 405 634T387 623L306 305Q307 305 490 449T678 597Q692 611 692 620Q692 635 667 637Q651 637 651 648Q651 650 654 662T659 677Q662 682 676 682Q680 682 711 681T791 680Q814 680 839 681T869 682Q889 682 889 672Q889 650 881 642Q878 637 862 637Q787 632 726 586Q710 576 656 534T556 455L509 418L518 396Q527 374 546 329T581 244Q656 67 661 61Q663 59 666 57Q680 47 717 46H738Q744 38 744 37T741 19Q737 6 731 0H720Q680 3 625 3Q503 3 488 0H478Q472 6 472 9T474 27Q478 40 480 43T491 46H494Q544 46 544 71Q544 75 517 141T485 216L427 354L359 301L291 248L268 155Q245 63 245 58Q245 51 253 49T303 46H334Q340 37 340 35Q340 19 333 5Q328 0 317 0Q314 0 280 1T180 2Q118 2 85 2T49 1Q31 1 31 11Q31 13 34 25Q38 41 42 43T65 46Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Z",style:{"stroke-width":"3"}})])])],-1),k=[E],M=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mi",null,"K")])],-1),D={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},Z={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.05ex"},xmlns:"http://www.w3.org/2000/svg",width:"5.77ex",height:"1.595ex",role:"img",focusable:"false",viewBox:"0 -683 2550.4 705","aria-hidden":"true"},v=n("",1),V=[v],A=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mi",null,"D"),t("mo",null,"×"),t("mn",null,"7")])],-1),C={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},j={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"0"},xmlns:"http://www.w3.org/2000/svg",width:"5.77ex",height:"1.545ex",role:"img",focusable:"false",viewBox:"0 -683 2550.4 683","aria-hidden":"true"},F=n("",1),N=[F],I=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mi",null,"D"),t("mo",null,"×"),t("mn",null,"1")])],-1),S={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},R={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"33.824ex",height:"2.47ex",role:"img",focusable:"false",viewBox:"0 -841.7 14950.2 1091.7","aria-hidden":"true"},P=n("",1),B=[P],O=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mi",null,"e"),t("mi",null,"m"),t("mi",null,"b"),t("mi",null,"e"),t("mi",null,"d"),t("mi",null,"d"),t("mi",null,"i"),t("mi",null,"n"),t("mi",null,"g"),t("mi",{mathvariant:"normal"},"矩"),t("mi",{mathvariant:"normal"},"阵"),t("mo",null,"∗"),t("mo",{stretchy:"false"},"["),t("mn",null,"0"),t("mo",null,","),t("mn",null,"0"),t("mo",null,","),t("mn",null,"0"),t("mo",null,","),t("mn",null,"0"),t("mo",null,","),t("mn",null,"1"),t("mo",null,","),t("mn",null,"0"),t("mo",null,","),t("mn",null,"0"),t("msup",null,[t("mo",{stretchy:"false"},"]"),t("mi",null,"T")])])],-1),q={start:"2"},z=t("strong",null,"pooling layer and Concat layer",-1),G={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},X={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.556ex",height:"1.773ex",role:"img",focusable:"false",viewBox:"0 -626 688 783.8","aria-hidden":"true"},J=n("",1),W=[J],U=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"t"),t("mi",null,"i")])])],-1),$={class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},K={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"26.641ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 11775.2 1000","aria-hidden":"true"},Y=n("",1),t1=[Y],a1=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("msub",null,[t("mi",null,"e"),t("mi",null,"i")]),t("mo",null,"="),t("mi",null,"p"),t("mi",null,"o"),t("mi",null,"o"),t("mi",null,"l"),t("mi",null,"i"),t("mi",null,"n"),t("mi",null,"g"),t("mo",{stretchy:"false"},"("),t("msub",null,[t("mi",null,"e"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mn",null,"1")])]),t("mo",null,","),t("msub",null,[t("mi",null,"e"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mn",null,"2")])]),t("mo",null,","),t("mo",null,"."),t("mo",null,"."),t("mo",null,"."),t("msub",null,[t("mi",null,"e"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mi",null,"k")])]),t("mo",{stretchy:"false"},")")])],-1),s1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},e1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.666ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.453ex",height:"1.666ex",role:"img",focusable:"false",viewBox:"0 -442 1084.3 736.2","aria-hidden":"true"},n1=n("",1),l1=[n1],Q1=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"e"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mi",null,"j")])])])],-1),T1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},o1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.794ex",height:"1.357ex",role:"img",focusable:"false",viewBox:"0 -442 793 599.8","aria-hidden":"true"},r1=n("",1),p1=[r1],d1=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"e"),t("mi",null,"i")])])],-1),i1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},m1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.025ex"},xmlns:"http://www.w3.org/2000/svg",width:"0.781ex",height:"1.52ex",role:"img",focusable:"false",viewBox:"0 -661 345 672","aria-hidden":"true"},c1=t("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[t("g",{"data-mml-node":"math"},[t("g",{"data-mml-node":"mi"},[t("path",{"data-c":"1D456",d:"M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z",style:{"stroke-width":"3"}})])])],-1),h1=[c1],g1=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mi",null,"i")])],-1),u1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},_1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.025ex"},xmlns:"http://www.w3.org/2000/svg",width:"0.781ex",height:"1.52ex",role:"img",focusable:"false",viewBox:"0 -661 345 672","aria-hidden":"true"},y1=t("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[t("g",{"data-mml-node":"math"},[t("g",{"data-mml-node":"mi"},[t("path",{"data-c":"1D456",d:"M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z",style:{"stroke-width":"3"}})])])],-1),x1=[y1],w1=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mi",null,"i")])],-1),b1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},H1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.025ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.179ex",height:"1.595ex",role:"img",focusable:"false",viewBox:"0 -694 521 705","aria-hidden":"true"},f1=t("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[t("g",{"data-mml-node":"math"},[t("g",{"data-mml-node":"mi"},[t("path",{"data-c":"1D458",d:"M121 647Q121 657 125 670T137 683Q138 683 209 688T282 694Q294 694 294 686Q294 679 244 477Q194 279 194 272Q213 282 223 291Q247 309 292 354T362 415Q402 442 438 442Q468 442 485 423T503 369Q503 344 496 327T477 302T456 291T438 288Q418 288 406 299T394 328Q394 353 410 369T442 390L458 393Q446 405 434 405H430Q398 402 367 380T294 316T228 255Q230 254 243 252T267 246T293 238T320 224T342 206T359 180T365 147Q365 130 360 106T354 66Q354 26 381 26Q429 26 459 145Q461 153 479 153H483Q499 153 499 144Q499 139 496 130Q455 -11 378 -11Q333 -11 305 15T277 90Q277 108 280 121T283 145Q283 167 269 183T234 206T200 217T182 220H180Q168 178 159 139T145 81T136 44T129 20T122 7T111 -2Q98 -11 83 -11Q66 -11 57 -1T48 16Q48 26 85 176T158 471L195 616Q196 629 188 632T149 637H144Q134 637 131 637T124 640T121 647Z",style:{"stroke-width":"3"}})])])],-1),L1=[f1],E1=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mi",null,"k")])],-1),k1=t("ol",{start:"3"},[t("li",null,[t("p",null,[t("strong",null,"MLP"),a("：这个就是普通的全连接，用了学习特征之间的各种交互。")])]),t("li",null,[t("p",null,[t("strong",null,"Loss"),a(": 由于这里是点击率预测任务， 二分类的问题，所以这里的损失函数用的负的 log 对数似然：")])])],-1),M1={class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},D1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-3.222ex"},xmlns:"http://www.w3.org/2000/svg",width:"49.071ex",height:"6.258ex",role:"img",focusable:"false",viewBox:"0 -1342 21689.3 2766.1","aria-hidden":"true"},Z1=n("",1),v1=[Z1],V1=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("mi",null,"L"),t("mo",null,"="),t("mo",null,"−"),t("mfrac",null,[t("mn",null,"1"),t("mi",null,"N")]),t("munder",null,[t("mo",{"data-mjx-texclass":"OP"},"∑"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",{stretchy:"false"},"("),t("mi",{mathvariant:"bold-italic"},"x"),t("mo",null,","),t("mi",null,"y"),t("mo",{stretchy:"false"},")"),t("mo",null,"∈"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{"data-mjx-variant":"-tex-calligraphic",mathvariant:"script"},"S")])])]),t("mo",{stretchy:"false"},"("),t("mi",null,"y"),t("mi",null,"log"),t("mo",{"data-mjx-texclass":"NONE"},"⁡"),t("mi",null,"p"),t("mo",{stretchy:"false"},"("),t("mi",{mathvariant:"bold-italic"},"x"),t("mo",{stretchy:"false"},")"),t("mo",null,"+"),t("mo",{stretchy:"false"},"("),t("mn",null,"1"),t("mo",null,"−"),t("mi",null,"y"),t("mo",{stretchy:"false"},")"),t("mi",null,"log"),t("mo",{"data-mjx-texclass":"NONE"},"⁡"),t("mo",{stretchy:"false"},"("),t("mn",null,"1"),t("mo",null,"−"),t("mi",null,"p"),t("mo",{stretchy:"false"},"("),t("mi",{mathvariant:"bold-italic"},"x"),t("mo",{stretchy:"false"},")"),t("mo",{stretchy:"false"},")"),t("mo",{stretchy:"false"},")")])],-1),A1=n("",7),C1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},j1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"6.155ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 2720.4 1000","aria-hidden":"true"},F1=n("",1),N1=[F1],I1=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",{mathvariant:"bold-italic"},"v"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"U")])]),t("mo",{stretchy:"false"},"("),t("mi",null,"A"),t("mo",{stretchy:"false"},")")])],-1),S1={class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},R1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-3.014ex"},xmlns:"http://www.w3.org/2000/svg",width:"58.981ex",height:"6.935ex",role:"img",focusable:"false",viewBox:"0 -1733 26069.7 3065.1","aria-hidden":"true"},P1=n("",1),B1=[P1],O1=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("msub",null,[t("mi",{mathvariant:"bold-italic"},"v"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"U")])]),t("mo",{stretchy:"false"},"("),t("mi",null,"A"),t("mo",{stretchy:"false"},")"),t("mo",null,"="),t("mi",null,"f"),t("mrow",{"data-mjx-texclass":"INNER"},[t("mo",{"data-mjx-texclass":"OPEN"},"("),t("msub",null,[t("mi",{mathvariant:"bold-italic"},"v"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"A")])]),t("mo",null,","),t("msub",null,[t("mi",{mathvariant:"bold-italic"},"e"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mn",null,"1")])]),t("mo",null,","),t("msub",null,[t("mi",{mathvariant:"bold-italic"},"e"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mn",null,"2")])]),t("mo",null,","),t("mo",null,"…"),t("mo",null,","),t("msub",null,[t("mi",{mathvariant:"bold-italic"},"e"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"H")])]),t("mo",{"data-mjx-texclass":"CLOSE"},")")]),t("mo",null,"="),t("munderover",null,[t("mo",{"data-mjx-texclass":"OP"},"∑"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"j"),t("mo",null,"="),t("mn",null,"1")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"H")])]),t("mi",null,"a"),t("mrow",{"data-mjx-texclass":"INNER"},[t("mo",{"data-mjx-texclass":"OPEN"},"("),t("msub",null,[t("mi",{mathvariant:"bold-italic"},"e"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"j")])]),t("mo",null,","),t("msub",null,[t("mi",{mathvariant:"bold-italic"},"v"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"A")])]),t("mo",{"data-mjx-texclass":"CLOSE"},")")]),t("msub",null,[t("mi",{mathvariant:"bold-italic"},"e"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"j")])]),t("mo",null,"="),t("munderover",null,[t("mo",{"data-mjx-texclass":"OP"},"∑"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"j"),t("mo",null,"="),t("mn",null,"1")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"H")])]),t("msub",null,[t("mi",{mathvariant:"bold-italic"},"w"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"j")])]),t("msub",null,[t("mi",{mathvariant:"bold-italic"},"e"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"j")])])])],-1),q1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},z1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"19.33ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 8543.7 1000","aria-hidden":"true"},G1=n("",1),X1=[G1],J1=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mo",{fence:"false",stretchy:"false"},"{"),t("msub",null,[t("mi",{mathvariant:"bold-italic"},"v"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"A")])]),t("mo",null,","),t("msub",null,[t("mi",{mathvariant:"bold-italic"},"e"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mn",null,"1")])]),t("mo",null,","),t("msub",null,[t("mi",{mathvariant:"bold-italic"},"e"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mn",null,"2")])]),t("mo",null,","),t("mo",null,"…"),t("mo",null,","),t("msub",null,[t("mi",{mathvariant:"bold-italic"},"e"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"H")])]),t("mo",{fence:"false",stretchy:"false"},"}")])],-1),W1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},U1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.05ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.735ex",height:"1.595ex",role:"img",focusable:"false",viewBox:"0 -683 767 705","aria-hidden":"true"},$1=t("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[t("g",{"data-mml-node":"math"},[t("g",{"data-mml-node":"mi"},[t("path",{"data-c":"1D448",d:"M107 637Q73 637 71 641Q70 643 70 649Q70 673 81 682Q83 683 98 683Q139 681 234 681Q268 681 297 681T342 682T362 682Q378 682 378 672Q378 670 376 658Q371 641 366 638H364Q362 638 359 638T352 638T343 637T334 637Q295 636 284 634T266 623Q265 621 238 518T184 302T154 169Q152 155 152 140Q152 86 183 55T269 24Q336 24 403 69T501 205L552 406Q599 598 599 606Q599 633 535 637Q511 637 511 648Q511 650 513 660Q517 676 519 679T529 683Q532 683 561 682T645 680Q696 680 723 681T752 682Q767 682 767 672Q767 650 759 642Q756 637 737 637Q666 633 648 597Q646 592 598 404Q557 235 548 205Q515 105 433 42T263 -22Q171 -22 116 34T60 167V183Q60 201 115 421Q164 622 164 628Q164 635 107 637Z",style:{"stroke-width":"3"}})])])],-1),K1=[$1],Y1=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mi",null,"U")])],-1),t2={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},a2={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.345ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.485ex",height:"1.348ex",role:"img",focusable:"false",viewBox:"0 -443 1098.3 595.7","aria-hidden":"true"},s2=n("",1),e2=[s2],n2=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"v"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"A")])])])],-1),l2={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},Q2={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"0"},xmlns:"http://www.w3.org/2000/svg",width:"1.697ex",height:"1.62ex",role:"img",focusable:"false",viewBox:"0 -716 750 716","aria-hidden":"true"},T2=t("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[t("g",{"data-mml-node":"math"},[t("g",{"data-mml-node":"mi"},[t("path",{"data-c":"1D434",d:"M208 74Q208 50 254 46Q272 46 272 35Q272 34 270 22Q267 8 264 4T251 0Q249 0 239 0T205 1T141 2Q70 2 50 0H42Q35 7 35 11Q37 38 48 46H62Q132 49 164 96Q170 102 345 401T523 704Q530 716 547 716H555H572Q578 707 578 706L606 383Q634 60 636 57Q641 46 701 46Q726 46 726 36Q726 34 723 22Q720 7 718 4T704 0Q701 0 690 0T651 1T578 2Q484 2 455 0H443Q437 6 437 9T439 27Q443 40 445 43L449 46H469Q523 49 533 63L521 213H283L249 155Q208 86 208 74ZM516 260Q516 271 504 416T490 562L463 519Q447 492 400 412L310 260L413 259Q516 259 516 260Z",style:{"stroke-width":"3"}})])])],-1),o2=[T2],r2=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mi",null,"A")])],-1),p2={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},d2={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.666ex"},xmlns:"http://www.w3.org/2000/svg",width:"13.833ex",height:"2.363ex",role:"img",focusable:"false",viewBox:"0 -750 6114.2 1044.2","aria-hidden":"true"},i2=n("",1),m2=[i2],c2=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mi",null,"a"),t("mo",{stretchy:"false"},"("),t("msub",null,[t("mi",null,"e"),t("mi",null,"j")]),t("mo",null,","),t("msub",null,[t("mi",null,"v"),t("mi",null,"A")]),t("mo",{stretchy:"false"},")"),t("mo",null,"="),t("msub",null,[t("mi",null,"w"),t("mi",null,"j")])])],-1),h2={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},g2={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"0"},xmlns:"http://www.w3.org/2000/svg",width:"1.697ex",height:"1.62ex",role:"img",focusable:"false",viewBox:"0 -716 750 716","aria-hidden":"true"},u2=t("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[t("g",{"data-mml-node":"math"},[t("g",{"data-mml-node":"mi"},[t("path",{"data-c":"1D434",d:"M208 74Q208 50 254 46Q272 46 272 35Q272 34 270 22Q267 8 264 4T251 0Q249 0 239 0T205 1T141 2Q70 2 50 0H42Q35 7 35 11Q37 38 48 46H62Q132 49 164 96Q170 102 345 401T523 704Q530 716 547 716H555H572Q578 707 578 706L606 383Q634 60 636 57Q641 46 701 46Q726 46 726 36Q726 34 723 22Q720 7 718 4T704 0Q701 0 690 0T651 1T578 2Q484 2 455 0H443Q437 6 437 9T439 27Q443 40 445 43L449 46H469Q523 49 533 63L521 213H283L249 155Q208 86 208 74ZM516 260Q516 271 504 416T490 562L463 519Q447 492 400 412L310 260L413 259Q516 259 516 260Z",style:{"stroke-width":"3"}})])])],-1),_2=[u2],y2=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mi",null,"A")])],-1),x2={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},w2={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"3.586ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 1585 1000","aria-hidden":"true"},b2=n("",1),H2=[b2],f2=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mi",null,"a"),t("mo",{stretchy:"false"},"("),t("mo",null,"⋅"),t("mo",{stretchy:"false"},")")])],-1),L2=n("",16);function E2(k2,M2,D2,Z2,v2,V2){return s(),e("div",null,[T,a(" 这个就是喂入模型的数据格式了，这里还要注意一点 就是上面的特征里面没有任何的交互组合，也就是没有做特征交叉。这个交互信息交给后面的神经网络去学习。 "),o,r,p,d,i,t("ol",null,[t("li",null,[m,a("：这个层的作用是把高维稀疏的输入转成低维稠密向量， 每个离散特征下面都会对应着一个 embedding 词典， 维度是"),t("mjx-container",c,[(s(),e("svg",h,u)),_]),a("， 这里的"),t("mjx-container",y,[(s(),e("svg",x,b)),H]),a(" 表示的是隐向量的维度， 而"),t("mjx-container",f,[(s(),e("svg",L,k)),M]),a(" 表示的是当前离散特征的唯一取值个数，这里为了好理解，这里举个例子说明，就比如上面的 weekday 特征：")])]),t("blockquote",null,[t("p",null,[a("假设某个用户的 weekday 特征就是周五，化成 one-hot 编码的时候，就是 [0,0,0,0,1,0,0] 表示，这里如果再假设隐向量维度是 D， 那么这个特征对应的 embedding 词典是一个"),t("mjx-container",D,[(s(),e("svg",Z,V)),A]),a(" 的一个矩阵 (每一列代表一个 embedding，7 列正好 7 个 embedding 向量，对应周一到周日)，那么该用户这个 one-hot 向量经过 embedding 层之后会得到一个"),t("mjx-container",C,[(s(),e("svg",j,N)),I]),a(" 的向量，也就是周五对应的那个 embedding，怎么算的，其实就是"),t("mjx-container",S,[(s(),e("svg",R,B)),O]),a(" 。其实也就是直接把 embedding 矩阵中 one-hot 向量为 1 的那个位置的 embedding 向量拿出来。 这样就得到了稀疏特征的稠密向量了。其他离散特征也是同理，只不过上面那个 multi-hot 编码的那个，会得到一个 embedding 向量的列表，因为他开始的那个 multi-hot 向量不止有一个是 1，这样乘以 embedding 矩阵，就会得到一个列表了。通过这个层，上面的输入特征都可以拿到相应的稠密 embedding 向量了。")])]),t("ol",q,[t("li",null,[z,a("： pooling 层的作用是将用户的历史行为 embedding 这个最终变成一个定长的向量，因为每个用户历史购买的商品数是不一样的， 也就是每个用户 multi-hot 中 1 的个数不一致，这样经过 embedding 层，得到的用户历史行为 embedding 的个数不一样多，也就是上面的 embedding 列表"),t("mjx-container",G,[(s(),e("svg",X,W)),U]),a(" 不一样长， 那么这样的话，每个用户的历史行为特征拼起来就不一样长了。 而后面如果加全连接网络的话，我们知道，他需要定长的特征输入。 所以往往用一个 pooling layer 先把用户历史行为 embedding 变成固定长度 (统一长度)，所以有了这个公式：")])]),t("mjx-container",$,[(s(),e("svg",K,t1)),a1]),t("p",null,[a("这里的"),t("mjx-container",s1,[(s(),e("svg",e1,l1)),Q1]),a(" 是用户历史行为的那些 embedding。"),t("mjx-container",T1,[(s(),e("svg",o1,p1)),d1]),a(" 就变成了定长的向量， 这里的"),t("mjx-container",i1,[(s(),e("svg",m1,h1)),g1]),a(" 表示第"),t("mjx-container",u1,[(s(),e("svg",_1,x1)),w1]),a(" 个历史特征组 (是历史行为，比如历史的商品 id，历史的商品类别 id 等)， 这里的"),t("mjx-container",b1,[(s(),e("svg",H1,L1)),E1]),a(" 表示对应历史特种组里面用户购买过的商品数量，也就是历史 embedding 的数量，看上面图里面的 user behaviors 系列，就是那个过程了。 Concat layer 层的作用就是拼接了，就是把这所有的特征 embedding 向量，如果再有连续特征的话也算上，从特征维度拼接整合，作为 MLP 的输入。")]),k1,t("mjx-container",M1,[(s(),e("svg",D1,v1)),V1]),A1,t("p",null,[a("这里改进的地方已经框出来了，这里会发现相比于 base model， 这里加了一个 local activation unit， 这里面是一个前馈神经网络，输入是用户历史行为商品和当前的候选商品， 输出是它俩之间的相关性， 这个相关性相当于每个历史商品的权重，把这个权重与原来的历史行为 embedding 相乘求和就得到了用户的兴趣表示"),t("mjx-container",C1,[(s(),e("svg",j1,N1)),I1]),a(", 这个东西的计算公式如下：")]),t("mjx-container",S1,[(s(),e("svg",R1,B1)),O1]),t("p",null,[a("这里的"),t("mjx-container",q1,[(s(),e("svg",z1,X1)),J1]),a(" 是用户"),t("mjx-container",W1,[(s(),e("svg",U1,K1)),Y1]),a(" 的历史行为特征 embedding， "),t("mjx-container",t2,[(s(),e("svg",a2,e2)),n2]),a(" 表示的是候选广告"),t("mjx-container",l2,[(s(),e("svg",Q2,o2)),r2]),a(" 的 embedding 向量， "),t("mjx-container",p2,[(s(),e("svg",d2,m2)),c2]),a(" 表示的权重或者历史行为商品与当前广告"),t("mjx-container",h2,[(s(),e("svg",g2,_2)),y2]),a(" 的相关性程度。"),t("mjx-container",x2,[(s(),e("svg",w2,H2)),f2]),a(" 表示的上面那个前馈神经网络，也就是那个所谓的注意力机制， 当然，看图里的话，输入除了历史行为向量和候选广告向量外，还加了一个它俩的外积操作，作者说这里是有利于模型相关性建模的显性知识。")]),L2])}const j2=l(Q,[["render",E2]]);export{C2 as __pageData,j2 as default};
