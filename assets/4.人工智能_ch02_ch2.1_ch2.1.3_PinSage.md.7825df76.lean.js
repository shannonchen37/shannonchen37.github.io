import{_ as e,o as l,c as p,j as s,a as n,U as a}from"./chunks/framework.489e5108.js";const $n=JSON.parse('{"title":"Graph Convolutional Neural Networks for Web-Scale Recommender Systems","description":"","frontmatter":{},"headers":[],"relativePath":"4.人工智能/ch02/ch2.1/ch2.1.3/PinSage.md","filePath":"4.人工智能/ch02/ch2.1/ch2.1.3/PinSage.md","lastUpdated":1696176798000}'),o={name:"4.人工智能/ch02/ch2.1/ch2.1.3/PinSage.md"},t=a("",8),r={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},c={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.576ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.291ex",height:"2.463ex",role:"img",focusable:"false",viewBox:"0 -833.9 1012.6 1088.7","aria-hidden":"true"},i=a("",1),E=[i],y=s("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("msubsup",null,[s("mi",null,"h"),s("mi",null,"v"),s("mn",null,"0")])])],-1),d={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},m={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.576ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.324ex",height:"2.508ex",role:"img",focusable:"false",viewBox:"0 -853.7 1027.4 1108.5","aria-hidden":"true"},Q=a("",1),T=[Q],h=s("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("msubsup",null,[s("mi",null,"h"),s("mi",null,"v"),s("mi",null,"k")])])],-1),_={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},u={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"4.867ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 2151 1000","aria-hidden":"true"},g=a("",1),b=[g],F=s("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("mi",null,"N"),s("mo",{stretchy:"false"},"("),s("mi",null,"v"),s("mo",{stretchy:"false"},")")])],-1),w={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},x={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.576ex"},xmlns:"http://www.w3.org/2000/svg",width:"4.369ex",height:"2.508ex",role:"img",focusable:"false",viewBox:"0 -853.7 1931.1 1108.5","aria-hidden":"true"},f=a("",1),C=[f],A=s("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("msubsup",null,[s("mi",null,"h"),s("mi",null,"u"),s("mrow",{"data-mjx-texclass":"ORD"},[s("mi",null,"k"),s("mo",null,"−"),s("mn",null,"1")])])])],-1),D={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},k={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-1.238ex"},xmlns:"http://www.w3.org/2000/svg",width:"13.703ex",height:"3.78ex",role:"img",focusable:"false",viewBox:"0 -1123.8 6056.9 1670.9","aria-hidden":"true"},v=a("",1),B=[v],H=s("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("munder",null,[s("mo",{"data-mjx-texclass":"OP"},"∑"),s("mrow",{"data-mjx-texclass":"ORD"},[s("mi",null,"u"),s("mo",null,"∈"),s("mi",null,"N"),s("mo",{stretchy:"false"},"("),s("mi",null,"v"),s("mo",{stretchy:"false"},")")])]),s("mfrac",null,[s("msubsup",null,[s("mi",null,"h"),s("mi",null,"u"),s("mrow",{"data-mjx-texclass":"ORD"},[s("mi",null,"k"),s("mo",null,"−"),s("mn",null,"1")])]),s("mrow",null,[s("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|"),s("mi",null,"N"),s("mo",{stretchy:"false"},"("),s("mi",null,"v"),s("mo",{stretchy:"false"},")"),s("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|")])])])],-1),L=s("strong",null,"借助图上的边将邻居节点的信息通过边关系聚合到节点表示中 (简称卷积操作)",-1),M={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},S={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.576ex"},xmlns:"http://www.w3.org/2000/svg",width:"4.369ex",height:"2.508ex",role:"img",focusable:"false",viewBox:"0 -853.7 1931.1 1108.5","aria-hidden":"true"},G=a("",1),P=[G],j=s("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("msubsup",null,[s("mi",null,"h"),s("mi",null,"v"),s("mrow",{"data-mjx-texclass":"ORD"},[s("mi",null,"k"),s("mo",null,"−"),s("mn",null,"1")])])])],-1),q=s("strong",null,"在对自身做多次非线性变换时，同时利用边关系聚合邻居节点信息。",-1),V={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},Z={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.509ex",height:"1.902ex",role:"img",focusable:"false",viewBox:"0 -683 1108.9 840.8","aria-hidden":"true"},N=a("",1),z=[N],I=s("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("msub",null,[s("mi",null,"Z"),s("mi",null,"v")])])],-1),R=s("p",null,"可以发现相比传统的方法 (MLP，CNN，DeepWalk 或 EGES)，GCN 或 GraphSAGE 存在一些优势：",-1),J=s("ol",null,[s("li",null,[n("相比于传统的深度学习方法 (MLP,CNN)，GCN 在对自身节点进行非线性变换时，同时考虑了图中的邻接关系。从 CNN 的角度理解，GCN 通过堆叠多层结构在图结构数据上拥有更大的"),s("strong",null,"感受野"),n("，利用更加广域内的信息。")]),s("li",null,"相比于图嵌入学习方法 (DeepWalk，EGES)，GCN 在学习节点表示的过程中，在利用节点自身的属性信息之外，更好的利用图结构上的边信息。相比于借助随机采样的方式来使用边信息，GCN 的方式能从全局的角度利用的邻居信息。此外，类似于 GraphSAGE 这种归纳 (inductive) 学习的 GCN 方法，通过学习聚合节点邻居生成节点 Embedding 的函数的方式，更适用于图结构和节点会不断变化的工业场景。")],-1),O=s("p",null,"在采样得到目标节点的邻居集之后，那么如何聚合邻居节点的信息来更新目标节点的嵌入表示呢？下面就来看看 GraphSAGE 中提及的四个聚合函数。",-1),W=s("h2",{id:"graphsage的采样和聚合",tabindex:"-1"},[n("GraphSAGE 的采样和聚合 "),s("a",{class:"header-anchor",href:"#graphsage的采样和聚合","aria-label":'Permalink to "GraphSAGE的采样和聚合"'},"​")],-1),U={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},X={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"4.867ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 2151 1000","aria-hidden":"true"},$=a("",1),K=[$],Y=s("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("mi",null,"N"),s("mo",{stretchy:"false"},"("),s("mi",null,"v"),s("mo",{stretchy:"false"},")")])],-1),ss=s("div",{align:"center"},[s("img",{src:"https://cdn.jsdelivr.net/gh/swallown1/blogimages@main/images/image-20220406135753358.png",style:{zoom:"90%"}})],-1),ns=s("p",null,"GraphSAGE 的 minibatch 算法的思路是针对 Batch 内的所有节点，通过采样和聚合节点，为每一个节点学习一个 embedding。",-1),as=s("h4",{id:"邻居采样",tabindex:"-1"},[n("邻居采样 "),s("a",{class:"header-anchor",href:"#邻居采样","aria-label":'Permalink to "邻居采样"'},"​")],-1),ls={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},ps={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"0"},xmlns:"http://www.w3.org/2000/svg",width:"2.738ex",height:"1.932ex",role:"img",focusable:"false",viewBox:"0 -853.7 1210.4 853.7","aria-hidden":"true"},es=a("",1),os=[es],ts=s("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("msup",null,[s("mi",null,"B"),s("mi",null,"k")])])],-1),rs={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},cs={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"0"},xmlns:"http://www.w3.org/2000/svg",width:"4.783ex",height:"1.932ex",role:"img",focusable:"false",viewBox:"0 -853.7 2114.1 853.7","aria-hidden":"true"},is=a("",1),Es=[is],ys=s("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("msup",null,[s("mi",null,"B"),s("mrow",{"data-mjx-texclass":"ORD"},[s("mi",null,"k"),s("mo",null,"−"),s("mn",null,"1")])])])],-1),ds={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},ms={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"0"},xmlns:"http://www.w3.org/2000/svg",width:"2.705ex",height:"1.887ex",role:"img",focusable:"false",viewBox:"0 -833.9 1195.6 833.9","aria-hidden":"true"},Qs=a("",1),Ts=[Qs],hs=s("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("msup",null,[s("mi",null,"B"),s("mrow",{"data-mjx-texclass":"ORD"},[s("mn",null,"0")])])])],-1),_s=s("strong",null,"为什么需要采样并且固定采样数量 S？",-1),us={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},gs={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"0"},xmlns:"http://www.w3.org/2000/svg",width:"2.705ex",height:"1.887ex",role:"img",focusable:"false",viewBox:"0 -833.9 1195.6 833.9","aria-hidden":"true"},bs=a("",1),Fs=[bs],ws=s("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("msup",null,[s("mi",null,"B"),s("mn",null,"0")])])],-1),xs=s("p",null,"进行邻居采样并固定采样数量 S 主要是因为：1. 采样邻居节点避免了在全图的搜索以及使用全部邻居节点所导致计算复杂度高的问题；2. 可以通过采样使得部分节点更同质化，即两个相似的节点具有相同表达形式。3. 采样固定数量是保持每个 batch 的计算占用空间是固定的，方便进行批量训练。",-1),fs={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},Cs={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"0"},xmlns:"http://www.w3.org/2000/svg",width:"2.705ex",height:"1.887ex",role:"img",focusable:"false",viewBox:"0 -833.9 1195.6 833.9","aria-hidden":"true"},As=a("",1),Ds=[As],ks=s("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("msup",null,[s("mi",null,"B"),s("mn",null,"0")])])],-1),vs=s("h4",{id:"聚合函数",tabindex:"-1"},[n("聚合函数 "),s("a",{class:"header-anchor",href:"#聚合函数","aria-label":'Permalink to "聚合函数"'},"​")],-1),Bs=s("p",null,[n("如何对于采样到的节点集进行聚合，介绍的 4 种方式：Mean 聚合、Convolutional 聚合、LSTM 聚合以及 Pooling 聚合。由于邻居节点是无序的，所以希望构造的聚合函数具有"),s("strong",null,"对称性 (即输出的结果不因输入排序的不同而改变)"),n("，同时拥有"),s("strong",null,"较强的表达能力"),n("。")],-1),Hs=s("strong",null," element-wise",-1),Ls={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},Ms={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.576ex"},xmlns:"http://www.w3.org/2000/svg",width:"4.369ex",height:"2.508ex",role:"img",focusable:"false",viewBox:"0 -853.7 1931.1 1108.5","aria-hidden":"true"},Ss=a("",1),Gs=[Ss],Ps=s("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("msubsup",null,[s("mi",null,"h"),s("mi",null,"v"),s("mrow",{"data-mjx-texclass":"ORD"},[s("mi",null,"k"),s("mo",null,"−"),s("mn",null,"1")])])])],-1),js={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},qs={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.576ex"},xmlns:"http://www.w3.org/2000/svg",width:"21.534ex",height:"2.508ex",role:"img",focusable:"false",viewBox:"0 -853.7 9518 1108.5","aria-hidden":"true"},Vs=a("",1),Zs=[Vs],Ns=s("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("mi",null,"M"),s("mi",null,"E"),s("mi",null,"A"),s("mi",null,"N"),s("mo",{stretchy:"false"},"("),s("msubsup",null,[s("mi",null,"h"),s("mi",null,"u"),s("mi",null,"k")]),s("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|"),s("mi",null,"u"),s("mo",null,"∈"),s("mi",null,"N"),s("mo",{stretchy:"false"},"("),s("mi",null,"v"),s("mo",{stretchy:"false"},")"),s("mo",{stretchy:"false"},")")])],-1),zs=s("strong",null," 分别",-1),Is=s("strong",null,"相加",-1),Rs=a("",3),Js=a("",13),Os={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},Ws={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.489ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.229ex",height:"1.486ex",role:"img",focusable:"false",viewBox:"0 -441 543 657","aria-hidden":"true"},Us=s("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[s("g",{"data-mml-node":"math"},[s("g",{"data-mml-node":"mi"},[s("path",{"data-c":"1D6FE",d:"M31 249Q11 249 11 258Q11 275 26 304T66 365T129 418T206 441Q233 441 239 440Q287 429 318 386T371 255Q385 195 385 170Q385 166 386 166L398 193Q418 244 443 300T486 391T508 430Q510 431 524 431H537Q543 425 543 422Q543 418 522 378T463 251T391 71Q385 55 378 6T357 -100Q341 -165 330 -190T303 -216Q286 -216 286 -188Q286 -138 340 32L346 51L347 69Q348 79 348 100Q348 257 291 317Q251 355 196 355Q148 355 108 329T51 260Q49 251 47 251Q45 249 31 249Z",style:{"stroke-width":"3"}})])])],-1),Xs=[Us],$s=s("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("mi",null,"γ")])],-1),Ks=s("strong",null,"加权和",-1),Ys={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},sn={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.155ex",height:"1.357ex",role:"img",focusable:"false",viewBox:"0 -442 952.5 599.8","aria-hidden":"true"},nn=a("",1),an=[nn],ln=s("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("msub",null,[s("mi",null,"z"),s("mi",null,"u")])])],-1),pn={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},en={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.46ex",height:"1.357ex",role:"img",focusable:"false",viewBox:"0 -442 1087.5 599.8","aria-hidden":"true"},on=a("",1),tn=[on],rn=s("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("msub",null,[s("mi",null,"n"),s("mi",null,"u")])])],-1),cn={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},En={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.155ex",height:"1.357ex",role:"img",focusable:"false",viewBox:"0 -442 952.5 599.8","aria-hidden":"true"},yn=a("",1),dn=[yn],mn=s("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("msub",null,[s("mi",null,"z"),s("mi",null,"u")])])],-1),Qn={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},Tn={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.155ex",height:"1.357ex",role:"img",focusable:"false",viewBox:"0 -442 952.5 599.8","aria-hidden":"true"},hn=a("",1),_n=[hn],un=s("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("msub",null,[s("mi",null,"z"),s("mi",null,"u")])])],-1),gn=s("strong",null,"可以使训练更稳定，以及在近似查找最近邻的应用中更有效率。",-1),bn=a("",7),Fn={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},wn={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.65ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.538ex",height:"2.195ex",role:"img",focusable:"false",viewBox:"0 -683 1121.7 970.2","aria-hidden":"true"},xn=a("",1),fn=[xn],Cn=s("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("msub",null,[s("mi",null,"Z"),s("mi",null,"p")])])],-1),An={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},Dn={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.285ex",height:"1.902ex",role:"img",focusable:"false",viewBox:"0 -683 1010 840.8","aria-hidden":"true"},kn=a("",1),vn=[kn],Bn=s("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("msub",null,[s("mi",null,"Z"),s("mi",null,"i")])])],-1),Hn={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},Ln={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.592ex"},xmlns:"http://www.w3.org/2000/svg",width:"3.415ex",height:"2.137ex",role:"img",focusable:"false",viewBox:"0 -683 1509.5 944.6","aria-hidden":"true"},Mn=a("",1),Sn=[Mn],Gn=s("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("msub",null,[s("mi",null,"Z"),s("mrow",{"data-mjx-texclass":"ORD"},[s("msub",null,[s("mi",null,"n"),s("mi",null,"k")])])])])],-1),Pn={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},jn={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"0"},xmlns:"http://www.w3.org/2000/svg",width:"1.885ex",height:"1.62ex",role:"img",focusable:"false",viewBox:"0 -716 833 716","aria-hidden":"true"},qn=s("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[s("g",{"data-mml-node":"math"},[s("g",{"data-mml-node":"mi"},[s("path",{"data-c":"394",d:"M51 0Q46 4 46 7Q46 9 215 357T388 709Q391 716 416 716Q439 716 444 709Q447 705 616 357T786 7Q786 4 781 0H51ZM507 344L384 596L137 92L383 91H630Q630 93 507 344Z",style:{"stroke-width":"3"}})])])],-1),Vn=[qn],Zn=s("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("mi",{mathvariant:"normal"},"Δ")])],-1),Nn=a("",59);function zn(In,Rn,Jn,On,Wn,Un){return l(),p("div",null,[t,s("ul",null,[s("li",null,[s("mjx-container",r,[(l(),p("svg",c,E)),y]),n(" 表示图上节点的初始化表示，等同于节点自身的特征。")]),s("li",null,[s("mjx-container",d,[(l(),p("svg",m,T)),h]),n(" 表示第 k 层卷积后的节点表示，其来源于两个部分： "),s("ul",null,[s("li",null,[n("第一部分来源于节点 v 的邻居节点集合"),s("mjx-container",_,[(l(),p("svg",u,b)),F]),n("，利用邻居节点的第 k-1 层卷积后的特征"),s("mjx-container",w,[(l(),p("svg",x,C)),A]),n(" 进行 （ "),s("mjx-container",D,[(l(),p("svg",k,B)),H]),n(" ）后，在进行线性变换。这里"),L,n("。")]),s("li",null,[n("第二部分来源于节点 v 的第 k-1 成卷积后的特征"),s("mjx-container",M,[(l(),p("svg",S,P)),j]),n("，进行线性变换。总的来说图卷积的思想是"),q])])]),s("li",null,[n("最后一次卷积结果作为节点的最终表示"),s("mjx-container",V,[(l(),p("svg",Z,z)),I]),n("，以用于下游任务 (节点分类，链路预测或节点召回)。")])]),R,J,O,W,s("p",null,[n("通过上面的公式可以知道，得到节点的表示主要依赖于两部分，其中一部分其邻居节点。因此对于 GraphSAGE 的关键主要分为两步：Sample 采样和 Aggregate 聚合。其中 Sample 的作用是从庞大的邻居节点中选出用于聚合的邻居节点集合"),s("mjx-container",U,[(l(),p("svg",X,K)),Y]),n(" 以达到降低迭代计算复杂度，而聚合操作就是如何利用邻居节点的表示来更新节点 v 的表示，已达到聚合作用。具体的过程如下伪代码所示：")]),ss,ns,as,s("p",null,[n("GraphSAGE 的具体采样过程是，首先根据中心节点集合"),s("mjx-container",ls,[(l(),p("svg",ps,os)),ts]),n("，对集合中每个中心节点通过随机采样的方式对其邻居节点采样固定数量 S 个 (如果邻居节点数量大于 S，采用无放回抽样；如果小于 S，则采用有放回抽样)，形成的集合表示为"),s("mjx-container",rs,[(l(),p("svg",cs,Es)),ys]),n("；以此类推每次都是为前一个得到的集合的每个节点随机采样 S 个邻居，最终得到第 k 层的所有需要参与计算的节点集合"),s("mjx-container",ds,[(l(),p("svg",ms,Ts)),hs]),n("。值得注意的有两点："),_s,n(),s("strong",null,[n("为什么第 k 层所采样的节点集合表示为"),s("mjx-container",us,[(l(),p("svg",gs,Fs)),ws]),n("？")])]),xs,s("p",null,[n("第 k 层所采样的节点集合表示为"),s("mjx-container",fs,[(l(),p("svg",Cs,Ds)),ks]),n(" 主要是因为：采样和聚合过程是相反的，即采样时我们是从中心节点组层进行采样，而聚合的过程是从中心节点的第 k 阶邻居逐层聚合得到前一层的节点表示。因此可以认为聚合阶段是：将 k 阶邻居的信息聚合到 k-1 阶邻居上，k-1 阶邻居的信息聚合到 k-2 阶邻居上，....，1 阶邻居的信息聚合到中心节点上的过程。")]),vs,Bs,s("ul",null,[s("li",null,[s("p",null,[n("Mean 聚合：首先会对邻居节点按照"),Hs,n(" 进行均值聚合，然后将当前节点 k-1 层得到特征"),s("mjx-container",Ls,[(l(),p("svg",Ms,Gs)),Ps]),n(" 与邻居节点均值聚合后的特征 "),s("mjx-container",js,[(l(),p("svg",qs,Zs)),Ns]),zs,n("送入全连接网络后"),Is,n("得到结果。")])]),Rs]),Js,s("ol",null,[s("li",null,[n("聚合邻居： 先将所有的邻居节点经过一次非线性转化 (一层 DNN)，再由聚合函数 (Pooling 聚合) "),s("mjx-container",Os,[(l(),p("svg",Ws,Xs)),$s]),n("（如元素平均，"),Ks,n("等）将所有邻居信息聚合成目标节点的 embedding。这里的加权聚合采用的是通过 random-walk 得到的重要性权重。")]),s("li",null,[n("更新当前节点的 embedding：将目标节点当前的向量 "),s("mjx-container",Ys,[(l(),p("svg",sn,an)),ln]),n(" 与步骤 1 中聚合得到的邻居向量 "),s("mjx-container",pn,[(l(),p("svg",en,tn)),rn]),n(" 进行拼接，在通过一次非线性转化。")]),s("li",null,[n("归一化操作：对目标节点向量 "),s("mjx-container",cn,[(l(),p("svg",En,dn)),mn]),n(" 归一化。")])]),s("p",null,[n("Convolve 算法的聚合方法与 GraphSAGE 的 Pooling 聚合函数相同，主要区别在于对更新得到的向量 "),s("mjx-container",Qn,[(l(),p("svg",Tn,_n)),un]),n(" 进行归一化操作，"),gn]),bn,s("p",null,[n("其中"),s("mjx-container",Fn,[(l(),p("svg",wn,fn)),Cn]),n(" 是学习得到的目标节点 embedding，"),s("mjx-container",An,[(l(),p("svg",Dn,vn)),Bn]),n(" 是与目标节点相关 item 的 embedding，"),s("mjx-container",Hn,[(l(),p("svg",Ln,Sn)),Gn]),n(" 是与目标节点不相关 item 的 embedding，"),s("mjx-container",Pn,[(l(),p("svg",jn,Vn)),Zn]),n(" 为 margin 值，具体大小需要调参。那么对于相关节点 i，以及不相关节点 nk，具体都是如何定义的，这对于召回模型的训练意义重大，让我们看看具体是如何定义的。")]),Nn])}const Kn=e(o,[["render",zn]]);export{$n as __pageData,Kn as default};
