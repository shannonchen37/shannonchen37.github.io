import{_ as T,o as t,c as e,j as a,a as n,U as s}from"./chunks/framework.489e5108.js";const T1=JSON.parse('{"title":"Wide & Deep","description":"","frontmatter":{},"headers":[],"relativePath":"4.人工智能/ch02/ch2.2/ch2.2.3/WideNDeep.md","filePath":"4.人工智能/ch02/ch2.2/ch2.2.3/WideNDeep.md","lastUpdated":1696176798000}'),l={name:"4.人工智能/ch02/ch2.2/ch2.2.3/WideNDeep.md"},Q=s("",10),o=a("p",null,"wide 部分是一个广义的线性模型，输入的特征主要有两部分组成，一部分是原始的部分特征，另一部分是原始特征的交叉特征 (cross-product transformation)，对于交互特征可以定义为：",-1),p={class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},r={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-2.819ex"},xmlns:"http://www.w3.org/2000/svg",width:"26.852ex",height:"6.757ex",role:"img",focusable:"false",viewBox:"0 -1740.7 11868.7 2986.6","aria-hidden":"true"},d=s("",1),i=[d],m=a("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[a("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[a("msub",null,[a("mi",null,"ϕ"),a("mrow",{"data-mjx-texclass":"ORD"},[a("mi",null,"k")])]),a("mo",{stretchy:"false"},"("),a("mi",null,"x"),a("mo",{stretchy:"false"},")"),a("mo",null,"="),a("munderover",null,[a("mo",{"data-mjx-texclass":"OP"},"∏"),a("mrow",{"data-mjx-texclass":"ORD"},[a("mi",null,"i"),a("mo",null,"="),a("mn",null,"1")]),a("mi",null,"d")]),a("msubsup",null,[a("mi",null,"x"),a("mi",null,"i"),a("mrow",{"data-mjx-texclass":"ORD"},[a("msub",null,[a("mi",null,"c"),a("mrow",{"data-mjx-texclass":"ORD"},[a("mi",null,"k"),a("mi",null,"i")])])])]),a("mo",null,","),a("msub",null,[a("mi",null,"c"),a("mrow",{"data-mjx-texclass":"ORD"},[a("mi",null,"k"),a("mi",null,"i")])]),a("mo",null,"∈"),a("mo",{fence:"false",stretchy:"false"},"{"),a("mn",null,"0"),a("mo",null,","),a("mn",null,"1"),a("mo",{fence:"false",stretchy:"false"},"}")])],-1),c={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},h={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.553ex",height:"1.357ex",role:"img",focusable:"false",viewBox:"0 -442 1128.4 599.8","aria-hidden":"true"},g=s("",1),u=[g],y=a("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[a("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[a("msub",null,[a("mi",null,"c"),a("mrow",{"data-mjx-texclass":"ORD"},[a("mi",null,"k"),a("mi",null,"i")])])])],-1),_={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},H={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.553ex",height:"1.357ex",role:"img",focusable:"false",viewBox:"0 -442 1128.4 599.8","aria-hidden":"true"},w=s("",1),x=[w],f=a("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[a("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[a("msub",null,[a("mi",null,"c"),a("mrow",{"data-mjx-texclass":"ORD"},[a("mi",null,"k"),a("mi",null,"i")])])])],-1),E={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},b={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.034ex",height:"1.357ex",role:"img",focusable:"false",viewBox:"0 -442 899 599.8","aria-hidden":"true"},D=s("",1),k=[D],L=a("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[a("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[a("msub",null,[a("mi",null,"x"),a("mi",null,"i")])])],-1),M=a("blockquote",null,[a("p",null,"AND (user_installed_app=QQ, impression_app=WeChat)，当特征 user_installed_app=QQ, 和特征 impression_app=WeChat 取值都为 1 的时候，组合特征 AND (user_installed_app=QQ, impression_app=WeChat) 的取值才为 1，否则为 0。")],-1),Z={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},V={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.339ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.528ex",height:"1.885ex",role:"img",focusable:"false",viewBox:"0 -683 1117.6 833","aria-hidden":"true"},v=s("",1),A=[v],C=a("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[a("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[a("msub",null,[a("mi",null,"L"),a("mn",null,"1")])])],-1),F=a("strong",null,"用户安装了应用 A，此时曝光应用 B，用户安装应用 B 的概率大。",-1),W=a("p",null,"Deep 部分是一个 DNN 模型，输入的特征主要分为两大类，一类是数值特征 (可直接输入 DNN)，一类是类别特征 (需要经过 Embedding 之后才能输入到 DNN 中)，Deep 部分的数学形式如下：",-1),j={class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},R={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"21.839ex",height:"2.7ex",role:"img",focusable:"false",viewBox:"0 -943.3 9653 1193.3","aria-hidden":"true"},S=s("",1),N=[S],O=a("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[a("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[a("msup",null,[a("mi",null,"a"),a("mrow",{"data-mjx-texclass":"ORD"},[a("mo",{stretchy:"false"},"("),a("mi",null,"l"),a("mo",null,"+"),a("mn",null,"1"),a("mo",{stretchy:"false"},")")])]),a("mo",null,"="),a("mi",null,"f"),a("mo",{stretchy:"false"},"("),a("msup",null,[a("mi",null,"W"),a("mrow",{"data-mjx-texclass":"ORD"},[a("mi",null,"l")])]),a("msup",null,[a("mi",null,"a"),a("mrow",{"data-mjx-texclass":"ORD"},[a("mo",{stretchy:"false"},"("),a("mi",null,"l"),a("mo",{stretchy:"false"},")")])]),a("mo",null,"+"),a("msup",null,[a("mi",null,"b"),a("mrow",{"data-mjx-texclass":"ORD"},[a("mi",null,"l")])]),a("mo",{stretchy:"false"},")")])],-1),B=a("p",null,"** 我们知道 DNN 模型随着层数的增加，中间的特征就越抽象，也就提高了模型的泛化能力。** 对于 Deep 部分的 DNN 模型作者使用了深度学习常用的优化器 AdaGrad，这也是为了使得模型可以得到更精确的解。",-1),P=a("p",null,[a("strong",null,"Wide 部分与 Deep 部分的结合")],-1),z=a("p",null,"W&D 模型是将两部分输出的结果结合起来联合训练，将 deep 和 wide 部分的输出重新使用一个逻辑回归模型做最终的预测，输出概率值。联合训练的数学形式如下：需要注意的是，因为 Wide 侧的数据是高维稀疏的，所以作者使用了 FTRL 算法优化，而 Deep 侧使用的是 Adagrad。",-1),I={class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},G={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.893ex"},xmlns:"http://www.w3.org/2000/svg",width:"45.505ex",height:"3.028ex",role:"img",focusable:"false",viewBox:"0 -943.3 20113.3 1338.2","aria-hidden":"true"},q=s("",1),X=[q],J=a("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[a("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[a("mi",null,"P"),a("mo",{stretchy:"false"},"("),a("mi",null,"Y"),a("mo",null,"="),a("mn",null,"1"),a("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|"),a("mi",null,"x"),a("mo",{stretchy:"false"},")"),a("mo",null,"="),a("mi",null,"δ"),a("mo",{stretchy:"false"},"("),a("msubsup",null,[a("mi",null,"w"),a("mrow",{"data-mjx-texclass":"ORD"},[a("mi",null,"w"),a("mi",null,"i"),a("mi",null,"d"),a("mi",null,"e")]),a("mi",null,"T")]),a("mo",{stretchy:"false"},"["),a("mi",null,"x"),a("mo",null,","),a("mi",null,"ϕ"),a("mo",{stretchy:"false"},"("),a("mi",null,"x"),a("mo",{stretchy:"false"},")"),a("mo",{stretchy:"false"},"]"),a("mo",null,"+"),a("msubsup",null,[a("mi",null,"w"),a("mrow",{"data-mjx-texclass":"ORD"},[a("mi",null,"d"),a("mi",null,"e"),a("mi",null,"e"),a("mi",null,"p")]),a("mi",null,"T")]),a("msup",null,[a("mi",null,"a"),a("mrow",{"data-mjx-texclass":"ORD"},[a("mo",{stretchy:"false"},"("),a("mi",null,"l"),a("mi",null,"f"),a("mo",{stretchy:"false"},")")])]),a("mo",null,"+"),a("mi",null,"b"),a("mo",{stretchy:"false"},")")])],-1),$=s("",14);function U(Y,K,a1,s1,t1,e1){return t(),e("div",null,[Q,a("ul",null,[a("li",null,[o,a("mjx-container",p,[(t(),e("svg",r,i)),m]),a("p",null,[a("mjx-container",c,[(t(),e("svg",h,u)),y]),n(" 是一个布尔变量，当第 i 个特征属于第 k 个特征组合时，"),a("mjx-container",_,[(t(),e("svg",H,x)),f]),n(" 的值为 1，否则为 0，"),a("mjx-container",E,[(t(),e("svg",b,k)),L]),n(" 是第 i 个特征的值，大体意思就是两个特征都同时为 1 这个新的特征才能为 1，否则就是 0，说白了就是一个特征组合。用原论文的例子举例：")]),M,a("p",null,[n("对于 wide 部分训练时候使用的优化器是带"),a("mjx-container",Z,[(t(),e("svg",V,A)),C]),n(' 正则的 FTRL 算法 (Follow-the-regularized-leader)，而 L1 FTLR 是非常注重模型稀疏性质的，也就是说 W&D 模型采用 L1 FTRL 是想让 Wide 部分变得更加的稀疏，即 Wide 部分的大部分参数都为 0，这就大大压缩了模型权重及特征向量的维度。**Wide 部分模型训练完之后留下来的特征都是非常重要的，那么模型的 “记忆能力” 就可以理解为发现 "直接的"，“暴力的”，“显然的” 关联规则的能力。** 例如 Google W&D 期望 wide 部分发现这样的规则：'),F])]),a("li",null,[W,a("mjx-container",j,[(t(),e("svg",R,N)),O]),B])]),P,z,a("mjx-container",I,[(t(),e("svg",G,X)),J]),$])}const l1=T(l,[["render",U]]);export{T1 as __pageData,l1 as default};
