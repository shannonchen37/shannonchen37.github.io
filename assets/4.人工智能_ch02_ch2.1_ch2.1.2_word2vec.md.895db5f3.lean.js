import{_ as e,o as Q,c as s,j as t,a,U as T}from"./chunks/framework.489e5108.js";const t6=JSON.parse('{"title":"背景和引入","description":"","frontmatter":{},"headers":[],"relativePath":"4.人工智能/ch02/ch2.1/ch2.1.2/word2vec.md","filePath":"4.人工智能/ch02/ch2.1/ch2.1.2/word2vec.md","lastUpdated":1696176798000}'),l={name:"4.人工智能/ch02/ch2.1/ch2.1.2/word2vec.md"},n=T("",34),o=t("strong",null,"使用概率工具描述事件的发生",-1),r={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},d={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"6.165ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 2725 1000","aria-hidden":"true"},m=T("",1),i=[m],p=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mi",null,"P"),t("mo",{stretchy:"false"},"("),t("mi",null,"o"),t("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|"),t("mi",null,"c"),t("mo",{stretchy:"false"},")")])],-1),c={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},h={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"6.165ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 2725 1000","aria-hidden":"true"},g=T("",1),u=[g],w=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mi",null,"P"),t("mo",{stretchy:"false"},"("),t("mi",null,"o"),t("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|"),t("mi",null,"c"),t("mo",{stretchy:"false"},")")])],-1),y=t("img",{src:"https://ryluo.oss-cn-chengdu.aliyuncs.com/图片3.png"},null,-1),x=t("p",null,"我们滑动窗口，再以 banking 为中心词",-1),H=t("img",{src:"https://ryluo.oss-cn-chengdu.aliyuncs.com/图片4.png"},null,-1),_={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},f={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"6.165ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 2725 1000","aria-hidden":"true"},k=T("",1),b=[k],M=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mi",null,"P"),t("mo",{stretchy:"false"},"("),t("mi",null,"o"),t("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|"),t("mi",null,"c"),t("mo",{stretchy:"false"},")")])],-1),L=t("strong",null,"最大化单词 o 在单词 c 周围出现了这一事实",-1),v={class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},Z={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-2.619ex"},xmlns:"http://www.w3.org/2000/svg",width:"17.557ex",height:"4.769ex",role:"img",focusable:"false",viewBox:"0 -950 7760 2107.8","aria-hidden":"true"},E=T("",1),D=[E],V=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("mi",null,"m"),t("mi",null,"a"),t("mi",null,"x"),t("munder",null,[t("mo",{"data-mjx-texclass":"OP"},"∏"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"c")])]),t("munder",null,[t("mo",{"data-mjx-texclass":"OP"},"∏"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"o")])]),t("mi",null,"P"),t("mo",{stretchy:"false"},"("),t("mi",null,"o"),t("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|"),t("mi",null,"c"),t("mo",{stretchy:"false"},")")])],-1),C=T("",7),A=t("strong",null,"中心词 c 和上下文词 o 的相似性",-1),j={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},S={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"6.165ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 2725 1000","aria-hidden":"true"},F=T("",1),R=[F],O=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mi",null,"P"),t("mo",{stretchy:"false"},"("),t("mi",null,"o"),t("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|"),t("mi",null,"c"),t("mo",{stretchy:"false"},")")])],-1),P=t("strong",null,"词向量的点积",-1),I={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},B={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"5.87ex",height:"1.359ex",role:"img",focusable:"false",viewBox:"0 -443 2594.6 600.8","aria-hidden":"true"},z=T("",1),N=[z],W=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"u"),t("mi",null,"o")]),t("mo",null,"⋅"),t("msub",null,[t("mi",null,"v"),t("mi",null,"c")])])],-1),J=t("p",null,"使用词向量的点积表示 P (o|c) 的原因：1. 计算简单 2. 出现在一起的词向量意义相关，则希望它们相似",-1),X=t("p",null,[a("又 P (o|c) 是一个概率，所以我们在整个语料库上使用"),t("strong",null," softmax"),a(" 将点积的值映射到概率，如图 6")],-1),q=t("img",{src:"https://ryluo.oss-cn-chengdu.aliyuncs.com/图片6.png"},null,-1),G={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},U={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.978ex",height:"1.359ex",role:"img",focusable:"false",viewBox:"0 -443 874.2 600.8","aria-hidden":"true"},K=T("",1),$=[K],Y=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"v"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"c")])])])],-1),t1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},a1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.258ex",height:"1.357ex",role:"img",focusable:"false",viewBox:"0 -442 997.9 599.8","aria-hidden":"true"},T1=T("",1),Q1=[T1],s1=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"u"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"o")])])])],-1),e1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},l1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.431ex",height:"1.359ex",role:"img",focusable:"false",viewBox:"0 -443 1074.3 600.8","aria-hidden":"true"},n1=T("",1),o1=[n1],r1=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"v"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"w")])])])],-1),d1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},m1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.627ex",height:"1.357ex",role:"img",focusable:"false",viewBox:"0 -442 1161.3 599.8","aria-hidden":"true"},i1=T("",1),p1=[i1],c1=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"u"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"w")])])])],-1),h1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},g1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.431ex",height:"1.359ex",role:"img",focusable:"false",viewBox:"0 -443 1074.3 600.8","aria-hidden":"true"},u1=T("",1),w1=[u1],y1=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"v"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"w")])])])],-1),x1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},H1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.627ex",height:"1.357ex",role:"img",focusable:"false",viewBox:"0 -442 1161.3 599.8","aria-hidden":"true"},_1=T("",1),f1=[_1],k1=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"u"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"w")])])])],-1),b1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},M1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"26.438ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 11685.8 1000","aria-hidden":"true"},L1=T("",1),v1=[L1],Z1=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mi",null,"P"),t("mo",{stretchy:"false"},"("),t("mi",null,"o"),t("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|"),t("mi",null,"c"),t("mo",{stretchy:"false"},")"),t("mo",null,"="),t("mi",null,"s"),t("mi",null,"o"),t("mi",null,"f"),t("mi",null,"t"),t("mi",null,"m"),t("mi",null,"a"),t("mi",null,"x"),t("mo",{stretchy:"false"},"("),t("msub",null,[t("mi",null,"u"),t("mrow",{"data-mjx-texclass":"ORD"},[t("msup",null,[t("mi",null,"o"),t("mi",null,"T")])])]),t("mo",null,"⋅"),t("msub",null,[t("mi",null,"v"),t("mi",null,"c")]),t("mo",{stretchy:"false"},")")])],-1),E1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},D1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.258ex",height:"1.357ex",role:"img",focusable:"false",viewBox:"0 -442 997.9 599.8","aria-hidden":"true"},V1=T("",1),C1=[V1],A1=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"u"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"o")])])])],-1),j1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},S1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.978ex",height:"1.359ex",role:"img",focusable:"false",viewBox:"0 -443 874.2 600.8","aria-hidden":"true"},F1=T("",1),R1=[F1],O1=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"v"),t("mi",null,"c")])])],-1),P1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},I1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.258ex",height:"1.357ex",role:"img",focusable:"false",viewBox:"0 -442 997.9 599.8","aria-hidden":"true"},B1=T("",1),z1=[B1],N1=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"u"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"o")])])])],-1),W1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},J1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.978ex",height:"1.359ex",role:"img",focusable:"false",viewBox:"0 -443 874.2 600.8","aria-hidden":"true"},X1=T("",1),q1=[X1],G1=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"v"),t("mi",null,"c")])])],-1),U1=t("h2",{id:"word2vec模型结构",tabindex:"-1"},[a("Word2vec 模型结构 "),t("a",{class:"header-anchor",href:"#word2vec模型结构","aria-label":'Permalink to "Word2vec模型结构"'},"​")],-1),K1=t("img",{src:"https://ryluo.oss-cn-chengdu.aliyuncs.com/图片8.png"},null,-1),$1=t("p",null,[a("如图八所示，这是一个输入为 1 X V 维的 one-hot 向量（V 为整个词汇表的长度，这个向量只有一个 1 值，其余为 0 值表示一个词），单隐藏层（"),t("strong",null,"隐藏层的维度为 N，这里是一个超参数，这个参数由我们定义，也就是词向量的维度"),a("），输出为 1 X V 维的 softmax 层的模型。")],-1),Y1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},t2={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.05ex"},xmlns:"http://www.w3.org/2000/svg",width:"3.49ex",height:"1.964ex",role:"img",focusable:"false",viewBox:"0 -846 1542.6 868","aria-hidden":"true"},a2=T("",1),T2=[a2],Q2=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msup",null,[t("mi",null,"W"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"I")])])])],-1),s2={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},e2={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.05ex"},xmlns:"http://www.w3.org/2000/svg",width:"3.904ex",height:"1.997ex",role:"img",focusable:"false",viewBox:"0 -860.8 1725.7 882.8","aria-hidden":"true"},l2=T("",1),n2=[l2],o2=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msup",null,[t("mi",null,"W"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"O")])])])],-1),r2={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},d2={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.05ex"},xmlns:"http://www.w3.org/2000/svg",width:"3.49ex",height:"1.964ex",role:"img",focusable:"false",viewBox:"0 -846 1542.6 868","aria-hidden":"true"},m2=T("",1),i2=[m2],p2=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msup",null,[t("mi",null,"W"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"I")])])])],-1),c2=t("p",null,"我们这里，考虑 Skip-gram 算法，输入为中心词 c 的 one-hot 表示",-1),h2={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},g2={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.05ex"},xmlns:"http://www.w3.org/2000/svg",width:"3.49ex",height:"1.964ex",role:"img",focusable:"false",viewBox:"0 -846 1542.6 868","aria-hidden":"true"},u2=T("",1),w2=[u2],y2=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msup",null,[t("mi",null,"W"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"I")])])])],-1),x2={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},H2={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.05ex"},xmlns:"http://www.w3.org/2000/svg",width:"3.49ex",height:"1.964ex",role:"img",focusable:"false",viewBox:"0 -846 1542.6 868","aria-hidden":"true"},_2=T("",1),f2=[_2],k2=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msup",null,[t("mi",null,"W"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"I")])])])],-1),b2={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},M2={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.978ex",height:"1.359ex",role:"img",focusable:"false",viewBox:"0 -443 874.2 600.8","aria-hidden":"true"},L2=T("",1),v2=[L2],Z2=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"v"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"c")])])])],-1),E2={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},D2={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.05ex"},xmlns:"http://www.w3.org/2000/svg",width:"3.904ex",height:"1.997ex",role:"img",focusable:"false",viewBox:"0 -860.8 1725.7 882.8","aria-hidden":"true"},V2=T("",1),C2=[V2],A2=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msup",null,[t("mi",null,"W"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"O")])])])],-1),j2={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},S2={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.05ex"},xmlns:"http://www.w3.org/2000/svg",width:"3.904ex",height:"1.997ex",role:"img",focusable:"false",viewBox:"0 -860.8 1725.7 882.8","aria-hidden":"true"},F2=T("",1),R2=[F2],O2=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msup",null,[t("mi",null,"W"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"O")])])])],-1),P2={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},I2={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.446ex"},xmlns:"http://www.w3.org/2000/svg",width:"7.169ex",height:"1.448ex",role:"img",focusable:"false",viewBox:"0 -443 3168.6 640","aria-hidden":"true"},B2=T("",1),z2=[B2],N2=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"u"),t("mrow",{"data-mjx-texclass":"ORD"},[t("msup",null,[t("mi",null,"w"),t("mi",null,"T")])])]),t("mo",null,"⋅"),t("msub",null,[t("mi",null,"v"),t("mi",null,"c")])])],-1),W2={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},J2={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"6.688ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 2956 1000","aria-hidden":"true"},X2=T("",1),q2=[X2],G2=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mi",null,"P"),t("mo",{stretchy:"false"},"("),t("mi",null,"w"),t("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|"),t("mi",null,"c"),t("mo",{stretchy:"false"},")")])],-1),U2=t("p",null,"有 V 个 w, 其中的 P (o|c) 即实际样本中的上下文词的概率，为我们最为关注的值。",-1),K2=t("h2",{id:"cbow",tabindex:"-1"},[a("CBOW "),t("a",{class:"header-anchor",href:"#cbow","aria-label":'Permalink to "CBOW"'},"​")],-1),$2=t("p",null,"如上文所述，Skip-gram 为给定中心词，预测周围的词，即求 P (o|c)，如下图所示：",-1),Y2=t("img",{src:"https://ryluo.oss-cn-chengdu.aliyuncs.com/图片image-20220424105817437.png"},null,-1),t3=t("p",null,"而 CBOW 为给定周围的词，预测中心词，即求 P (c|o), 如下图所示：",-1),a3=t("img",{src:"https://ryluo.oss-cn-chengdu.aliyuncs.com/图片10.png"},null,-1),T3=t("strong",null,"将这多个上下文词经过第一个参数矩阵的计算得到的词向量相加作为隐藏单元的值",-1),Q3={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},s3={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.05ex"},xmlns:"http://www.w3.org/2000/svg",width:"3.904ex",height:"1.997ex",role:"img",focusable:"false",viewBox:"0 -860.8 1725.7 882.8","aria-hidden":"true"},e3=T("",1),l3=[e3],n3=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msup",null,[t("mi",null,"W"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"O")])])])],-1),o3=t("h1",{id:"负采样-negative-sampling",tabindex:"-1"},[a("负采样 Negative Sampling "),t("a",{class:"header-anchor",href:"#负采样-negative-sampling","aria-label":'Permalink to "负采样 Negative Sampling"'},"​")],-1),r3=t("h2",{id:"softmax函数带来的问题",tabindex:"-1"},[a("softmax 函数带来的问题 "),t("a",{class:"header-anchor",href:"#softmax函数带来的问题","aria-label":'Permalink to "softmax函数带来的问题"'},"​")],-1),d3={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},m3={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"6.165ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 2725 1000","aria-hidden":"true"},i3=T("",1),p3=[i3],c3=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mi",null,"P"),t("mo",{stretchy:"false"},"("),t("mi",null,"o"),t("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|"),t("mi",null,"c"),t("mo",{stretchy:"false"},")")])],-1),h3=t("img",{src:"https://ryluo.oss-cn-chengdu.aliyuncs.com/图片image-20220424105958191.png"},null,-1),g3={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},u3={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"6.165ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 2725 1000","aria-hidden":"true"},w3=T("",1),y3=[w3],x3=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mi",null,"P"),t("mo",{stretchy:"false"},"("),t("mi",null,"o"),t("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|"),t("mi",null,"c"),t("mo",{stretchy:"false"},")")])],-1),H3=t("p",null,"他提出了两种改进的方法：Hierarchical Softmax 和 Negative Sampling，因为 Negative Sampling 更加常见，所以我们下面只介绍 Negative Sampling，感兴趣的朋友可以在文章下面的参考资料中学习 Hierarchical Softmax。",-1),_3=t("h2",{id:"负采样negative-sampling",tabindex:"-1"},[a("负采样 Negative Sampling "),t("a",{class:"header-anchor",href:"#负采样negative-sampling","aria-label":'Permalink to "负采样Negative Sampling"'},"​")],-1),f3=t("p",null,"我们依然以 Skip-gram 为例（CBOW 与之差别不大，感兴趣的朋友们依然可以参阅参考资料）",-1),k3=t("p",null,"我们首先给出负采样的损失函数：",-1),b3=t("img",{src:"https://ryluo.oss-cn-chengdu.aliyuncs.com/图片12.png"},null,-1),M3={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},L3={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.025ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.292ex",height:"1ex",role:"img",focusable:"false",viewBox:"0 -431 571 442","aria-hidden":"true"},v3=t("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[t("g",{"data-mml-node":"math"},[t("g",{"data-mml-node":"mi"},[t("path",{"data-c":"1D70E",d:"M184 -11Q116 -11 74 34T31 147Q31 247 104 333T274 430Q275 431 414 431H552Q553 430 555 429T559 427T562 425T565 422T567 420T569 416T570 412T571 407T572 401Q572 357 507 357Q500 357 490 357T476 358H416L421 348Q439 310 439 263Q439 153 359 71T184 -11ZM361 278Q361 358 276 358Q152 358 115 184Q114 180 114 178Q106 141 106 117Q106 67 131 47T188 26Q242 26 287 73Q316 103 334 153T356 233T361 278Z",style:{"stroke-width":"3"}})])])],-1),Z3=[v3],E3=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mi",null,"σ")])],-1),D3={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},V3={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"11.321ex",height:"2.32ex",role:"img",focusable:"false",viewBox:"0 -775.2 5004 1025.2","aria-hidden":"true"},C3=T("",1),A3=[C3],j3=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mn",null,"1"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",null,"/")]),t("mo",{stretchy:"false"},"("),t("mn",null,"1"),t("mo",null,"+"),t("msup",null,[t("mi",null,"e"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mo",null,"−"),t("mi",null,"x")])]),t("mo",{stretchy:"false"},")")])],-1),S3={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},F3={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.258ex",height:"1.357ex",role:"img",focusable:"false",viewBox:"0 -442 997.9 599.8","aria-hidden":"true"},R3=T("",1),O3=[R3],P3=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"u"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"o")])])])],-1),I3={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},B3={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.315ex",height:"1.357ex",role:"img",focusable:"false",viewBox:"0 -442 1023.4 599.8","aria-hidden":"true"},z3=T("",1),N3=[z3],W3=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"u"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"k")])])])],-1),J3={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},X3={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.446ex"},xmlns:"http://www.w3.org/2000/svg",width:"6.799ex",height:"1.448ex",role:"img",focusable:"false",viewBox:"0 -443 3005.3 640","aria-hidden":"true"},q3=T("",1),G3=[q3],U3=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"u"),t("mrow",{"data-mjx-texclass":"ORD"},[t("msup",null,[t("mi",null,"o"),t("mi",null,"T")])])]),t("mo",null,"⋅"),t("msub",null,[t("mi",null,"v"),t("mi",null,"c")])])],-1),K3={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},$3={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.446ex"},xmlns:"http://www.w3.org/2000/svg",width:"6.857ex",height:"1.448ex",role:"img",focusable:"false",viewBox:"0 -443 3030.7 640","aria-hidden":"true"},Y3=T("",1),t4=[Y3],a4=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"u"),t("mrow",{"data-mjx-texclass":"ORD"},[t("msup",null,[t("mi",null,"k"),t("mi",null,"T")])])]),t("mo",null,"⋅"),t("msub",null,[t("mi",null,"v"),t("mi",null,"c")])])],-1),T4={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},Q4={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"10.643ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 4704 1000","aria-hidden":"true"},s4=T("",1),e4=[s4],l4=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mi",null,"m"),t("mi",null,"a"),t("mi",null,"x"),t("mi",null,"P"),t("mo",{stretchy:"false"},"("),t("mi",null,"o"),t("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|"),t("mi",null,"c"),t("mo",{stretchy:"false"},")")])],-1),n4=t("h1",{id:"核心代码与核心推导",tabindex:"-1"},[a("核心代码与核心推导 "),t("a",{class:"header-anchor",href:"#核心代码与核心推导","aria-label":'Permalink to "核心代码与核心推导"'},"​")],-1),o4=t("h2",{id:"naive-softmax-损失函数",tabindex:"-1"},[a("Naive softmax 损失函数 "),t("a",{class:"header-anchor",href:"#naive-softmax-损失函数","aria-label":'Permalink to "Naive softmax 损失函数"'},"​")],-1),r4={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},d4={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.978ex",height:"1.359ex",role:"img",focusable:"false",viewBox:"0 -443 874.2 600.8","aria-hidden":"true"},m4=T("",1),i4=[m4],p4=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"v"),t("mi",null,"c")])])],-1),c4={class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},h4={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-2.858ex"},xmlns:"http://www.w3.org/2000/svg",width:"179.683ex",height:"6.848ex",role:"img",focusable:"false",viewBox:"0 -1763.3 79419.9 3026.7","aria-hidden":"true"},g4=T("",1),u4=[g4],w4=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("mfrac",null,[t("mrow",null,[t("mi",null,"∂"),t("mrow",{"data-mjx-texclass":"ORD"},[t("msub",null,[t("mi",null,"J"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"n"),t("mi",null,"a"),t("mi",null,"i"),t("mi",null,"v"),t("mi",null,"e"),t("mo",null,"−"),t("mi",null,"s"),t("mi",null,"o"),t("mi",null,"f"),t("mi",null,"t"),t("mi",null,"m"),t("mi",null,"a"),t("mi",null,"x")])]),t("mo",{stretchy:"false"},"("),t("msub",null,[t("mi",{mathvariant:"bold-italic"},"v"),t("mi",null,"c")]),t("mo",null,","),t("mi",null,"o"),t("mo",null,","),t("mi",{mathvariant:"bold-italic"},"U"),t("mo",{stretchy:"false"},")")])]),t("mrow",null,[t("mi",null,"∂"),t("msub",null,[t("mi",{mathvariant:"bold-italic"},"v"),t("mi",null,"c")])])]),t("mspace",{linebreak:"newline"}),t("mo",null,"="),t("mo",null,"−"),t("mfrac",null,[t("mrow",null,[t("mi",null,"∂"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"l"),t("mi",null,"o"),t("mi",null,"g"),t("mo",{stretchy:"false"},"("),t("mi",null,"P"),t("mo",{stretchy:"false"},"("),t("mi",null,"O"),t("mo",null,"="),t("mi",null,"o"),t("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|"),t("mi",null,"C"),t("mo",null,"="),t("mi",null,"c"),t("mo",{stretchy:"false"},")"),t("mo",{stretchy:"false"},")")])]),t("mrow",null,[t("mi",null,"∂"),t("msub",null,[t("mi",{mathvariant:"bold-italic"},"v"),t("mi",null,"c")])])]),t("mspace",{linebreak:"newline"}),t("mo",null,"="),t("mo",null,"−"),t("mfrac",null,[t("mrow",null,[t("mi",null,"∂"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"l"),t("mi",null,"o"),t("mi",null,"g"),t("mo",{stretchy:"false"},"("),t("mi",null,"e"),t("mi",null,"x"),t("mi",null,"p"),t("mo",{stretchy:"false"},"("),t("msubsup",null,[t("mi",{mathvariant:"bold-italic"},"u"),t("mi",null,"o"),t("mi",null,"T")]),t("msub",null,[t("mi",{mathvariant:"bold-italic"},"v"),t("mi",null,"c")]),t("mo",{stretchy:"false"},")"),t("mo",{stretchy:"false"},")")])]),t("mrow",null,[t("mi",null,"∂"),t("msub",null,[t("mi",{mathvariant:"bold-italic"},"v"),t("mi",null,"c")])])]),t("mo",null,"+"),t("mfrac",null,[t("mrow",null,[t("mi",null,"∂"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"l"),t("mi",null,"o"),t("mi",null,"g"),t("mo",{stretchy:"false"},"("),t("munderover",null,[t("mo",{"data-mjx-texclass":"OP"},"∑"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"w"),t("mo",null,"="),t("mn",null,"1")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"V")])]),t("mi",null,"e"),t("mi",null,"x"),t("mi",null,"p"),t("mo",{stretchy:"false"},"("),t("msubsup",null,[t("mi",{mathvariant:"bold-italic"},"u"),t("mi",null,"w"),t("mi",null,"T")]),t("msub",null,[t("mi",{mathvariant:"bold-italic"},"v"),t("mi",null,"c")]),t("mo",{stretchy:"false"},")"),t("mo",{stretchy:"false"},")")])]),t("mrow",null,[t("mi",null,"∂"),t("msub",null,[t("mi",{mathvariant:"bold-italic"},"v"),t("mi",null,"c")])])]),t("mspace",{linebreak:"newline"}),t("mo",null,"="),t("mo",null,"−"),t("msub",null,[t("mi",{mathvariant:"bold-italic"},"u"),t("mi",null,"o")]),t("mo",null,"+"),t("munderover",null,[t("mo",{"data-mjx-texclass":"OP"},"∑"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"w"),t("mo",null,"="),t("mn",null,"1")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"V")])]),t("mfrac",null,[t("mrow",null,[t("mi",null,"e"),t("mi",null,"x"),t("mi",null,"p"),t("mo",{stretchy:"false"},"("),t("msubsup",null,[t("mi",{mathvariant:"bold-italic"},"u"),t("mi",null,"w"),t("mi",null,"T")]),t("msub",null,[t("mi",{mathvariant:"bold-italic"},"v"),t("mi",null,"c")]),t("mo",{stretchy:"false"},")")]),t("mrow",null,[t("munderover",null,[t("mo",{"data-mjx-texclass":"OP"},"∑"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"w"),t("mo",null,"="),t("mn",null,"1")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"V")])]),t("mi",null,"e"),t("mi",null,"x"),t("mi",null,"p"),t("mo",{stretchy:"false"},"("),t("msubsup",null,[t("mi",{mathvariant:"bold-italic"},"u"),t("mi",null,"w"),t("mi",null,"T")]),t("msub",null,[t("mi",{mathvariant:"bold-italic"},"v"),t("mi",null,"c")]),t("mo",{stretchy:"false"},")")])]),t("msub",null,[t("mi",{mathvariant:"bold-italic"},"u"),t("mi",null,"w")]),t("mspace",{linebreak:"newline"}),t("mo",null,"="),t("mo",null,"−"),t("msub",null,[t("mi",{mathvariant:"bold-italic"},"u"),t("mi",null,"o")]),t("mo",null,"+"),t("munderover",null,[t("mo",{"data-mjx-texclass":"OP"},"∑"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"w"),t("mo",null,"="),t("mn",null,"1")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"V")])]),t("mi",null,"P"),t("mo",{stretchy:"false"},"("),t("mi",null,"O"),t("mo",null,"="),t("mi",null,"w"),t("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|"),t("mi",null,"C"),t("mo",null,"="),t("mi",null,"c"),t("mo",{stretchy:"false"},")"),t("msub",null,[t("mi",{mathvariant:"bold-italic"},"u"),t("mi",null,"w")]),t("mspace",{linebreak:"newline"}),t("mo",null,"="),t("msup",null,[t("mi",{mathvariant:"bold-italic"},"U"),t("mi",null,"T")]),t("mo",{stretchy:"false"},"("),t("mrow",{"data-mjx-texclass":"ORD"},[t("mover",null,[t("mi",{mathvariant:"bold-italic"},"y"),t("mo",{stretchy:"false"},"^")])]),t("mo",null,"−"),t("mi",{mathvariant:"bold-italic"},"y"),t("mo",{stretchy:"false"},")")])],-1),y4={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},x4={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.627ex",height:"1.357ex",role:"img",focusable:"false",viewBox:"0 -442 1161.3 599.8","aria-hidden":"true"},H4=T("",1),_4=[H4],f4=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"u"),t("mi",null,"w")])])],-1),k4=T("",4),b4={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},M4={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.978ex",height:"1.359ex",role:"img",focusable:"false",viewBox:"0 -443 874.2 600.8","aria-hidden":"true"},L4=T("",1),v4=[L4],Z4=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"v"),t("mi",null,"c")])])],-1),E4={class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},D4={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-2.864ex"},xmlns:"http://www.w3.org/2000/svg",width:"169.093ex",height:"6.853ex",role:"img",focusable:"false",viewBox:"0 -1763.3 74739.1 3029.1","aria-hidden":"true"},V4=T("",1),C4=[V4],A4=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("mfrac",null,[t("mrow",null,[t("mi",null,"∂"),t("mrow",{"data-mjx-texclass":"ORD"},[t("msub",null,[t("mi",null,"J"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"n"),t("mi",null,"e"),t("mi",null,"g"),t("mo",null,"−"),t("mi",null,"s"),t("mi",null,"a"),t("mi",null,"m"),t("mi",null,"p"),t("mi",null,"l"),t("mi",null,"e")])]),t("mo",{stretchy:"false"},"("),t("msub",null,[t("mi",{mathvariant:"bold-italic"},"v"),t("mi",null,"c")]),t("mo",null,","),t("mi",null,"o"),t("mo",null,","),t("mi",{mathvariant:"bold-italic"},"U"),t("mo",{stretchy:"false"},")")])]),t("mrow",null,[t("mi",null,"∂"),t("msub",null,[t("mi",{mathvariant:"bold-italic"},"v"),t("mi",null,"c")])])]),t("mspace",{linebreak:"newline"}),t("mo",null,"="),t("mfrac",null,[t("mrow",null,[t("mi",null,"∂"),t("mo",{stretchy:"false"},"("),t("mo",null,"−"),t("mi",null,"l"),t("mi",null,"o"),t("mi",null,"g"),t("mo",{stretchy:"false"},"("),t("mi",null,"σ"),t("mo",{stretchy:"false"},"("),t("msubsup",null,[t("mi",{mathvariant:"bold-italic"},"u"),t("mi",null,"o"),t("mi",null,"T")]),t("msub",null,[t("mi",{mathvariant:"bold-italic"},"v"),t("mi",null,"c")]),t("mo",{stretchy:"false"},")"),t("mo",{stretchy:"false"},")"),t("mo",null,"−"),t("munderover",null,[t("mo",{"data-mjx-texclass":"OP"},"∑"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"k"),t("mo",null,"="),t("mn",null,"1")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"K")])]),t("mi",null,"l"),t("mi",null,"o"),t("mi",null,"g"),t("mo",{stretchy:"false"},"("),t("mi",null,"σ"),t("mo",{stretchy:"false"},"("),t("mo",null,"−"),t("msubsup",null,[t("mi",{mathvariant:"bold-italic"},"u"),t("mi",null,"k"),t("mi",null,"T")]),t("msub",null,[t("mi",{mathvariant:"bold-italic"},"v"),t("mi",null,"c")]),t("mo",{stretchy:"false"},")"),t("mo",{stretchy:"false"},")"),t("mo",{stretchy:"false"},")")]),t("mrow",null,[t("mi",null,"∂"),t("msub",null,[t("mi",{mathvariant:"bold-italic"},"v"),t("mi",null,"c")])])]),t("mspace",{linebreak:"newline"}),t("mo",null,"="),t("mo",null,"−"),t("mfrac",null,[t("mrow",null,[t("mi",null,"σ"),t("mo",{stretchy:"false"},"("),t("msubsup",null,[t("mi",{mathvariant:"bold-italic"},"u"),t("mi",null,"o"),t("mi",null,"T")]),t("msub",null,[t("mi",{mathvariant:"bold-italic"},"v"),t("mi",null,"c")]),t("mo",{stretchy:"false"},")"),t("mo",{stretchy:"false"},"("),t("mn",null,"1"),t("mo",null,"−"),t("mi",null,"σ"),t("mo",{stretchy:"false"},"("),t("msubsup",null,[t("mi",{mathvariant:"bold-italic"},"u"),t("mi",null,"o"),t("mi",null,"T")]),t("msub",null,[t("mi",{mathvariant:"bold-italic"},"v"),t("mi",null,"c")]),t("mo",{stretchy:"false"},")"),t("mo",{stretchy:"false"},")")]),t("mrow",null,[t("mi",null,"σ"),t("mo",{stretchy:"false"},"("),t("msubsup",null,[t("mi",{mathvariant:"bold-italic"},"u"),t("mi",null,"o"),t("mi",null,"T")]),t("msub",null,[t("mi",{mathvariant:"bold-italic"},"v"),t("mi",null,"c")]),t("mo",{stretchy:"false"},")")])]),t("mfrac",null,[t("mrow",null,[t("mi",null,"∂"),t("msubsup",null,[t("mi",{mathvariant:"bold-italic"},"u"),t("mi",null,"o"),t("mi",null,"T")]),t("msub",null,[t("mi",{mathvariant:"bold-italic"},"v"),t("mi",null,"c")])]),t("mrow",null,[t("mi",null,"∂"),t("msub",null,[t("mi",{mathvariant:"bold-italic"},"v"),t("mi",null,"c")])])]),t("mo",null,"−"),t("munderover",null,[t("mo",{"data-mjx-texclass":"OP"},"∑"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"k"),t("mo",null,"="),t("mn",null,"1")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"K")])]),t("mfrac",null,[t("mrow",null,[t("mi",null,"∂"),t("mi",null,"l"),t("mi",null,"o"),t("mi",null,"g"),t("mo",{stretchy:"false"},"("),t("mi",null,"σ"),t("mo",{stretchy:"false"},"("),t("mo",null,"−"),t("msubsup",null,[t("mi",{mathvariant:"bold-italic"},"u"),t("mi",null,"k"),t("mi",null,"T")]),t("msub",null,[t("mi",{mathvariant:"bold-italic"},"v"),t("mi",null,"c")]),t("mo",{stretchy:"false"},")"),t("mo",{stretchy:"false"},")")]),t("mrow",null,[t("mi",null,"∂"),t("msub",null,[t("mi",{mathvariant:"bold-italic"},"v"),t("mi",null,"c")])])]),t("mspace",{linebreak:"newline"}),t("mo",null,"="),t("mo",null,"−"),t("mo",{stretchy:"false"},"("),t("mn",null,"1"),t("mo",null,"−"),t("mi",null,"σ"),t("mo",{stretchy:"false"},"("),t("msubsup",null,[t("mi",{mathvariant:"bold-italic"},"u"),t("mi",null,"o"),t("mi",null,"T")]),t("msub",null,[t("mi",{mathvariant:"bold-italic"},"v"),t("mi",null,"c")]),t("mo",{stretchy:"false"},")"),t("mo",{stretchy:"false"},")"),t("msub",null,[t("mi",{mathvariant:"bold-italic"},"u"),t("mi",null,"o")]),t("mo",null,"+"),t("munderover",null,[t("mo",{"data-mjx-texclass":"OP"},"∑"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"k"),t("mo",null,"="),t("mn",null,"1")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"K")])]),t("mo",{stretchy:"false"},"("),t("mn",null,"1"),t("mo",null,"−"),t("mi",null,"σ"),t("mo",{stretchy:"false"},"("),t("mo",null,"−"),t("msubsup",null,[t("mi",{mathvariant:"bold-italic"},"u"),t("mi",null,"k"),t("mi",null,"T")]),t("msub",null,[t("mi",{mathvariant:"bold-italic"},"v"),t("mi",null,"c")]),t("mo",{stretchy:"false"},")"),t("mo",{stretchy:"false"},")"),t("msub",null,[t("mi",{mathvariant:"bold-italic"},"u"),t("mi",null,"k")])])],-1),j4={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},S4={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.315ex",height:"1.357ex",role:"img",focusable:"false",viewBox:"0 -442 1023.4 599.8","aria-hidden":"true"},F4=T("",1),R4=[F4],O4=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"u"),t("mi",null,"k")])])],-1),P4={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},I4={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.258ex",height:"1.357ex",role:"img",focusable:"false",viewBox:"0 -442 997.9 599.8","aria-hidden":"true"},B4=T("",1),z4=[B4],N4=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"u"),t("mi",null,"o")])])],-1),W4=T("",4);function J4(X4,q4,G4,U4,K4,$4){return Q(),s("div",null,[n,t("p",null,[a("很自然地，我们需要"),o,a("，我们想到用条件概率"),t("mjx-container",r,[(Q(),s("svg",d,i)),p]),a(" 表示 “给定中心词 c, 它的上下文词 o 在它周围出现了”")]),t("p",null,[a("下图展示了以 “into” 为中心词，窗口大小为 2 的情况下它的上下文词。以及相对应的"),t("mjx-container",c,[(Q(),s("svg",h,u)),w])]),y,x,H,t("p",null,[a("那么，如果我们在整个语料库上不断地滑动窗口，我们可以得到所有位置的"),t("mjx-container",_,[(Q(),s("svg",f,b)),M]),a("，我们希望在所有位置上"),L,a("，由极大似然法，可得：")]),t("mjx-container",v,[(Q(),s("svg",Z,D)),V]),C,t("p",null,[a("回答 1：我们使用"),A,a("来计算"),t("mjx-container",j,[(Q(),s("svg",S,R)),O]),a("，更具体地，相似性由"),P,a("表示："),t("mjx-container",I,[(Q(),s("svg",B,N)),W]),a("。")]),J,X,q,t("p",null,[a("注：注意到上图，中心词词向量为"),t("mjx-container",G,[(Q(),s("svg",U,$)),Y]),a(", 而上下文词词向量为"),t("mjx-container",t1,[(Q(),s("svg",a1,Q1)),s1]),a("。也就是说每个词会对应两个词向量，"),t("strong",null,[a("在词 w 做中心词时，使用"),t("mjx-container",e1,[(Q(),s("svg",l1,o1)),r1]),a(" 作为词向量，而在它做上下文词时，使用"),t("mjx-container",d1,[(Q(),s("svg",m1,p1)),c1]),a(" 作为词向量")]),a("。这样做的原因是为了求导等操作时计算上的简便。当整个模型训练完成后，我们既可以使用"),t("mjx-container",h1,[(Q(),s("svg",g1,w1)),y1]),a(" 作为词 w 的词向量，也可以使用"),t("mjx-container",x1,[(Q(),s("svg",H1,f1)),k1]),a(" 作为词 w 的词向量，亦或是将二者平均。在下一部分的模型结构中，我们将更清楚地看到两个词向量究竟在模型的哪个位置。")]),t("p",null,[a("回答 2：由上文所述，"),t("mjx-container",b1,[(Q(),s("svg",M1,v1)),Z1]),a("。所以损失函数是关于"),t("mjx-container",E1,[(Q(),s("svg",D1,C1)),A1]),a(" 和"),t("mjx-container",j1,[(Q(),s("svg",S1,R1)),O1]),a(" 的函数，我们通过梯度下降法调整"),t("mjx-container",P1,[(Q(),s("svg",I1,z1)),N1]),a(" 和"),t("mjx-container",W1,[(Q(),s("svg",J1,q1)),G1]),a(" 的值，最小化损失函数，即得到了良好表示的词向量。")]),U1,K1,$1,t("p",null,[t("mjx-container",Y1,[(Q(),s("svg",t2,T2)),Q2]),a(" 为 V X N 的参数矩阵，"),t("mjx-container",s2,[(Q(),s("svg",e2,n2)),o2]),a(" 为 N X V 的参数矩阵。")]),t("p",null,[a("模型的输入为 1 X V 形状的 one-hot 向量（V 为整个词汇表的长度，这个向量只有一个 1 值，其余为 0 值表示一个词）。隐藏层的维度为 N，这里是一个超参数，这个参数由我们定义，也就是词向量的维度。"),t("mjx-container",r2,[(Q(),s("svg",d2,i2)),p2]),a(" 为 V X N 的参数矩阵。")]),c2,t("p",null,[a("由输入层到隐藏层，根据矩阵乘法规则，可知，"),t("strong",null,[t("mjx-container",h2,[(Q(),s("svg",g2,w2)),y2]),a(" 的每一行即为词汇表中的每一个单词的词向量 v")]),a(",1 X V 的 inputs 乘上 V X N 的"),t("mjx-container",x2,[(Q(),s("svg",H2,f2)),k2]),a("，隐藏层即为 1 X N 维的"),t("mjx-container",b2,[(Q(),s("svg",M2,v2)),Z2]),a("。")]),t("p",null,[a("而"),t("mjx-container",E2,[(Q(),s("svg",D2,C2)),A2]),a(" 中的每一列即为词汇表中的每一个单词的词向量 u。根据乘法规则，1 X N 的隐藏层乘上 N X V 的"),t("mjx-container",j2,[(Q(),s("svg",S2,R2)),O2]),a(" 参数矩阵，得到的 1 X V 的输出层的每一个值即为"),t("mjx-container",P2,[(Q(),s("svg",I2,z2)),N2]),a(", 加上 softmax 变化即为"),t("mjx-container",W2,[(Q(),s("svg",J2,q2)),G2]),a("。")]),U2,K2,$2,Y2,t3,a3,t("p",null,[a("注意：在使用 CBOW 时，上文所给出的模型结构并没有变，在这里，我们输入多个上下文词 o，在隐藏层，"),T3,a("。其余均不变，"),t("mjx-container",Q3,[(Q(),s("svg",s3,l3)),n3]),a(" 中的每一列依然为为词汇表中的每一个单词的词向量 u。")]),o3,r3,t("p",null,[a("我们再看一眼，通过 softmax 得到的"),t("mjx-container",d3,[(Q(),s("svg",m3,p3)),c3]),a("，如图：")]),h3,t("p",null,[a("可以看到，"),t("mjx-container",g3,[(Q(),s("svg",u3,y3)),x3]),a(" 的分母需要在整个单词表上做乘积和 exp 运算，这无疑是非常消耗计算资源的，Word2vec 的作者针对这个问题，做出了改进。")]),H3,_3,f3,k3,b3,t("p",null,[a("其中"),t("mjx-container",M3,[(Q(),s("svg",L3,Z3)),E3]),a(" 为 sigmoid 函数"),t("mjx-container",D3,[(Q(),s("svg",V3,A3)),j3]),a(", "),t("mjx-container",S3,[(Q(),s("svg",F3,O3)),P3]),a(" 为实际样本中的上下文词的词向量，而"),t("mjx-container",I3,[(Q(),s("svg",B3,N3)),W3]),a(" 为我们在单词表中随机选出（按一定的规则随机选出，具体可参阅参考资料）的 K 个单词。")]),t("p",null,[a("由函数单调性易知，"),t("strong",null,[t("mjx-container",J3,[(Q(),s("svg",X3,G3)),U3]),a(" 越大，损失函数越小，而"),t("mjx-container",K3,[(Q(),s("svg",$3,t4)),a4]),a(" 越小")]),a("，损失函数越大。这与原始的 softmax 损失函数优化目标一致，即"),t("mjx-container",T4,[(Q(),s("svg",Q4,e4)),l4]),a("，而且避免了在整个词汇表上的计算。")]),n4,o4,t("p",null,[a("损失函数关于"),t("mjx-container",r4,[(Q(),s("svg",d4,i4)),p4]),a(" 的导数：")]),t("mjx-container",c4,[(Q(),s("svg",h4,u4)),w4]),t("p",null,[a("可以看到涉及整个 U 矩阵的计算，计算量很大，关于"),t("mjx-container",y4,[(Q(),s("svg",x4,_4)),f4]),a(" 的导数读者可自行推导")]),k4,t("p",null,[a("负采样损失函数关于"),t("mjx-container",b4,[(Q(),s("svg",M4,v4)),Z4]),a(" 的导数：")]),t("mjx-container",E4,[(Q(),s("svg",D4,C4)),A4]),t("p",null,[a("可以看到其只与"),t("mjx-container",j4,[(Q(),s("svg",S4,R4)),O4]),a(" 和"),t("mjx-container",P4,[(Q(),s("svg",I4,z4)),N4]),a(" 有关，避免了在整个单词表上的计算")]),W4])}const a6=e(l,[["render",J4]]);export{t6 as __pageData,a6 as default};
