import{_ as e,o as Q,c as T,j as t,a,U as s}from"./chunks/framework.489e5108.js";const e4=JSON.parse('{"title":"NFM","description":"","frontmatter":{},"headers":[],"relativePath":"4.人工智能/ch02/ch2.2/ch2.2.3/NFM.md","filePath":"4.人工智能/ch02/ch2.2/ch2.2.3/NFM.md","lastUpdated":1696176798000}'),l={name:"4.人工智能/ch02/ch2.2/ch2.2.3/NFM.md"},n=t("h1",{id:"nfm",tabindex:"-1"},[a("NFM "),t("a",{class:"header-anchor",href:"#nfm","aria-label":'Permalink to "NFM"'},"​")],-1),o=t("h2",{id:"动机",tabindex:"-1"},[a("动机 "),t("a",{class:"header-anchor",href:"#动机","aria-label":'Permalink to "动机"'},"​")],-1),m=t("p",null,"NFM (Neural Factorization Machines) 是 2017 年由新加坡国立大学的何向南教授等人在 SIGIR 会议上提出的一个模型，传统的 FM 模型仅局限于线性表达和二阶交互， 无法胜任生活中各种具有复杂结构和规律性的真实数据， 针对 FM 的这点不足， 作者提出了一种将 FM 融合进 DNN 的策略，通过引进了一个特征交叉池化层的结构，使得 FM 与 DNN 进行了完美衔接，这样就组合了 FM 的建模低阶特征交互能力和 DNN 学习高阶特征交互和非线性的能力，形成了深度学习时代的神经 FM 模型 (NFM)。",-1),d=t("p",null,"那么 NFM 具体是怎么做的呢？ 首先看一下 NFM 的公式：",-1),r={class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},i={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-2.819ex"},xmlns:"http://www.w3.org/2000/svg",width:"32.302ex",height:"6.354ex",role:"img",focusable:"false",viewBox:"0 -1562.5 14277.3 2808.5","aria-hidden":"true"},p=s("",1),c=[p],h=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mover",null,[t("mi",null,"y"),t("mo",{stretchy:"false"},"^")])]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"N"),t("mi",null,"F"),t("mi",null,"M")])]),t("mo",{stretchy:"false"},"("),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"x")]),t("mo",{stretchy:"false"},")"),t("mo",null,"="),t("msub",null,[t("mi",null,"w"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mn",null,"0")])]),t("mo",null,"+"),t("munderover",null,[t("mo",{"data-mjx-texclass":"OP"},"∑"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mo",null,"="),t("mn",null,"1")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"n")])]),t("msub",null,[t("mi",null,"w"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i")])]),t("msub",null,[t("mi",null,"x"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i")])]),t("mo",null,"+"),t("mi",null,"f"),t("mo",{stretchy:"false"},"("),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"x")]),t("mo",{stretchy:"false"},")")])],-1),g=t("p",null,[a("我们对比 FM， 就会发现变化的是第三项，前两项还是原来的， 因为我们说 FM 的一个问题，就是只能到二阶交叉， 且是线性模型， 这是他本身的一个局限性， 而如果想突破这个局限性， 就需要从他的公式本身下点功夫， 于是乎，作者在这里改进的思路就是"),t("strong",null,"用一个表达能力更强的函数来替代原 FM 中二阶隐向量内积的部分"),a("。")],-1),x=t("div",{align:"center"},[t("img",{src:"https://ryluo.oss-cn-chengdu.aliyuncs.com/图片1.png",style:{zoom:"70%"}})],-1),H=t("div",{align:"center"},[t("img",{src:"https://ryluo.oss-cn-chengdu.aliyuncs.com/图片2.png",style:{zoom:"80%"}})],-1),u=t("h2",{id:"模型结构与原理",tabindex:"-1"},[a("模型结构与原理 "),t("a",{class:"header-anchor",href:"#模型结构与原理","aria-label":'Permalink to "模型结构与原理"'},"​")],-1),w=t("h3",{id:"input-和embedding层",tabindex:"-1"},[a("Input 和 Embedding 层 "),t("a",{class:"header-anchor",href:"#input-和embedding层","aria-label":'Permalink to "Input 和Embedding层"'},"​")],-1),_={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},y={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.339ex"},xmlns:"http://www.w3.org/2000/svg",width:"7.492ex",height:"2.271ex",role:"img",focusable:"false",viewBox:"0 -853.7 3311.5 1003.7","aria-hidden":"true"},L=s("",1),M=[L],f=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"v")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"i")])])]),t("mo",null,"∈"),t("msup",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"double-struck"},"R")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"k")])])])],-1),b={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},D={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.025ex"},xmlns:"http://www.w3.org/2000/svg",width:"0.781ex",height:"1.52ex",role:"img",focusable:"false",viewBox:"0 -661 345 672","aria-hidden":"true"},k=t("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[t("g",{"data-mml-node":"math"},[t("g",{"data-mml-node":"mi"},[t("path",{"data-c":"1D456",d:"M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z",style:{"stroke-width":"3"}})])])],-1),V=[k],Z=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mi",null,"i")])],-1),j={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},v={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"22.416ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 9907.7 1000","aria-hidden":"true"},E=s("",1),O=[E],R=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{"data-mjx-variant":"-tex-calligraphic",mathvariant:"script"},"V")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"x")])]),t("mo",null,"="),t("mrow",{"data-mjx-texclass":"INNER"},[t("mo",{"data-mjx-texclass":"OPEN"},"{"),t("msub",null,[t("mi",null,"x"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mn",null,"1")])]),t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"v")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mn",null,"1")])]),t("mo",null,","),t("mo",null,"…"),t("mo",null,","),t("msub",null,[t("mi",null,"x"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"n")])]),t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"v")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"n")])]),t("mo",{"data-mjx-texclass":"CLOSE"},"}")])])],-1),A={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},N={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.034ex",height:"1.357ex",role:"img",focusable:"false",viewBox:"0 -442 899 599.8","aria-hidden":"true"},F=s("",1),C=[F],X=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"x"),t("mi",null,"i")])])],-1),S={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},B={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.034ex",height:"1.357ex",role:"img",focusable:"false",viewBox:"0 -442 899 599.8","aria-hidden":"true"},P=s("",1),I=[P],z=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"x"),t("mi",null,"i")])])],-1),G={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},J={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"6.133ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 2710.9 1000","aria-hidden":"true"},q=s("",1),$=[q],W=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mo",{fence:"false",stretchy:"false"},"{"),t("msub",null,[t("mi",null,"x"),t("mi",null,"i")]),t("msub",null,[t("mi",null,"v"),t("mi",null,"i")]),t("mo",{fence:"false",stretchy:"false"},"}")])],-1),U={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},K={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.034ex",height:"1.357ex",role:"img",focusable:"false",viewBox:"0 -442 899 599.8","aria-hidden":"true"},Y=s("",1),t1=[Y],a1=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"x"),t("mi",null,"i")])])],-1),Q1=t("h3",{id:"bi-interaction-pooling-layer",tabindex:"-1"},[a("Bi-Interaction Pooling layer "),t("a",{class:"header-anchor",href:"#bi-interaction-pooling-layer","aria-label":'Permalink to "Bi-Interaction Pooling layer"'},"​")],-1),T1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},s1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.49ex",height:"1.902ex",role:"img",focusable:"false",viewBox:"0 -683 1100.5 840.8","aria-hidden":"true"},e1=s("",1),l1=[e1],n1=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{"data-mjx-variant":"-tex-calligraphic",mathvariant:"script"},"V")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"x")])])])],-1),o1={class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},m1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-3.014ex"},xmlns:"http://www.w3.org/2000/svg",width:"30.756ex",height:"6.549ex",role:"img",focusable:"false",viewBox:"0 -1562.5 13594.2 2894.7","aria-hidden":"true"},d1=s("",1),r1=[d1],i1=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("msub",null,[t("mi",null,"f"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"B"),t("mi",null,"I")])]),t("mrow",{"data-mjx-texclass":"INNER"},[t("mo",{"data-mjx-texclass":"OPEN"},"("),t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{"data-mjx-variant":"-tex-calligraphic",mathvariant:"script"},"V")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"x")])]),t("mo",{"data-mjx-texclass":"CLOSE"},")")]),t("mo",null,"="),t("munderover",null,[t("mo",{"data-mjx-texclass":"OP"},"∑"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mo",null,"="),t("mn",null,"1")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"n")])]),t("munderover",null,[t("mo",{"data-mjx-texclass":"OP"},"∑"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"j"),t("mo",null,"="),t("mi",null,"i"),t("mo",null,"+"),t("mn",null,"1")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"n")])]),t("msub",null,[t("mi",null,"x"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i")])]),t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"v")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i")])]),t("mo",null,"⊙"),t("msub",null,[t("mi",null,"x"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"j")])]),t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"v")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"j")])])])],-1),p1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},c1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.188ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.76ex",height:"1.507ex",role:"img",focusable:"false",viewBox:"0 -583 778 666","aria-hidden":"true"},h1=t("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[t("g",{"data-mml-node":"math"},[t("g",{"data-mml-node":"mo"},[t("path",{"data-c":"2299",d:"M56 250Q56 394 156 488T384 583Q530 583 626 485T722 250Q722 110 625 14T390 -83Q249 -83 153 14T56 250ZM682 250Q682 322 649 387T546 497T381 542Q272 542 184 459T95 250Q95 132 178 45T389 -42Q515 -42 598 45T682 250ZM311 250Q311 285 332 304T375 328Q376 328 382 328T392 329Q424 326 445 305T466 250Q466 217 445 195T389 172Q354 172 333 195T311 250Z",style:{"stroke-width":"3"}})])])],-1),g1=[h1],x1=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mo",null,"⊙")])],-1),H1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},u1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.025ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.179ex",height:"1.595ex",role:"img",focusable:"false",viewBox:"0 -694 521 705","aria-hidden":"true"},w1=t("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[t("g",{"data-mml-node":"math"},[t("g",{"data-mml-node":"mi"},[t("path",{"data-c":"1D458",d:"M121 647Q121 657 125 670T137 683Q138 683 209 688T282 694Q294 694 294 686Q294 679 244 477Q194 279 194 272Q213 282 223 291Q247 309 292 354T362 415Q402 442 438 442Q468 442 485 423T503 369Q503 344 496 327T477 302T456 291T438 288Q418 288 406 299T394 328Q394 353 410 369T442 390L458 393Q446 405 434 405H430Q398 402 367 380T294 316T228 255Q230 254 243 252T267 246T293 238T320 224T342 206T359 180T365 147Q365 130 360 106T354 66Q354 26 381 26Q429 26 459 145Q461 153 479 153H483Q499 153 499 144Q499 139 496 130Q455 -11 378 -11Q333 -11 305 15T277 90Q277 108 280 121T283 145Q283 167 269 183T234 206T200 217T182 220H180Q168 178 159 139T145 81T136 44T129 20T122 7T111 -2Q98 -11 83 -11Q66 -11 57 -1T48 16Q48 26 85 176T158 471L195 616Q196 629 188 632T149 637H144Q134 637 131 637T124 640T121 647Z",style:{"stroke-width":"3"}})])])],-1),_1=[w1],y1=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mi",null,"k")])],-1),L1={class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},M1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.763ex"},xmlns:"http://www.w3.org/2000/svg",width:"18.165ex",height:"2.46ex",role:"img",focusable:"false",viewBox:"0 -750 8028.8 1087.4","aria-hidden":"true"},f1=s("",1),b1=[f1],D1=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("msub",null,[t("mrow",{"data-mjx-texclass":"INNER"},[t("mo",{"data-mjx-texclass":"OPEN"},"("),t("msub",null,[t("mi",null,"v"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i")])]),t("mo",null,"⊙"),t("msub",null,[t("mi",null,"v"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"j")])]),t("mo",{"data-mjx-texclass":"CLOSE"},")")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"k")])]),t("mo",null,"="),t("msub",null,[t("mi",{mathvariant:"bold-italic"},"v"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mi",null,"k")])]),t("msub",null,[t("mi",{mathvariant:"bold-italic"},"v"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"j"),t("mi",null,"k")])])])],-1),k1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},V1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.025ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.179ex",height:"1.595ex",role:"img",focusable:"false",viewBox:"0 -694 521 705","aria-hidden":"true"},Z1=t("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[t("g",{"data-mml-node":"math"},[t("g",{"data-mml-node":"mi"},[t("path",{"data-c":"1D458",d:"M121 647Q121 657 125 670T137 683Q138 683 209 688T282 694Q294 694 294 686Q294 679 244 477Q194 279 194 272Q213 282 223 291Q247 309 292 354T362 415Q402 442 438 442Q468 442 485 423T503 369Q503 344 496 327T477 302T456 291T438 288Q418 288 406 299T394 328Q394 353 410 369T442 390L458 393Q446 405 434 405H430Q398 402 367 380T294 316T228 255Q230 254 243 252T267 246T293 238T320 224T342 206T359 180T365 147Q365 130 360 106T354 66Q354 26 381 26Q429 26 459 145Q461 153 479 153H483Q499 153 499 144Q499 139 496 130Q455 -11 378 -11Q333 -11 305 15T277 90Q277 108 280 121T283 145Q283 167 269 183T234 206T200 217T182 220H180Q168 178 159 139T145 81T136 44T129 20T122 7T111 -2Q98 -11 83 -11Q66 -11 57 -1T48 16Q48 26 85 176T158 471L195 616Q196 629 188 632T149 637H144Q134 637 131 637T124 640T121 647Z",style:{"stroke-width":"3"}})])])],-1),j1=[Z1],v1=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mi",null,"k")])],-1),E1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},O1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.025ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.179ex",height:"1.595ex",role:"img",focusable:"false",viewBox:"0 -694 521 705","aria-hidden":"true"},R1=t("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[t("g",{"data-mml-node":"math"},[t("g",{"data-mml-node":"mi"},[t("path",{"data-c":"1D458",d:"M121 647Q121 657 125 670T137 683Q138 683 209 688T282 694Q294 694 294 686Q294 679 244 477Q194 279 194 272Q213 282 223 291Q247 309 292 354T362 415Q402 442 438 442Q468 442 485 423T503 369Q503 344 496 327T477 302T456 291T438 288Q418 288 406 299T394 328Q394 353 410 369T442 390L458 393Q446 405 434 405H430Q398 402 367 380T294 316T228 255Q230 254 243 252T267 246T293 238T320 224T342 206T359 180T365 147Q365 130 360 106T354 66Q354 26 381 26Q429 26 459 145Q461 153 479 153H483Q499 153 499 144Q499 139 496 130Q455 -11 378 -11Q333 -11 305 15T277 90Q277 108 280 121T283 145Q283 167 269 183T234 206T200 217T182 220H180Q168 178 159 139T145 81T136 44T129 20T122 7T111 -2Q98 -11 83 -11Q66 -11 57 -1T48 16Q48 26 85 176T158 471L195 616Q196 629 188 632T149 637H144Q134 637 131 637T124 640T121 647Z",style:{"stroke-width":"3"}})])])],-1),A1=[R1],N1=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mi",null,"k")])],-1),F1=t("p",null,"注意， 之前的 FM 到这里其实就完事了， 上面就是输出了，而这里很大的一点改进就是加入特征池化层之后， 把二阶交互的信息合并， 且上面接了一个 DNN 网络， 这样就能够增强 FM 的表达能力了， 因为 FM 只能到二阶， 而这里的 DNN 可以进行多阶且非线性，只要 FM 把二阶的学习好了， DNN 这块学习来会更加容易， 作者在论文中也说明了这一点，且通过后面的实验证实了这个观点。",-1),C1=t("p",null,"如果不加 DNN， NFM 就退化成了 FM，所以改进的关键就在于加了一个这样的层，组合了一下二阶交叉的信息，然后又给了 DNN 进行高阶交叉的学习，成了一种 “加强版” 的 FM。",-1),X1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},S1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"7.962ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 3519.1 1000","aria-hidden":"true"},B1=s("",1),P1=[B1],I1=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mi",null,"O"),t("mrow",{"data-mjx-texclass":"INNER"},[t("mo",{"data-mjx-texclass":"OPEN"},"("),t("mi",null,"k"),t("msub",null,[t("mi",null,"N"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"x")])]),t("mo",{"data-mjx-texclass":"CLOSE"},")")])])],-1),z1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},G1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.92ex",height:"1.902ex",role:"img",focusable:"false",viewBox:"0 -683 1290.5 840.8","aria-hidden":"true"},J1=s("",1),q1=[J1],$1=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"N"),t("mi",null,"x")])])],-1),W1={class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},U1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-3.275ex"},xmlns:"http://www.w3.org/2000/svg",width:"41.773ex",height:"7.681ex",role:"img",focusable:"false",viewBox:"0 -1947.5 18463.5 3395","aria-hidden":"true"},K1=s("",1),Y1=[K1],t2=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("msub",null,[t("mi",null,"f"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"B"),t("mi",null,"I")])]),t("mrow",{"data-mjx-texclass":"INNER"},[t("mo",{"data-mjx-texclass":"OPEN"},"("),t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{"data-mjx-variant":"-tex-calligraphic",mathvariant:"script"},"V")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"x")])]),t("mo",{"data-mjx-texclass":"CLOSE"},")")]),t("mo",null,"="),t("mfrac",null,[t("mn",null,"1"),t("mn",null,"2")]),t("mrow",{"data-mjx-texclass":"INNER"},[t("mo",{"data-mjx-texclass":"OPEN"},"["),t("msup",null,[t("mrow",{"data-mjx-texclass":"INNER"},[t("mo",{"data-mjx-texclass":"OPEN"},"("),t("munderover",null,[t("mo",{"data-mjx-texclass":"OP"},"∑"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mo",null,"="),t("mn",null,"1")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"n")])]),t("msub",null,[t("mi",null,"x"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i")])]),t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"v")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i")])]),t("mo",{"data-mjx-texclass":"CLOSE"},")")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mn",null,"2")])]),t("mo",null,"−"),t("munderover",null,[t("mo",{"data-mjx-texclass":"OP"},"∑"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mo",null,"="),t("mn",null,"1")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"n")])]),t("msup",null,[t("mrow",{"data-mjx-texclass":"INNER"},[t("mo",{"data-mjx-texclass":"OPEN"},"("),t("msub",null,[t("mi",null,"x"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i")])]),t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"v")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i")])]),t("mo",{"data-mjx-texclass":"CLOSE"},")")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mn",null,"2")])]),t("mo",{"data-mjx-texclass":"CLOSE"},"]")])])],-1),a2=t("p",null,"后面代码复现 NFM 就是用的这个公式直接计算，比较简便且清晰。",-1),Q2=t("h3",{id:"隐藏层",tabindex:"-1"},[a("隐藏层 "),t("a",{class:"header-anchor",href:"#隐藏层","aria-label":'Permalink to "隐藏层"'},"​")],-1),T2=t("p",null,"这一层就是全连接的神经网络， DNN 在进行特征的高层非线性交互上有着天然的学习优势，公式如下：",-1),s2={class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},e2={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-4.977ex"},xmlns:"http://www.w3.org/2000/svg",width:"26.918ex",height:"11.086ex",role:"img",focusable:"false",viewBox:"0 -2700 11897.6 4900","aria-hidden":"true"},l2=s("",1),n2=[l2],o2=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("mtable",{displaystyle:"true",columnalign:"right left",columnspacing:"0em",rowspacing:"3pt"},[t("mtr",null,[t("mtd",null,[t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"z")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mn",null,"1")])]),t("mo",null,"=")]),t("mtd",null,[t("msub",null,[t("mi",null,"σ"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mn",null,"1")])]),t("mrow",{"data-mjx-texclass":"INNER"},[t("mo",{"data-mjx-texclass":"OPEN"},"("),t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"W")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mn",null,"1")])]),t("msub",null,[t("mi",null,"f"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"B"),t("mi",null,"I")])]),t("mrow",{"data-mjx-texclass":"INNER"},[t("mo",{"data-mjx-texclass":"OPEN"},"("),t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{"data-mjx-variant":"-tex-calligraphic",mathvariant:"script"},"V")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"x")])]),t("mo",{"data-mjx-texclass":"CLOSE"},")")]),t("mo",null,"+"),t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"b")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mn",null,"1")])]),t("mo",{"data-mjx-texclass":"CLOSE"},")")])])]),t("mtr",null,[t("mtd",null,[t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"z")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mn",null,"2")])]),t("mo",null,"=")]),t("mtd",null,[t("msub",null,[t("mi",null,"σ"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mn",null,"2")])]),t("mrow",{"data-mjx-texclass":"INNER"},[t("mo",{"data-mjx-texclass":"OPEN"},"("),t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"W")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mn",null,"2")])]),t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"z")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mn",null,"1")])]),t("mo",null,"+"),t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"b")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mn",null,"2")])]),t("mo",{"data-mjx-texclass":"CLOSE"},")")])])]),t("mtr",null,[t("mtd",null,[t("mo",null,"…"),t("mo",null,"…")])]),t("mtr",null,[t("mtd",null,[t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"z")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"L")])]),t("mo",null,"=")]),t("mtd",null,[t("msub",null,[t("mi",null,"σ"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"L")])]),t("mrow",{"data-mjx-texclass":"INNER"},[t("mo",{"data-mjx-texclass":"OPEN"},"("),t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"W")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"L")])]),t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"z")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"L"),t("mo",null,"−"),t("mn",null,"1")])]),t("mo",null,"+"),t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"b")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"L")])]),t("mo",{"data-mjx-texclass":"CLOSE"},")")])])])])])],-1),m2={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},d2={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.032ex",height:"1.332ex",role:"img",focusable:"false",viewBox:"0 -431 898 588.8","aria-hidden":"true"},r2=s("",1),i2=[r2],p2=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("msub",null,[t("mi",null,"σ"),t("mi",null,"i")])])],-1),c2={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},h2={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.025ex"},xmlns:"http://www.w3.org/2000/svg",width:"0.781ex",height:"1.52ex",role:"img",focusable:"false",viewBox:"0 -661 345 672","aria-hidden":"true"},g2=t("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[t("g",{"data-mml-node":"math"},[t("g",{"data-mml-node":"mi"},[t("path",{"data-c":"1D456",d:"M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z",style:{"stroke-width":"3"}})])])],-1),x2=[g2],H2=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mi",null,"i")])],-1),u2=t("h3",{id:"预测层",tabindex:"-1"},[a("预测层 "),t("a",{class:"header-anchor",href:"#预测层","aria-label":'Permalink to "预测层"'},"​")],-1),w2=t("p",null,"这个就是最后一层的结果直接过一个隐藏层，但注意由于这里是回归问题，没有加 sigmoid 激活：",-1),_2={class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},y2={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"12.588ex",height:"2.583ex",role:"img",focusable:"false",viewBox:"0 -891.7 5563.9 1141.7","aria-hidden":"true"},L2=s("",1),M2=[L2],f2=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("mi",null,"f"),t("mo",{stretchy:"false"},"("),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"x")]),t("mo",{stretchy:"false"},")"),t("mo",null,"="),t("msup",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"h")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"T")])]),t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"z")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"L")])])])],-1),b2=t("p",null,"所以， NFM 模型的前向传播过程总结如下：",-1),D2={class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},k2={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-4.242ex"},xmlns:"http://www.w3.org/2000/svg",width:"57.85ex",height:"9.616ex",role:"img",focusable:"false",viewBox:"0 -2375.1 25569.7 4250.2","aria-hidden":"true"},V2=s("",1),Z2=[V2],j2=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("mtable",{displaystyle:"true",columnalign:"right left",columnspacing:"0em",rowspacing:"3pt"},[t("mtr",null,[t("mtd",null,[t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mover",null,[t("mi",null,"y"),t("mo",{stretchy:"false"},"^")])]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"N"),t("mi",null,"F"),t("mi",null,"M")])]),t("mo",{stretchy:"false"},"("),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"x")]),t("mo",{stretchy:"false"},")")]),t("mtd",null,[t("mi"),t("mo",null,"="),t("msub",null,[t("mi",null,"w"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mn",null,"0")])]),t("mo",null,"+"),t("munderover",null,[t("mo",{"data-mjx-texclass":"OP"},"∑"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mo",null,"="),t("mn",null,"1")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"n")])]),t("msub",null,[t("mi",null,"w"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i")])]),t("msub",null,[t("mi",null,"x"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i")])])])]),t("mtr",null,[t("mtd"),t("mtd",null,[t("mi"),t("mo",null,"+"),t("msup",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"h")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"T")])]),t("msub",null,[t("mi",null,"σ"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"L")])]),t("mrow",{"data-mjx-texclass":"INNER"},[t("mo",{"data-mjx-texclass":"OPEN"},"("),t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"W")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"L")])]),t("mrow",{"data-mjx-texclass":"INNER"},[t("mo",{"data-mjx-texclass":"OPEN"},"("),t("mo",null,"…"),t("msub",null,[t("mi",null,"σ"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mn",null,"1")])]),t("mrow",{"data-mjx-texclass":"INNER"},[t("mo",{"data-mjx-texclass":"OPEN"},"("),t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"W")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mn",null,"1")])]),t("msub",null,[t("mi",null,"f"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"B"),t("mi",null,"I")])]),t("mrow",{"data-mjx-texclass":"INNER"},[t("mo",{"data-mjx-texclass":"OPEN"},"("),t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{"data-mjx-variant":"-tex-calligraphic",mathvariant:"script"},"V")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"x")])]),t("mo",{"data-mjx-texclass":"CLOSE"},")")]),t("mo",null,"+"),t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"b")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mn",null,"1")])]),t("mo",{"data-mjx-texclass":"CLOSE"},")")]),t("mo",null,"…"),t("mo",{"data-mjx-texclass":"CLOSE"},")")]),t("mo",null,"+"),t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"b")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"L")])]),t("mo",{"data-mjx-texclass":"CLOSE"},")")])])])])])],-1),v2=t("p",null,"这就是 NFM 模型的全貌， NFM 相比较于其他模型的核心创新点是特征交叉池化层，基于它，实现了 FM 和 DNN 的无缝连接，使得 DNN 可以在底层就学习到包含更多信息的组合特征，这时候，就会减少 DNN 的很多负担，只需要很少的隐藏层就可以学习到高阶特征信息。NFM 相比之前的 DNN， 模型结构更浅，更简单，但是性能更好，训练和调参更容易。集合 FM 二阶交叉线性和 DNN 高阶交叉非线性的优势，非常适合处理稀疏数据的场景任务。在对 NFM 的真实训练过程中，也会用到像 Dropout 和 BatchNormalization 这样的技术来缓解过拟合和在过大的改变数据分布。",-1),E2=t("p",null,"下面通过代码看下 NFM 的具体实现过程， 学习一些细节。",-1),O2=t("h2",{id:"代码实现",tabindex:"-1"},[a("代码实现 "),t("a",{class:"header-anchor",href:"#代码实现","aria-label":'Permalink to "代码实现"'},"​")],-1),R2=t("p",null,"下面我们看下 NFM 的代码复现，这里主要是给大家说一下这个模型的设计逻辑，参考了 deepctr 的函数 API 的编程风格， 具体的代码以及示例大家可以去参考后面的 GitHub，里面已经给出了详细的注释， 这里主要分析模型的逻辑这块。关于函数 API 的编程式风格，我们还给出了一份文档， 大家可以先看这个，再看后面的代码部分，会更加舒服些。下面开始：",-1),A2=t("p",null,"这里主要说一下 NFM 模型的总体运行逻辑， 这样可以让大家从宏观的层面去把握模型的设计过程， 该模型所使用的数据集是 criteo 数据集，具体介绍参考后面的 GitHub。 数据集的特征会分为 dense 特征 (连续) 和 sparse 特征 (离散)， 所以模型的输入层接收这两种输入。但是我们这里把输入分成了 linear input 和 dnn input 两种情况，而每种情况都有可能包含上面这两种输入。因为我们后面的模型逻辑会分这两部分走，这里有个细节要注意，就是光看上面那个 NFM 模型的话，是没有看到它线性特征处理的那部分的，也就是 FM 的前半部分公式那里图里面是没有的。但是这里我们要加上。",-1),N2={class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},F2={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-2.819ex"},xmlns:"http://www.w3.org/2000/svg",width:"32.302ex",height:"6.354ex",role:"img",focusable:"false",viewBox:"0 -1562.5 14277.3 2808.5","aria-hidden":"true"},C2=s("",1),X2=[C2],S2=t("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[t("msub",null,[t("mrow",{"data-mjx-texclass":"ORD"},[t("mover",null,[t("mi",null,"y"),t("mo",{stretchy:"false"},"^")])]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"N"),t("mi",null,"F"),t("mi",null,"M")])]),t("mo",{stretchy:"false"},"("),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"x")]),t("mo",{stretchy:"false"},")"),t("mo",null,"="),t("msub",null,[t("mi",null,"w"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mn",null,"0")])]),t("mo",null,"+"),t("munderover",null,[t("mo",{"data-mjx-texclass":"OP"},"∑"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i"),t("mo",null,"="),t("mn",null,"1")]),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"n")])]),t("msub",null,[t("mi",null,"w"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i")])]),t("msub",null,[t("mi",null,"x"),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",null,"i")])]),t("mo",null,"+"),t("mi",null,"f"),t("mo",{stretchy:"false"},"("),t("mrow",{"data-mjx-texclass":"ORD"},[t("mi",{mathvariant:"bold"},"x")]),t("mo",{stretchy:"false"},")")])],-1),B2=t("p",null,"所以模型的逻辑我们分成了两大部分，这里我分别给大家解释下每一块做了什么事情：",-1),P2={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},I2={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.186ex"},xmlns:"http://www.w3.org/2000/svg",width:"25.125ex",height:"1.756ex",role:"img",focusable:"false",viewBox:"0 -694 11105.2 776","aria-hidden":"true"},z2=s("",1),G2=[z2],J2=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mi",null,"w"),t("mn",null,"1"),t("mi",null,"x"),t("mn",null,"1"),t("mo",null,"+"),t("mi",null,"w"),t("mn",null,"2"),t("mi",null,"x"),t("mn",null,"2."),t("mo",null,"."),t("mo",null,"."),t("mi",null,"w"),t("mi",null,"n"),t("mi",null,"x"),t("mi",null,"n"),t("mo",null,"+"),t("mi",null,"b")])],-1),q2=t("li",null,"dnn part: 这部分是后面交叉特征的那部分计算，FM 的最后那部分公式 f (x)。 这一块主要是针对离散的特征，首先过 embedding， 然后过特征交叉池化层，这个计算我们用了 get_bi_interaction_pooling_output 函数实现， 得到输出之后又过了 DNN 网络，最后得到 dnn 的输出",-1),$2=s("",4),W2=s("",5);function U2(K2,Y2,t4,a4,Q4,T4){return Q(),T("div",null,[n,o,m,d,t("mjx-container",r,[(Q(),T("svg",i,c)),h]),g,x,a(" 而这个表达能力更强的函数呢， 我们很容易就可以想到神经网络来充当，因为神经网络理论上可以拟合任何复杂能力的函数， 所以作者真的就把这个$f(x)$换成了一个神经网络，当然不是一个简单的DNN， 而是依然底层考虑了交叉，然后高层使用的DNN网络， 这个也就是我们最终的NFM网络了： "),H,a(" 这个结构，如果前面看过了PNN的伙伴会发现，这个结构和PNN非常像，只不过那里是一个product_layer， 而这里换成了Bi-Interaction Pooling了， 这个也是NFM的核心结构了。这里注意， 这个结构中，忽略了一阶部分，只可视化出来了$f(x)$， 我们还是下面从底层一点点的对这个网络进行剖析。 "),u,w,t("p",null,[a("输入层的特征， 文章指定了稀疏离散特征居多， 这种特征我们也知道一般是先 one-hot, 然后会通过 embedding，处理成稠密低维的。 所以这两层还是和之前一样，假设"),t("mjx-container",_,[(Q(),T("svg",y,M)),f]),a(" 为第"),t("mjx-container",b,[(Q(),T("svg",D,V)),Z]),a(" 个特征的 embedding 向量， 那么"),t("mjx-container",j,[(Q(),T("svg",v,O)),R]),a(" 表示的下一层的输入特征。这里带上了"),t("mjx-container",A,[(Q(),T("svg",N,C)),X]),a(" 是因为很多"),t("mjx-container",S,[(Q(),T("svg",B,I)),z]),a(" 转成了 One-hot 之后，出现很多为 0 的， 这里的"),t("mjx-container",G,[(Q(),T("svg",J,$)),W]),a(" 是"),t("mjx-container",U,[(Q(),T("svg",K,t1)),a1]),a(" 不等于 0 的那些特征向量。")]),Q1,t("p",null,[a("在 Embedding 层和神经网络之间加入了特征交叉池化层是本网络的核心创新了，正是因为这个结构，实现了 FM 与 DNN 的无缝连接， 组成了一个大的网络，且能够正常的反向传播。假设"),t("mjx-container",T1,[(Q(),T("svg",s1,l1)),n1]),a(" 是所有特征 embedding 的集合， 那么在特征交叉池化层的操作：")]),t("mjx-container",o1,[(Q(),T("svg",m1,r1)),i1]),t("p",null,[t("mjx-container",p1,[(Q(),T("svg",c1,g1)),x1]),a(" 表示两个向量的元素积操作，即两个向量对应维度相乘得到的元素积向量（可不是点乘呀），其中第"),t("mjx-container",H1,[(Q(),T("svg",u1,_1)),y1]),a(" 维的操作：")]),t("mjx-container",L1,[(Q(),T("svg",M1,b1)),D1]),t("p",null,[a("这便定义了在 embedding 空间特征的二阶交互，这个不仔细看会和感觉 FM 的最后一项很像，但是不一样，一定要注意这个地方不是两个隐向量的内积，而是元素积，也就是这一个交叉完了之后 k 个维度不求和，最后会得到一个"),t("mjx-container",k1,[(Q(),T("svg",V1,j1)),v1]),a(" 维向量，而 FM 那里内积的话最后得到一个数， 在进行两两 Embedding 元素积之后，对交叉特征向量取和， 得到该层的输出向量， 很显然， 输出是一个"),t("mjx-container",E1,[(Q(),T("svg",O1,A1)),N1]),a(" 维的向量。")]),F1,C1,t("p",null,[a("Bi-Interaction 层不需要额外的模型学习参数，更重要的是它在一个线性的时间内完成计算，和 FM 一致的，即时间复杂度为"),t("mjx-container",X1,[(Q(),T("svg",S1,P1)),I1]),a("，"),t("mjx-container",z1,[(Q(),T("svg",G1,q1)),$1]),a(" 为 embedding 向量的数量。参考 FM，可以将上式转化为：")]),t("mjx-container",W1,[(Q(),T("svg",U1,Y1)),t2]),a2,Q2,T2,t("mjx-container",s2,[(Q(),T("svg",e2,n2)),o2]),t("p",null,[a("这里的"),t("mjx-container",m2,[(Q(),T("svg",d2,i2)),p2]),a(" 是第"),t("mjx-container",c2,[(Q(),T("svg",h2,x2)),H2]),a(" 层的激活函数，可不要理解成 sigmoid 激活函数。")]),u2,w2,t("mjx-container",_2,[(Q(),T("svg",y2,M2)),f2]),b2,t("mjx-container",D2,[(Q(),T("svg",k2,Z2)),j2]),v2,E2,O2,R2,A2,t("mjx-container",N2,[(Q(),T("svg",F2,X2)),S2]),B2,t("ol",null,[t("li",null,[a("linear part: 这部分是有关于线性计算，也就是 FM 的前半部分"),t("mjx-container",P2,[(Q(),T("svg",I2,G2)),J2]),a(" 的计算。对于这一块的计算，我们用了一个 get_linear_logits 函数实现，后面再说，总之通过这个函数，我们就可以实现上面这个公式的计算过程，得到 linear 的输出")]),q2]),$2,a(" 下面是一个通过keras画的模型结构图，为了更好的显示，数值特征和类别特征都只是选择了一小部分，画图的代码也在github中。 "),W2])}const l4=e(l,[["render",U2]]);export{e4 as __pageData,l4 as default};
